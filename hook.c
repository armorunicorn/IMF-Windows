
/*
Copyright (c) 2017 HyungSeok Han and Sang Kil Cha at SoftSec, KAIST

See the file LICENCE for copying permission.
*/

#include "detours.h" 
#include <stdio.h>
#include <locale.h>
#include <Windows.h>
#include <excpt.h>

#pragma comment(lib, "detours.lib")
#ifndef LOG_PATH
#define LOG_PATH "C:\\log.txt"
#endif

__declspec(dllexport) VOID ExportFuncForSetDll(VOID)
{
	OutputDebugStringA("ExportFuncForSetDll");
}

HANDLE g_mutex;
const char* log_path = LOG_PATH;
int (WINAPI *pGetUpdateRgn) (HWND hWnd,HRGN hRgn,BOOL bErase) = GetUpdateRgn;
int fake_GetUpdateRgn(HWND hWnd,HRGN hRgn,BOOL bErase){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetUpdateRgn',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hRgn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRgn, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hRgn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRgn,sizeof(HRGN));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bErase','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bErase, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bErase','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bErase,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetUpdateRgn(hWnd,hRgn,bErase);
	fprintf(fp,"OUT ['GetUpdateRgn',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pCallWindowProcW) (FARPROC lpPrevWndFunc,HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = CallWindowProcW;
LRESULT fake_CallWindowProcW(FARPROC lpPrevWndFunc,HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CallWindowProcW',");
	if(1) fprintf(fp,"{'name':'lpPrevWndFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPrevWndFunc, sizeof(FARPROC),1);
 	else fprintf(fp,"{'name':'lpPrevWndFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPrevWndFunc,sizeof(FARPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pCallWindowProcW(lpPrevWndFunc,hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['CallWindowProcW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

SHORT (WINAPI *pVkKeyScanExW) (WCHAR ch,HKL dwhkl) = VkKeyScanExW;
SHORT fake_VkKeyScanExW(WCHAR ch,HKL dwhkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['VkKeyScanExW',");
	if(1)
	{
		fprintf(fp,"{'name':'ch',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%c\"',", ch);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%c\"',", ch);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(WCHAR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ch',");
		fwprintf(fp, L"'value': '\"%c\"', ", ch);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(WCHAR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwhkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwhkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'dwhkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwhkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	SHORT ret = pVkKeyScanExW(ch,dwhkl);
	fprintf(fp,"OUT ['VkKeyScanExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(SHORT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(SHORT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetKeyboardType) (int nTypeFlag) = GetKeyboardType;
int fake_GetKeyboardType(int nTypeFlag){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyboardType',");
	if(1) fprintf(fp,"{'name':'nTypeFlag','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTypeFlag, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTypeFlag','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTypeFlag,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetKeyboardType(nTypeFlag);
	fprintf(fp,"OUT ['GetKeyboardType',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPrintWindow) (HWND hwnd,HDC hdcBlt,UINT nFlags) = PrintWindow;
BOOL fake_PrintWindow(HWND hwnd,HDC hdcBlt,UINT nFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PrintWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hdcBlt','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdcBlt, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdcBlt','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdcBlt,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'nFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPrintWindow(hwnd,hdcBlt,nFlags);
	fprintf(fp,"OUT ['PrintWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharAlphaA) (CHAR ch) = IsCharAlphaA;
BOOL fake_IsCharAlphaA(CHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharAlphaA',");
	if(1) fprintf(fp,"{'name':'ch','value': '\"%c\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ch, sizeof(CHAR),1);
 	else fprintf(fp,"{'name':'ch','value': '\"%c\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ch,sizeof(CHAR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharAlphaA(ch);
	fprintf(fp,"OUT ['IsCharAlphaA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetDoubleClickTime) () = GetDoubleClickTime;
UINT fake_GetDoubleClickTime(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDoubleClickTime',");
	fprintf(fp,"]\n");
	UINT ret = pGetDoubleClickTime();
	fprintf(fp,"OUT ['GetDoubleClickTime',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawEdge) (HDC hdc,LPRECT qrc,UINT edge,UINT grfFlags) = DrawEdge;
BOOL fake_DrawEdge(HDC hdc,LPRECT qrc,UINT edge,UINT grfFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawEdge',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'qrc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",qrc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'qrc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",qrc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'edge','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",edge, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'edge','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",edge,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'grfFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",grfFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'grfFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",grfFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawEdge(hdc,qrc,edge,grfFlags);
	fprintf(fp,"OUT ['DrawEdge',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'qrc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",qrc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'qrc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",qrc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDestroyCursor) (HCURSOR hCursor) = DestroyCursor;
BOOL fake_DestroyCursor(HCURSOR hCursor){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DestroyCursor',");
	if(1) fprintf(fp,"{'name':'hCursor','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hCursor, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'hCursor','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hCursor,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDestroyCursor(hCursor);
	fprintf(fp,"OUT ['DestroyCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPARAM (WINAPI *pSetMessageExtraInfo) (LPARAM lParam) = SetMessageExtraInfo;
LPARAM fake_SetMessageExtraInfo(LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMessageExtraInfo',");
	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPARAM ret = pSetMessageExtraInfo(lParam);
	fprintf(fp,"OUT ['SetMessageExtraInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsTouchWindow) (HWND hwnd,PULONG pulFlags) = IsTouchWindow;
BOOL fake_IsTouchWindow(HWND hwnd,PULONG pulFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsTouchWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsTouchWindow(hwnd,pulFlags);
	fprintf(fp,"OUT ['IsTouchWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pulFlags','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pulFlags, sizeof(PULONG),1);
 	else fprintf(fp,"{'name':'pulFlags','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pulFlags,sizeof(PULONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetCursorPos) (LPPOINT lpPoint) = GetCursorPos;
BOOL fake_GetCursorPos(LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetCursorPos',");
	fprintf(fp,"]\n");
	BOOL ret = pGetCursorPos(lpPoint);
	fprintf(fp,"OUT ['GetCursorPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnableMenuItem) (HMENU hMenu,UINT uIDEnableItem,UINT uEnable) = EnableMenuItem;
BOOL fake_EnableMenuItem(HMENU hMenu,UINT uIDEnableItem,UINT uEnable){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnableMenuItem',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDEnableItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDEnableItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uIDEnableItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDEnableItem,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uEnable','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uEnable, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uEnable','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uEnable,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnableMenuItem(hMenu,uIDEnableItem,uEnable);
	fprintf(fp,"OUT ['EnableMenuItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPWSTR (WINAPI *pCharLowerW) (LPWSTR lpsz) = CharLowerW;
LPWSTR fake_CharLowerW(LPWSTR lpsz){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharLowerW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPWSTR ret = pCharLowerW(lpsz);
	fprintf(fp,"OUT ['CharLowerW',");
	if(1)
	{
		fprintf(fp,"{'name':'ret',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", ret);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", ret);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ret',");
		fwprintf(fp, L"'value': '\"%s\"', ", ret);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetFocus) () = GetFocus;
HWND fake_GetFocus(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetFocus',");
	fprintf(fp,"]\n");
	HWND ret = pGetFocus();
	fprintf(fp,"OUT ['GetFocus',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCharToOemA) (LPCSTR pSrc,LPSTR pDst) = CharToOemA;
BOOL fake_CharToOemA(LPCSTR pSrc,LPSTR pDst){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharToOemA',");
	if(1) fprintf(fp,"{'name':'pSrc','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pSrc, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'pSrc','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSrc,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCharToOemA(pSrc,pDst);
	fprintf(fp,"OUT ['CharToOemA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pDst','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pDst, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'pDst','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pDst,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetOpenClipboardWindow) () = GetOpenClipboardWindow;
HWND fake_GetOpenClipboardWindow(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetOpenClipboardWindow',");
	fprintf(fp,"]\n");
	HWND ret = pGetOpenClipboardWindow();
	fprintf(fp,"OUT ['GetOpenClipboardWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pEnumPropsA) (HWND hWnd,PROPENUMPROCA lpEnumFunc) = EnumPropsA;
int fake_EnumPropsA(HWND hWnd,PROPENUMPROCA lpEnumFunc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumPropsA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(PROPENUMPROCA),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(PROPENUMPROCA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pEnumPropsA(hWnd,lpEnumFunc);
	fprintf(fp,"OUT ['EnumPropsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefMDIChildProcW) (HWND hWnd,UINT uMsg,WPARAM wParam,LPARAM lParam) = DefMDIChildProcW;
LRESULT fake_DefMDIChildProcW(HWND hWnd,UINT uMsg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefMDIChildProcW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMsg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMsg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMsg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMsg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefMDIChildProcW(hWnd,uMsg,wParam,lParam);
	fprintf(fp,"OUT ['DefMDIChildProcW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pSetParent) (HWND hWndChild,HWND hWndNewParent) = SetParent;
HWND fake_SetParent(HWND hWndChild,HWND hWndNewParent){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetParent',");
	if(1) fprintf(fp,"{'name':'hWndChild','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndChild, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndChild','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndChild,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndNewParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndNewParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndNewParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndNewParent,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pSetParent(hWndChild,hWndNewParent);
	fprintf(fp,"OUT ['SetParent',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pFlashWindowEx) (PFLASHWINFO pfwi) = FlashWindowEx;
BOOL fake_FlashWindowEx(PFLASHWINFO pfwi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FlashWindowEx',");
	if(1) fprintf(fp,"{'name':'pfwi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pfwi, sizeof(PFLASHWINFO),1);
 	else fprintf(fp,"{'name':'pfwi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pfwi,sizeof(PFLASHWINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pFlashWindowEx(pfwi);
	fprintf(fp,"OUT ['FlashWindowEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetGuiResources) (HANDLE hProcess,DWORD uiFlags) = GetGuiResources;
DWORD fake_GetGuiResources(HANDLE hProcess,DWORD uiFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetGuiResources',");
	if(1) fprintf(fp,"{'name':'hProcess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hProcess, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hProcess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hProcess,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'uiFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetGuiResources(hProcess,uiFlags);
	fprintf(fp,"OUT ['GetGuiResources',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pCountClipboardFormats) () = CountClipboardFormats;
int fake_CountClipboardFormats(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CountClipboardFormats',");
	fprintf(fp,"]\n");
	int ret = pCountClipboardFormats();
	fprintf(fp,"OUT ['CountClipboardFormats',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenuInfo) (HMENU arg0,LPCMENUINFO arg1) = SetMenuInfo;
BOOL fake_SetMenuInfo(HMENU arg0,LPCMENUINFO arg1){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenuInfo',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPCMENUINFO),1);
 	else fprintf(fp,"{'name':'arg1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPCMENUINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenuInfo(arg0,arg1);
	fprintf(fp,"OUT ['SetMenuInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetDlgItemInt) (HWND hDlg,int nIDDlgItem,UINT uValue,BOOL bSigned) = SetDlgItemInt;
BOOL fake_SetDlgItemInt(HWND hDlg,int nIDDlgItem,UINT uValue,BOOL bSigned){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetDlgItemInt',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uValue','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uValue, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uValue','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uValue,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bSigned','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bSigned, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bSigned','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bSigned,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetDlgItemInt(hDlg,nIDDlgItem,uValue,bSigned);
	fprintf(fp,"OUT ['SetDlgItemInt',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawCaption) (HWND hwnd,HDC hdc,CONST RECT*  lprect,UINT flags) = DrawCaption;
BOOL fake_DrawCaption(HWND hwnd,HDC hdc,CONST RECT*  lprect,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawCaption',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lprect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lprect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':' lprect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lprect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawCaption(hwnd,hdc, lprect,flags);
	fprintf(fp,"OUT ['DrawCaption',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetNextDlgGroupItem) (HWND hDlg,HWND hCtl,BOOL bPrevious) = GetNextDlgGroupItem;
HWND fake_GetNextDlgGroupItem(HWND hDlg,HWND hCtl,BOOL bPrevious){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetNextDlgGroupItem',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hCtl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hCtl, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hCtl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hCtl,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bPrevious','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bPrevious, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bPrevious','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bPrevious,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetNextDlgGroupItem(hDlg,hCtl,bPrevious);
	fprintf(fp,"OUT ['GetNextDlgGroupItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateDialogParamA) (HINSTANCE hInstance,LPCSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = CreateDialogParamA;
HWND fake_CreateDialogParamA(HINSTANCE hInstance,LPCSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDialogParamA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTemplateName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpTemplateName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpTemplateName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTemplateName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateDialogParamA(hInstance,lpTemplateName,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['CreateDialogParamA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetClassInfoExW) (HINSTANCE hInstance,LPCWSTR lpszClass,LPWNDCLASSEXW lpwcx) = GetClassInfoExW;
BOOL fake_GetClassInfoExW(HINSTANCE hInstance,LPCWSTR lpszClass,LPWNDCLASSEXW lpwcx){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassInfoExW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszClass',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszClass);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszClass);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszClass',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszClass);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetClassInfoExW(hInstance,lpszClass,lpwcx);
	fprintf(fp,"OUT ['GetClassInfoExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpwcx','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpwcx, sizeof(LPWNDCLASSEXW),1);
 	else fprintf(fp,"{'name':'lpwcx','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpwcx,sizeof(LPWNDCLASSEXW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pTranslateMDISysAccel) (HWND hWndClient,LPMSG lpMsg) = TranslateMDISysAccel;
BOOL fake_TranslateMDISysAccel(HWND hWndClient,LPMSG lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TranslateMDISysAccel',");
	if(1) fprintf(fp,"{'name':'hWndClient','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndClient, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndClient','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndClient,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pTranslateMDISysAccel(hWndClient,lpMsg);
	fprintf(fp,"OUT ['TranslateMDISysAccel',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAnimateWindow) (HWND hWnd,DWORD dwTime,DWORD dwFlags) = AnimateWindow;
BOOL fake_AnimateWindow(HWND hWnd,DWORD dwTime,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AnimateWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwTime','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwTime, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwTime','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwTime,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAnimateWindow(hWnd,dwTime,dwFlags);
	fprintf(fp,"OUT ['AnimateWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pChildWindowFromPointEx) (HWND hwnd,POINT pt,UINT flags) = ChildWindowFromPointEx;
HWND fake_ChildWindowFromPointEx(HWND hwnd,POINT pt,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChildWindowFromPointEx',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pt','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",pt, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'pt','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pt,sizeof(POINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pChildWindowFromPointEx(hwnd,pt,flags);
	fprintf(fp,"OUT ['ChildWindowFromPointEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOemToCharBuffA) (LPCSTR lpszSrc,LPSTR lpszDst,DWORD cchDstLength) = OemToCharBuffA;
BOOL fake_OemToCharBuffA(LPCSTR lpszSrc,LPSTR lpszDst,DWORD cchDstLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OemToCharBuffA',");
	if(1) fprintf(fp,"{'name':'lpszSrc','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszSrc, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszSrc','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszSrc,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchDstLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchDstLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchDstLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchDstLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOemToCharBuffA(lpszSrc,lpszDst,cchDstLength);
	fprintf(fp,"OUT ['OemToCharBuffA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDst, sizeof(LPSTR),cchDstLength);
 	else fprintf(fp,"{'name':'lpszDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDst,sizeof(LPSTR));
	if(lpszDst){
		for(int i=0; i<cchDstLength;i++){
			fprintf(fp,"0x%x,",lpszDst[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumWindows) (WNDENUMPROC lpEnumFunc,LPARAM lParam) = EnumWindows;
BOOL fake_EnumWindows(WNDENUMPROC lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumWindows',");
	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(WNDENUMPROC),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(WNDENUMPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumWindows(lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMenuInfo) (HMENU arg0,LPMENUINFO arg1) = GetMenuInfo;
BOOL fake_GetMenuInfo(HMENU arg0,LPMENUINFO arg1){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuInfo',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPMENUINFO),1);
 	else fprintf(fp,"{'name':'arg1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPMENUINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMenuInfo(arg0,arg1);
	fprintf(fp,"OUT ['GetMenuInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPMENUINFO),1);
 	else fprintf(fp,"{'name':'arg1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPMENUINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetMenuItemCount) (HMENU hMenu) = GetMenuItemCount;
int fake_GetMenuItemCount(HMENU hMenu){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuItemCount',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetMenuItemCount(hMenu);
	fprintf(fp,"OUT ['GetMenuItemCount',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetUserObjectInformationW) (HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength) = SetUserObjectInformationW;
BOOL fake_SetUserObjectInformationW(HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetUserObjectInformationW',");
	if(1) fprintf(fp,"{'name':'hObj','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hObj, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hObj','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hObj,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvInfo, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvInfo,sizeof(PVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetUserObjectInformationW(hObj,nIndex,pvInfo,nLength);
	fprintf(fp,"OUT ['SetUserObjectInformationW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDesktopWindows) (HDESK hDesktop,WNDENUMPROC lpfn,LPARAM lParam) = EnumDesktopWindows;
BOOL fake_EnumDesktopWindows(HDESK hDesktop,WNDENUMPROC lpfn,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDesktopWindows',");
	if(1) fprintf(fp,"{'name':'hDesktop','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDesktop, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'hDesktop','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDesktop,sizeof(HDESK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpfn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpfn, sizeof(WNDENUMPROC),1);
 	else fprintf(fp,"{'name':'lpfn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpfn,sizeof(WNDENUMPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDesktopWindows(hDesktop,lpfn,lParam);
	fprintf(fp,"OUT ['EnumDesktopWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pLoadCursorFromFileA) (LPCSTR lpFileName) = LoadCursorFromFileA;
HCURSOR fake_LoadCursorFromFileA(LPCSTR lpFileName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadCursorFromFileA',");
	if(1) fprintf(fp,"{'name':'lpFileName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpFileName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpFileName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpFileName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pLoadCursorFromFileA(lpFileName);
	fprintf(fp,"OUT ['LoadCursorFromFileA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pFindWindowA) (LPCSTR lpClassName,LPCSTR lpWindowName) = FindWindowA;
HWND fake_FindWindowA(LPCSTR lpClassName,LPCSTR lpWindowName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FindWindowA',");
	if(1) fprintf(fp,"{'name':'lpClassName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpClassName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpClassName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClassName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpWindowName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpWindowName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpWindowName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWindowName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pFindWindowA(lpClassName,lpWindowName);
	fprintf(fp,"OUT ['FindWindowA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

long (WINAPI *pBroadcastSystemMessageExA) (DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam,PBSMINFO pbsmInfo) = BroadcastSystemMessageExA;
long fake_BroadcastSystemMessageExA(DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam,PBSMINFO pbsmInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BroadcastSystemMessageExA',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	long ret = pBroadcastSystemMessageExA(flags,lpInfo,Msg,wParam,lParam,pbsmInfo);
	fprintf(fp,"OUT ['BroadcastSystemMessageExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(long),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(long));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pbsmInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pbsmInfo, sizeof(PBSMINFO),1);
 	else fprintf(fp,"{'name':'pbsmInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pbsmInfo,sizeof(PBSMINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pRealGetWindowClassA) (HWND hwnd,LPSTR ptszClassName,UINT cchClassNameMax) = RealGetWindowClassA;
UINT fake_RealGetWindowClassA(HWND hwnd,LPSTR ptszClassName,UINT cchClassNameMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RealGetWindowClassA',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchClassNameMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchClassNameMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cchClassNameMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchClassNameMax,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pRealGetWindowClassA(hwnd,ptszClassName,cchClassNameMax);
	fprintf(fp,"OUT ['RealGetWindowClassA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'ptszClassName','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",ptszClassName, sizeof(LPSTR),cchClassNameMax, ret);
 	else fprintf(fp,"{'name':'ptszClassName','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ptszClassName,sizeof(LPSTR));
	if(ptszClassName){
		for(int i=0; i<cchClassNameMax <  ret ? cchClassNameMax :  ret;i++){
			fprintf(fp,"0x%x,",ptszClassName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetMenuItemID) (HMENU hMenu,int nPos) = GetMenuItemID;
UINT fake_GetMenuItemID(HMENU hMenu,int nPos){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuItemID',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nPos, sizeof(int),1);
 	else fprintf(fp,"{'name':'nPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nPos,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetMenuItemID(hMenu,nPos);
	fprintf(fp,"OUT ['GetMenuItemID',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pMessageBeep) (UINT uType) = MessageBeep;
BOOL fake_MessageBeep(UINT uType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBeep',");
	if(1) fprintf(fp,"{'name':'uType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pMessageBeep(uType);
	fprintf(fp,"OUT ['MessageBeep',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMessageBoxExW) (HWND hWnd,LPCWSTR lpText,LPCWSTR lpCaption,UINT uType,WORD wLanguageId) = MessageBoxExW;
int fake_MessageBoxExW(HWND hWnd,LPCWSTR lpText,LPCWSTR lpCaption,UINT uType,WORD wLanguageId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBoxExW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpText',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpCaption',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpCaption);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpCaption);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpCaption',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpCaption);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uType,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wLanguageId','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",wLanguageId, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'wLanguageId','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wLanguageId,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMessageBoxExW(hWnd,lpText,lpCaption,uType,wLanguageId);
	fprintf(fp,"OUT ['MessageBoxExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCallMsgFilterA) (LPMSG lpMsg,int nCode) = CallMsgFilterA;
BOOL fake_CallMsgFilterA(LPMSG lpMsg,int nCode){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CallMsgFilterA',");
	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCode, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCode,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCallMsgFilterA(lpMsg,nCode);
	fprintf(fp,"OUT ['CallMsgFilterA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HACCEL (WINAPI *pLoadAcceleratorsA) (HINSTANCE hInstance,LPCSTR lpTableName) = LoadAcceleratorsA;
HACCEL fake_LoadAcceleratorsA(HINSTANCE hInstance,LPCSTR lpTableName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadAcceleratorsA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTableName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpTableName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpTableName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTableName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HACCEL ret = pLoadAcceleratorsA(hInstance,lpTableName);
	fprintf(fp,"OUT ['LoadAcceleratorsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HACCEL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInsertMenuW) (HMENU hMenu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCWSTR lpNewItem) = InsertMenuW;
BOOL fake_InsertMenuW(HMENU hMenu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCWSTR lpNewItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InsertMenuW',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDNewItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDNewItem, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDNewItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDNewItem,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpNewItem',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpNewItem);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpNewItem);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpNewItem',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpNewItem);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInsertMenuW(hMenu,uPosition,uFlags,uIDNewItem,lpNewItem);
	fprintf(fp,"OUT ['InsertMenuW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRedrawWindow) (HWND hWnd,CONST RECT* lprcUpdate,HRGN hrgnUpdate,UINT flags) = RedrawWindow;
BOOL fake_RedrawWindow(HWND hWnd,CONST RECT* lprcUpdate,HRGN hrgnUpdate,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RedrawWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcUpdate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcUpdate, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcUpdate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcUpdate,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hrgnUpdate','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hrgnUpdate, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hrgnUpdate','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hrgnUpdate,sizeof(HRGN));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRedrawWindow(hWnd,lprcUpdate,hrgnUpdate,flags);
	fprintf(fp,"OUT ['RedrawWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSystemParametersInfoA) (UINT uiAction,UINT uiParam,PVOID pvParam,UINT fWinIni) = SystemParametersInfoA;
BOOL fake_SystemParametersInfoA(UINT uiAction,UINT uiParam,PVOID pvParam,UINT fWinIni){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SystemParametersInfoA',");
	if(1) fprintf(fp,"{'name':'uiAction','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiAction, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiAction','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiAction,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiParam, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiParam,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvParam, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvParam,sizeof(PVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fWinIni','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fWinIni, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fWinIni','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fWinIni,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSystemParametersInfoA(uiAction,uiParam,pvParam,fWinIni);
	fprintf(fp,"OUT ['SystemParametersInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvParam, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvParam,sizeof(PVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetLayeredWindowAttributes) (HWND hwnd,COLORREF crKey,BYTE bAlpha,DWORD dwFlags) = SetLayeredWindowAttributes;
BOOL fake_SetLayeredWindowAttributes(HWND hwnd,COLORREF crKey,BYTE bAlpha,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetLayeredWindowAttributes',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'crKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",crKey, sizeof(COLORREF),1);
 	else fprintf(fp,"{'name':'crKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",crKey,sizeof(COLORREF));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bAlpha','value': 0x%hhx,'size' : 0x%lx,'cnt':0x%x, 'data':[",bAlpha, sizeof(BYTE),1);
 	else fprintf(fp,"{'name':'bAlpha','value': 0x%hhx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bAlpha,sizeof(BYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetLayeredWindowAttributes(hwnd,crKey,bAlpha,dwFlags);
	fprintf(fp,"OUT ['SetLayeredWindowAttributes',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pLockWindowUpdate) (HWND hWndLock) = LockWindowUpdate;
BOOL fake_LockWindowUpdate(HWND hWndLock){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LockWindowUpdate',");
	if(1) fprintf(fp,"{'name':'hWndLock','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndLock, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndLock','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndLock,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pLockWindowUpdate(hWndLock);
	fprintf(fp,"OUT ['LockWindowUpdate',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefWindowProcA) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = DefWindowProcA;
LRESULT fake_DefWindowProcA(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefWindowProcA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefWindowProcA(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['DefWindowProcA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetPhysicalCursorPos) (int X,int Y) = SetPhysicalCursorPos;
BOOL fake_SetPhysicalCursorPos(int X,int Y){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetPhysicalCursorPos',");
	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetPhysicalCursorPos(X,Y);
	fprintf(fp,"OUT ['SetPhysicalCursorPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDestroyAcceleratorTable) (HACCEL hAccel) = DestroyAcceleratorTable;
BOOL fake_DestroyAcceleratorTable(HACCEL hAccel){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DestroyAcceleratorTable',");
	if(1) fprintf(fp,"{'name':'hAccel','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hAccel, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'hAccel','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hAccel,sizeof(HACCEL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDestroyAcceleratorTable(hAccel);
	fprintf(fp,"OUT ['DestroyAcceleratorTable',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInvertRect) (HDC hDC,CONST RECT* lprc) = InvertRect;
BOOL fake_InvertRect(HDC hDC,CONST RECT* lprc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InvertRect',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInvertRect(hDC,lprc);
	fprintf(fp,"OUT ['InvertRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsDialogMessageW) (HWND hDlg,LPMSG lpMsg) = IsDialogMessageW;
BOOL fake_IsDialogMessageW(HWND hDlg,LPMSG lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsDialogMessageW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsDialogMessageW(hDlg,lpMsg);
	fprintf(fp,"OUT ['IsDialogMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pLookupIconIdFromDirectory) (PBYTE presbits,BOOL fIcon) = LookupIconIdFromDirectory;
int fake_LookupIconIdFromDirectory(PBYTE presbits,BOOL fIcon){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LookupIconIdFromDirectory',");
	if(1) fprintf(fp,"{'name':'presbits','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",presbits, sizeof(PBYTE),1);
 	else fprintf(fp,"{'name':'presbits','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",presbits,sizeof(PBYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fIcon, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fIcon,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pLookupIconIdFromDirectory(presbits,fIcon);
	fprintf(fp,"OUT ['LookupIconIdFromDirectory',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pSetDebugErrorLevel) (DWORD dwLevel) = SetDebugErrorLevel;
VOID fake_SetDebugErrorLevel(DWORD dwLevel){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetDebugErrorLevel',");
	if(1) fprintf(fp,"{'name':'dwLevel','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwLevel, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwLevel','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwLevel,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pSetDebugErrorLevel(dwLevel);
	fprintf(fp,"OUT ['SetDebugErrorLevel',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMessageBoxA) (HWND hWnd,LPCSTR lpText,LPCSTR lpCaption,UINT uType) = MessageBoxA;
int fake_MessageBoxA(HWND hWnd,LPCSTR lpText,LPCSTR lpCaption,UINT uType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBoxA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpText','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpText, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpText','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpText,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpCaption','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpCaption, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpCaption','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpCaption,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMessageBoxA(hWnd,lpText,lpCaption,uType);
	fprintf(fp,"OUT ['MessageBoxA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pFlashWindow) (HWND hWnd,BOOL bInvert) = FlashWindow;
BOOL fake_FlashWindow(HWND hWnd,BOOL bInvert){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FlashWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bInvert','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bInvert, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bInvert','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bInvert,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pFlashWindow(hWnd,bInvert);
	fprintf(fp,"OUT ['FlashWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetClassInfoExA) (HINSTANCE hInstance,LPCSTR lpszClass,LPWNDCLASSEXA lpwcx) = GetClassInfoExA;
BOOL fake_GetClassInfoExA(HINSTANCE hInstance,LPCSTR lpszClass,LPWNDCLASSEXA lpwcx){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassInfoExA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszClass','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszClass, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszClass','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszClass,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetClassInfoExA(hInstance,lpszClass,lpwcx);
	fprintf(fp,"OUT ['GetClassInfoExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpwcx','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpwcx, sizeof(LPWNDCLASSEXA),1);
 	else fprintf(fp,"{'name':'lpwcx','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpwcx,sizeof(LPWNDCLASSEXA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

INT_PTR (WINAPI *pDialogBoxParamA) (HINSTANCE hInstance,LPCSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = DialogBoxParamA;
INT_PTR fake_DialogBoxParamA(HINSTANCE hInstance,LPCSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DialogBoxParamA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTemplateName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpTemplateName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpTemplateName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTemplateName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	INT_PTR ret = pDialogBoxParamA(hInstance,lpTemplateName,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['DialogBoxParamA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(INT_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(INT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pValidateRect) (HWND hWnd,CONST RECT* lpRect) = ValidateRect;
BOOL fake_ValidateRect(HWND hWnd,CONST RECT* lpRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ValidateRect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pValidateRect(hWnd,lpRect);
	fprintf(fp,"OUT ['ValidateRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetCaretBlinkTime) () = GetCaretBlinkTime;
UINT fake_GetCaretBlinkTime(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetCaretBlinkTime',");
	fprintf(fp,"]\n");
	UINT ret = pGetCaretBlinkTime();
	fprintf(fp,"OUT ['GetCaretBlinkTime',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInvalidateRect) (HWND hWnd,CONST RECT* lpRect,BOOL bErase) = InvalidateRect;
BOOL fake_InvalidateRect(HWND hWnd,CONST RECT* lpRect,BOOL bErase){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InvalidateRect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bErase','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bErase, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bErase','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bErase,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInvalidateRect(hWnd,lpRect,bErase);
	fprintf(fp,"OUT ['InvalidateRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetRawInputDeviceList) (PRAWINPUTDEVICELIST pRawInputDeviceList,PUINT puiNumDevices,UINT cbSize) = GetRawInputDeviceList;
UINT fake_GetRawInputDeviceList(PRAWINPUTDEVICELIST pRawInputDeviceList,PUINT puiNumDevices,UINT cbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetRawInputDeviceList',");
	if(1) fprintf(fp,"{'name':'puiNumDevices','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",puiNumDevices, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'puiNumDevices','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",puiNumDevices,sizeof(PUINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetRawInputDeviceList(pRawInputDeviceList,puiNumDevices,cbSize);
	fprintf(fp,"OUT ['GetRawInputDeviceList',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(puiNumDevices && 1) fprintf(fp,"{'name':'pRawInputDeviceList','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pRawInputDeviceList, sizeof(PRAWINPUTDEVICELIST),*puiNumDevices);
 	else fprintf(fp,"{'name':'pRawInputDeviceList','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pRawInputDeviceList,sizeof(PRAWINPUTDEVICELIST));
	if(puiNumDevices && pRawInputDeviceList){
		for(int i=0; i<*puiNumDevices;i++){
			fprintf(fp,"0x%x,",pRawInputDeviceList[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'puiNumDevices','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",puiNumDevices, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'puiNumDevices','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",puiNumDevices,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pGetMessageTime) () = GetMessageTime;
LONG fake_GetMessageTime(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMessageTime',");
	fprintf(fp,"]\n");
	LONG ret = pGetMessageTime();
	fprintf(fp,"OUT ['GetMessageTime',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pLoadCursorW) (HINSTANCE hInstance,LPCWSTR lpCursorName) = LoadCursorW;
HCURSOR fake_LoadCursorW(HINSTANCE hInstance,LPCWSTR lpCursorName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadCursorW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpCursorName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpCursorName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpCursorName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpCursorName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpCursorName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pLoadCursorW(hInstance,lpCursorName);
	fprintf(fp,"OUT ['LoadCursorW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetSystemMetrics) (int nIndex) = GetSystemMetrics;
int fake_GetSystemMetrics(int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetSystemMetrics',");
	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetSystemMetrics(nIndex);
	fprintf(fp,"OUT ['GetSystemMetrics',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetWindowModuleFileNameA) (HWND hwnd,LPSTR pszFileName,UINT cchFileNameMax) = GetWindowModuleFileNameA;
UINT fake_GetWindowModuleFileNameA(HWND hwnd,LPSTR pszFileName,UINT cchFileNameMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowModuleFileNameA',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchFileNameMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchFileNameMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cchFileNameMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchFileNameMax,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetWindowModuleFileNameA(hwnd,pszFileName,cchFileNameMax);
	fprintf(fp,"OUT ['GetWindowModuleFileNameA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pszFileName','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pszFileName, sizeof(LPSTR),cchFileNameMax, ret);
 	else fprintf(fp,"{'name':'pszFileName','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pszFileName,sizeof(LPSTR));
	if(pszFileName){
		for(int i=0; i<cchFileNameMax <  ret ? cchFileNameMax :  ret;i++){
			fprintf(fp,"0x%x,",pszFileName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

INT_PTR (WINAPI *pDialogBoxIndirectParamW) (HINSTANCE hInstance,LPCDLGTEMPLATEW hDialogTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = DialogBoxIndirectParamW;
INT_PTR fake_DialogBoxIndirectParamW(HINSTANCE hInstance,LPCDLGTEMPLATEW hDialogTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DialogBoxIndirectParamW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hDialogTemplate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDialogTemplate, sizeof(LPCDLGTEMPLATEW),1);
 	else fprintf(fp,"{'name':'hDialogTemplate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDialogTemplate,sizeof(LPCDLGTEMPLATEW));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	INT_PTR ret = pDialogBoxIndirectParamW(hInstance,hDialogTemplate,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['DialogBoxIndirectParamW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(INT_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(INT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pFindWindowExA) (HWND hWndParent,HWND hWndChildAfter,LPCSTR lpszClass,LPCSTR lpszWindow) = FindWindowExA;
HWND fake_FindWindowExA(HWND hWndParent,HWND hWndChildAfter,LPCSTR lpszClass,LPCSTR lpszWindow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FindWindowExA',");
	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndChildAfter','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndChildAfter, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndChildAfter','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndChildAfter,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszClass','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszClass, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszClass','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszClass,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszWindow','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszWindow, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszWindow','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszWindow,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pFindWindowExA(hWndParent,hWndChildAfter,lpszClass,lpszWindow);
	fprintf(fp,"OUT ['FindWindowExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShutdownBlockReasonDestroy) (HWND hWnd) = ShutdownBlockReasonDestroy;
BOOL fake_ShutdownBlockReasonDestroy(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShutdownBlockReasonDestroy',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShutdownBlockReasonDestroy(hWnd);
	fprintf(fp,"OUT ['ShutdownBlockReasonDestroy',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetCaretPos) (int X,int Y) = SetCaretPos;
BOOL fake_SetCaretPos(int X,int Y){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetCaretPos',");
	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetCaretPos(X,Y);
	fprintf(fp,"OUT ['SetCaretPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPtInRect) (CONST RECT* lprc,POINT pt) = PtInRect;
BOOL fake_PtInRect(CONST RECT* lprc,POINT pt){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PtInRect',");
	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pt','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",pt, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'pt','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pt,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPtInRect(lprc,pt);
	fprintf(fp,"OUT ['PtInRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnhookWindowsHookEx) (HHOOK hhk) = UnhookWindowsHookEx;
BOOL fake_UnhookWindowsHookEx(HHOOK hhk){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnhookWindowsHookEx',");
	if(1) fprintf(fp,"{'name':'hhk','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hhk, sizeof(HHOOK),1);
 	else fprintf(fp,"{'name':'hhk','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hhk,sizeof(HHOOK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnhookWindowsHookEx(hhk);
	fprintf(fp,"OUT ['UnhookWindowsHookEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

long (WINAPI *pBroadcastSystemMessageW) (DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam) = BroadcastSystemMessageW;
long fake_BroadcastSystemMessageW(DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BroadcastSystemMessageW',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	long ret = pBroadcastSystemMessageW(flags,lpInfo,Msg,wParam,lParam);
	fprintf(fp,"OUT ['BroadcastSystemMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(long),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(long));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetMouseMovePointsEx) (UINT cbSize,LPMOUSEMOVEPOINT lppt,LPMOUSEMOVEPOINT lpptBuf,int nBufPoints,DWORD resolution) = GetMouseMovePointsEx;
int fake_GetMouseMovePointsEx(UINT cbSize,LPMOUSEMOVEPOINT lppt,LPMOUSEMOVEPOINT lpptBuf,int nBufPoints,DWORD resolution){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMouseMovePointsEx',");
	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lppt','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lppt, sizeof(LPMOUSEMOVEPOINT),1);
 	else fprintf(fp,"{'name':'lppt','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lppt,sizeof(LPMOUSEMOVEPOINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBufPoints','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBufPoints, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBufPoints','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBufPoints,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'resolution','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",resolution, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'resolution','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",resolution,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetMouseMovePointsEx(cbSize,lppt,lpptBuf,nBufPoints,resolution);
	fprintf(fp,"OUT ['GetMouseMovePointsEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpptBuf','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpptBuf, sizeof(LPMOUSEMOVEPOINT),nBufPoints);
 	else fprintf(fp,"{'name':'lpptBuf','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpptBuf,sizeof(LPMOUSEMOVEPOINT));
	if(lpptBuf){
		for(int i=0; i<nBufPoints;i++){
			fprintf(fp,"0x%x,",lpptBuf[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetShellWindow) () = GetShellWindow;
HWND fake_GetShellWindow(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetShellWindow',");
	fprintf(fp,"]\n");
	HWND ret = pGetShellWindow();
	fprintf(fp,"OUT ['GetShellWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetClassNameA) (HWND hWnd,LPSTR lpClassName) = GetClassNameA;
int fake_GetClassNameA(HWND hWnd,LPSTR lpClassName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassNameA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetClassNameA(hWnd,lpClassName);
	fprintf(fp,"OUT ['GetClassNameA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpClassName','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpClassName, sizeof(LPSTR),nMaxCount, ret);
 	else fprintf(fp,"{'name':'lpClassName','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClassName,sizeof(LPSTR));
	if(lpClassName){
		for(int i=0; i<nMaxCount <  ret ? nMaxCount :  ret;i++){
			fprintf(fp,"0x%x,",lpClassName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pLoadMenuW) (HINSTANCE hInstance,LPCWSTR lpMenuName) = LoadMenuW;
HMENU fake_LoadMenuW(HINSTANCE hInstance,LPCWSTR lpMenuName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadMenuW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpMenuName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpMenuName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpMenuName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpMenuName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpMenuName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pLoadMenuW(hInstance,lpMenuName);
	fprintf(fp,"OUT ['LoadMenuW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShutdownBlockReasonCreate) (HWND hWnd,LPCWSTR pwszReason) = ShutdownBlockReasonCreate;
BOOL fake_ShutdownBlockReasonCreate(HWND hWnd,LPCWSTR pwszReason){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShutdownBlockReasonCreate',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pwszReason',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", pwszReason);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", pwszReason);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'pwszReason',");
		fwprintf(fp, L"'value': '\"%s\"', ", pwszReason);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShutdownBlockReasonCreate(hWnd,pwszReason);
	fprintf(fp,"OUT ['ShutdownBlockReasonCreate',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pSendDlgItemMessageW) (HWND hDlg,int nIDDlgItem,UINT Msg,WPARAM wParam,LPARAM lParam) = SendDlgItemMessageW;
LRESULT fake_SendDlgItemMessageW(HWND hDlg,int nIDDlgItem,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendDlgItemMessageW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pSendDlgItemMessageW(hDlg,nIDDlgItem,Msg,wParam,lParam);
	fprintf(fp,"OUT ['SendDlgItemMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetWindowRgnBox) (HWND hWnd,LPRECT lprc) = GetWindowRgnBox;
int fake_GetWindowRgnBox(HWND hWnd,LPRECT lprc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowRgnBox',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetWindowRgnBox(hWnd,lprc);
	fprintf(fp,"OUT ['GetWindowRgnBox',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pInSendMessageEx) (LPVOID lpReserved) = InSendMessageEx;
DWORD fake_InSendMessageEx(LPVOID lpReserved){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InSendMessageEx',");
	if(1) fprintf(fp,"{'name':'lpReserved','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpReserved, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'lpReserved','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpReserved,sizeof(LPVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pInSendMessageEx(lpReserved);
	fprintf(fp,"OUT ['InSendMessageEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pLoadImageW) (HINSTANCE hInst,LPCWSTR name,UINT type,int cx,int cy,UINT fuLoad) = LoadImageW;
HANDLE fake_LoadImageW(HINSTANCE hInst,LPCWSTR name,UINT type,int cx,int cy,UINT fuLoad){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadImageW',");
	if(1) fprintf(fp,"{'name':'hInst','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInst, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInst','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInst,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'name',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", name);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", name);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'name',");
		fwprintf(fp, L"'value': '\"%s\"', ", name);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'type','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",type, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'type','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",type,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fuLoad','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fuLoad, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fuLoad','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fuLoad,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pLoadImageW(hInst,name,type,cx,cy,fuLoad);
	fprintf(fp,"OUT ['LoadImageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefRawInputProc) (PRAWINPUT*  paRawInput,INT nInput,UINT cbSizeHeader) = DefRawInputProc;
LRESULT fake_DefRawInputProc(PRAWINPUT*  paRawInput,INT nInput,UINT cbSizeHeader){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefRawInputProc',");
	if(1) fprintf(fp,"{'name':' paRawInput','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", paRawInput, sizeof(PRAWINPUT*),nInput);
 	else fprintf(fp,"{'name':' paRawInput','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", paRawInput,sizeof(PRAWINPUT*));
	if( paRawInput){
		for(int i=0; i<nInput;i++){
			fprintf(fp,"0x%x,", paRawInput[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nInput','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nInput, sizeof(INT),1);
 	else fprintf(fp,"{'name':'nInput','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nInput,sizeof(INT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSizeHeader','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSizeHeader, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSizeHeader','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSizeHeader,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefRawInputProc( paRawInput,nInput,cbSizeHeader);
	fprintf(fp,"OUT ['DefRawInputProc',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pSetClipboardViewer) (HWND hWndNewViewer) = SetClipboardViewer;
HWND fake_SetClipboardViewer(HWND hWndNewViewer){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClipboardViewer',");
	if(1) fprintf(fp,"{'name':'hWndNewViewer','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndNewViewer, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndNewViewer','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndNewViewer,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pSetClipboardViewer(hWndNewViewer);
	fprintf(fp,"OUT ['SetClipboardViewer',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pTabbedTextOutW) (HDC hdc,int x,int y,LPCWSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions,int nTabOrigin) = TabbedTextOutW;
LONG fake_TabbedTextOutW(HDC hdc,int x,int y,LPCWSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions,int nTabOrigin){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TabbedTextOutW',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'x','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",x, sizeof(int),1);
 	else fprintf(fp,"{'name':'x','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",x,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",y, sizeof(int),1);
 	else fprintf(fp,"{'name':'y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",y,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),chCount);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	if(lpString){
		for(int i=0; i<chCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'chCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",chCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'chCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",chCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nTabPositions','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTabPositions, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTabPositions','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTabPositions,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnTabStopPositions','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnTabStopPositions, sizeof(CONST INT*),nTabPositions);
 	else fprintf(fp,"{'name':'lpnTabStopPositions','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnTabStopPositions,sizeof(CONST INT*));
	if(lpnTabStopPositions){
		for(int i=0; i<nTabPositions;i++){
			fprintf(fp,"0x%x,",lpnTabStopPositions[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nTabOrigin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTabOrigin, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTabOrigin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTabOrigin,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pTabbedTextOutW(hdc,x,y,lpString,chCount,nTabPositions,lpnTabStopPositions,nTabOrigin);
	fprintf(fp,"OUT ['TabbedTextOutW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetComboBoxInfo) (HWND hwndCombo,PCOMBOBOXINFO pcbi) = GetComboBoxInfo;
BOOL fake_GetComboBoxInfo(HWND hwndCombo,PCOMBOBOXINFO pcbi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetComboBoxInfo',");
	if(1) fprintf(fp,"{'name':'hwndCombo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndCombo, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndCombo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndCombo,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbi, sizeof(PCOMBOBOXINFO),1);
 	else fprintf(fp,"{'name':'pcbi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbi,sizeof(PCOMBOBOXINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetComboBoxInfo(hwndCombo,pcbi);
	fprintf(fp,"OUT ['GetComboBoxInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbi, sizeof(PCOMBOBOXINFO),1);
 	else fprintf(fp,"{'name':'pcbi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbi,sizeof(PCOMBOBOXINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetInputState) () = GetInputState;
BOOL fake_GetInputState(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetInputState',");
	fprintf(fp,"]\n");
	BOOL ret = pGetInputState();
	fprintf(fp,"OUT ['GetInputState',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsWow64Message) () = IsWow64Message;
BOOL fake_IsWow64Message(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsWow64Message',");
	fprintf(fp,"]\n");
	BOOL ret = pIsWow64Message();
	fprintf(fp,"OUT ['IsWow64Message',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharUpperA) (CHAR ch) = IsCharUpperA;
BOOL fake_IsCharUpperA(CHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharUpperA',");
	if(1) fprintf(fp,"{'name':'ch','value': '\"%c\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ch, sizeof(CHAR),1);
 	else fprintf(fp,"{'name':'ch','value': '\"%c\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ch,sizeof(CHAR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharUpperA(ch);
	fprintf(fp,"OUT ['IsCharUpperA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMessageBoxIndirectA) (CONST MSGBOXPARAMSA*  lpmbp) = MessageBoxIndirectA;
int fake_MessageBoxIndirectA(CONST MSGBOXPARAMSA*  lpmbp){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBoxIndirectA',");
	if(1) fprintf(fp,"{'name':' lpmbp','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpmbp, sizeof(CONST MSGBOXPARAMSA*),1);
 	else fprintf(fp,"{'name':' lpmbp','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpmbp,sizeof(CONST MSGBOXPARAMSA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMessageBoxIndirectA( lpmbp);
	fprintf(fp,"OUT ['MessageBoxIndirectA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pCopyCursor) (HCURSOR hCursor) = CopyCursor;
HCURSOR fake_CopyCursor(HCURSOR hCursor){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CopyCursor',");
	if(1) fprintf(fp,"{'name':'hCursor','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hCursor, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'hCursor','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hCursor,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pCopyCursor(hCursor);
	fprintf(fp,"OUT ['CopyCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pChangeDisplaySettingsExW) (LPCWSTR lpszDeviceName,DEVMODEW*  lpDevMode,HWND hwnd,DWORD dwflags,LPVOID lParam) = ChangeDisplaySettingsExW;
LONG fake_ChangeDisplaySettingsExW(LPCWSTR lpszDeviceName,DEVMODEW*  lpDevMode,HWND hwnd,DWORD dwflags,LPVOID lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeDisplaySettingsExW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszDeviceName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDeviceName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDeviceName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDeviceName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDeviceName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwflags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwflags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwflags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwflags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'lParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pChangeDisplaySettingsExW(lpszDeviceName, lpDevMode,hwnd,dwflags,lParam);
	fprintf(fp,"OUT ['ChangeDisplaySettingsExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEndDeferWindowPos) (HDWP hWinPosInfo) = EndDeferWindowPos;
BOOL fake_EndDeferWindowPos(HDWP hWinPosInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EndDeferWindowPos',");
	if(1) fprintf(fp,"{'name':'hWinPosInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWinPosInfo, sizeof(HDWP),1);
 	else fprintf(fp,"{'name':'hWinPosInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWinPosInfo,sizeof(HDWP));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEndDeferWindowPos(hWinPosInfo);
	fprintf(fp,"OUT ['EndDeferWindowPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pTrackPopupMenu) (HMENU hMenu,UINT uFlags,int x,int y,int nReserved,HWND hWnd,CONST RECT* prcRect) = TrackPopupMenu;
BOOL fake_TrackPopupMenu(HMENU hMenu,UINT uFlags,int x,int y,int nReserved,HWND hWnd,CONST RECT* prcRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TrackPopupMenu',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'x','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",x, sizeof(int),1);
 	else fprintf(fp,"{'name':'x','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",x,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",y, sizeof(int),1);
 	else fprintf(fp,"{'name':'y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nReserved','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nReserved, sizeof(int),1);
 	else fprintf(fp,"{'name':'nReserved','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nReserved,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'prcRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",prcRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'prcRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",prcRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pTrackPopupMenu(hMenu,uFlags,x,y,nReserved,hWnd,prcRect);
	fprintf(fp,"OUT ['TrackPopupMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pSetDisplayConfig) (UINT32 numPathArrayElements,DISPLAYCONFIG_PATH_INFO*  pathArray,UINT32 numModeInfoArrayElements,DISPLAYCONFIG_MODE_INFO*  modeInfoArray,UINT32 flags) = SetDisplayConfig;
LONG fake_SetDisplayConfig(UINT32 numPathArrayElements,DISPLAYCONFIG_PATH_INFO*  pathArray,UINT32 numModeInfoArrayElements,DISPLAYCONFIG_MODE_INFO*  modeInfoArray,UINT32 flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetDisplayConfig',");
	if(1) fprintf(fp,"{'name':'numPathArrayElements','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",numPathArrayElements, sizeof(UINT32),1);
 	else fprintf(fp,"{'name':'numPathArrayElements','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",numPathArrayElements,sizeof(UINT32));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pathArray','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pathArray, sizeof(DISPLAYCONFIG_PATH_INFO*),numPathArrayElements);
 	else fprintf(fp,"{'name':' pathArray','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pathArray,sizeof(DISPLAYCONFIG_PATH_INFO*));
	if( pathArray){
		for(int i=0; i<numPathArrayElements;i++){
			fprintf(fp,"0x%x,", pathArray[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'numModeInfoArrayElements','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",numModeInfoArrayElements, sizeof(UINT32),1);
 	else fprintf(fp,"{'name':'numModeInfoArrayElements','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",numModeInfoArrayElements,sizeof(UINT32));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' modeInfoArray','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", modeInfoArray, sizeof(DISPLAYCONFIG_MODE_INFO*),numModeInfoArrayElements);
 	else fprintf(fp,"{'name':' modeInfoArray','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", modeInfoArray,sizeof(DISPLAYCONFIG_MODE_INFO*));
	if( modeInfoArray){
		for(int i=0; i<numModeInfoArrayElements;i++){
			fprintf(fp,"0x%x,", modeInfoArray[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT32),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT32));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pSetDisplayConfig(numPathArrayElements, pathArray,numModeInfoArrayElements, modeInfoArray,flags);
	fprintf(fp,"OUT ['SetDisplayConfig',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HACCEL (WINAPI *pCreateAcceleratorTableA) (LPACCEL paccel,int cAccel) = CreateAcceleratorTableA;
HACCEL fake_CreateAcceleratorTableA(LPACCEL paccel,int cAccel){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateAcceleratorTableA',");
	if(1) fprintf(fp,"{'name':'paccel','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",paccel, sizeof(LPACCEL),cAccel);
 	else fprintf(fp,"{'name':'paccel','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",paccel,sizeof(LPACCEL));
	if(paccel){
		for(int i=0; i<cAccel;i++){
			fprintf(fp,"0x%x,",paccel[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cAccel','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cAccel, sizeof(int),1);
 	else fprintf(fp,"{'name':'cAccel','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cAccel,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HACCEL ret = pCreateAcceleratorTableA(paccel,cAccel);
	fprintf(fp,"OUT ['CreateAcceleratorTableA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HACCEL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWINSTA (WINAPI *pGetProcessWindowStation) () = GetProcessWindowStation;
HWINSTA fake_GetProcessWindowStation(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetProcessWindowStation',");
	fprintf(fp,"]\n");
	HWINSTA ret = pGetProcessWindowStation();
	fprintf(fp,"OUT ['GetProcessWindowStation',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetWindowContextHelpId) (HWND arg0,DWORD arg1) = SetWindowContextHelpId;
BOOL fake_SetWindowContextHelpId(HWND arg0,DWORD arg1){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowContextHelpId',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'arg1','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetWindowContextHelpId(arg0,arg1);
	fprintf(fp,"OUT ['SetWindowContextHelpId',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pCreateDesktopExW) (LPCWSTR lpszDesktop,LPCWSTR lpszDevice,DEVMODEW*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa,ULONG ulHeapSize,PVOID pvoid) = CreateDesktopExW;
HDESK fake_CreateDesktopExW(LPCWSTR lpszDesktop,LPCWSTR lpszDevice,DEVMODEW*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa,ULONG ulHeapSize,PVOID pvoid){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDesktopExW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszDesktop',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDesktop);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDesktop);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDesktop',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDesktop);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszDevice',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDevice);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDevice);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDevice',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDevice);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pDevmode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pDevmode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' pDevmode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pDevmode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsa','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsa, sizeof(LPSECURITY_ATTRIBUTES),1);
 	else fprintf(fp,"{'name':'lpsa','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsa,sizeof(LPSECURITY_ATTRIBUTES));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'ulHeapSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ulHeapSize, sizeof(ULONG),1);
 	else fprintf(fp,"{'name':'ulHeapSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ulHeapSize,sizeof(ULONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvoid','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvoid, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvoid','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvoid,sizeof(PVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pCreateDesktopExW(lpszDesktop,lpszDevice, pDevmode,dwFlags,dwDesiredAccess,lpsa,ulHeapSize,pvoid);
	fprintf(fp,"OUT ['CreateDesktopExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

long (WINAPI *pGetDialogBaseUnits) () = GetDialogBaseUnits;
long fake_GetDialogBaseUnits(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDialogBaseUnits',");
	fprintf(fp,"]\n");
	long ret = pGetDialogBaseUnits();
	fprintf(fp,"OUT ['GetDialogBaseUnits',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(long),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(long));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateWindowExW) (DWORD dwExStyle,LPCWSTR lpClassName,LPCWSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HMENU hMenu,HINSTANCE hInstance,LPVOID lpParam) = CreateWindowExW;
HWND fake_CreateWindowExW(DWORD dwExStyle,LPCWSTR lpClassName,LPCWSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HMENU hMenu,HINSTANCE hInstance,LPVOID lpParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateWindowExW',");
	if(1) fprintf(fp,"{'name':'dwExStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwExStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwExStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwExStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpClassName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpWindowName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpWindowName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpWindowName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpWindowName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpWindowName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpParam, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'lpParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpParam,sizeof(LPVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateWindowExW(dwExStyle,lpClassName,lpWindowName,dwStyle,X,Y,nWidth,nHeight,hWndParent,hMenu,hInstance,lpParam);
	fprintf(fp,"OUT ['CreateWindowExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetMenuStringA) (HMENU hMenu,UINT uIDItem,LPSTR lpString,int cchMax,UINT flags) = GetMenuStringA;
int fake_GetMenuStringA(HMENU hMenu,UINT uIDItem,LPSTR lpString,int cchMax,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuStringA',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uIDItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDItem,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMax,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetMenuStringA(hMenu,uIDItem,lpString,cchMax,flags);
	fprintf(fp,"OUT ['GetMenuStringA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPSTR),cchMax);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPSTR));
	if(lpString){
		for(int i=0; i<cchMax;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUserHandleGrantAccess) (HANDLE hUserHandle,HANDLE hJob,BOOL bGrant) = UserHandleGrantAccess;
BOOL fake_UserHandleGrantAccess(HANDLE hUserHandle,HANDLE hJob,BOOL bGrant){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UserHandleGrantAccess',");
	if(1) fprintf(fp,"{'name':'hUserHandle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hUserHandle, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hUserHandle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hUserHandle,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hJob','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hJob, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hJob','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hJob,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bGrant','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bGrant, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bGrant','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bGrant,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUserHandleGrantAccess(hUserHandle,hJob,bGrant);
	fprintf(fp,"OUT ['UserHandleGrantAccess',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRegisterHotKey) (HWND hWnd,int id,UINT fsModifiers,UINT vk) = RegisterHotKey;
BOOL fake_RegisterHotKey(HWND hWnd,int id,UINT fsModifiers,UINT vk){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterHotKey',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'id','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",id, sizeof(int),1);
 	else fprintf(fp,"{'name':'id','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",id,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fsModifiers','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fsModifiers, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fsModifiers','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fsModifiers,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'vk','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",vk, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'vk','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",vk,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRegisterHotKey(hWnd,id,fsModifiers,vk);
	fprintf(fp,"OUT ['RegisterHotKey',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEqualRect) (CONST RECT* lprc1,CONST RECT* lprc2) = EqualRect;
BOOL fake_EqualRect(CONST RECT* lprc1,CONST RECT* lprc2){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EqualRect',");
	if(1) fprintf(fp,"{'name':'lprc1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc1, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc1,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc2','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc2, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc2','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc2,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEqualRect(lprc1,lprc2);
	fprintf(fp,"OUT ['EqualRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenuItemInfoA) (HMENU hmenu,UINT item,BOOL fByPositon,LPCMENUITEMINFOA lpmii) = SetMenuItemInfoA;
BOOL fake_SetMenuItemInfoA(HMENU hmenu,UINT item,BOOL fByPositon,LPCMENUITEMINFOA lpmii){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenuItemInfoA',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'item','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",item, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'item','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",item,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPositon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPositon, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fByPositon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPositon,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmii, sizeof(LPCMENUITEMINFOA),1);
 	else fprintf(fp,"{'name':'lpmii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmii,sizeof(LPCMENUITEMINFOA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenuItemInfoA(hmenu,item,fByPositon,lpmii);
	fprintf(fp,"OUT ['SetMenuItemInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPSTR (WINAPI *pCharLowerA) (LPSTR lpsz) = CharLowerA;
LPSTR fake_CharLowerA(LPSTR lpsz){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharLowerA',");
	if(1) fprintf(fp,"{'name':'lpsz','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpsz','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPSTR ret = pCharLowerA(lpsz);
	fprintf(fp,"OUT ['CharLowerA',");
	if(1) fprintf(fp,"{'name':'ret','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'ret','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsz','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpsz','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetProcessDPIAware) () = SetProcessDPIAware;
BOOL fake_SetProcessDPIAware(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetProcessDPIAware',");
	fprintf(fp,"]\n");
	BOOL ret = pSetProcessDPIAware();
	fprintf(fp,"OUT ['SetProcessDPIAware',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pWaitForInputIdle) (HANDLE hProcess,DWORD dwMilliseconds) = WaitForInputIdle;
DWORD fake_WaitForInputIdle(HANDLE hProcess,DWORD dwMilliseconds){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WaitForInputIdle',");
	if(1) fprintf(fp,"{'name':'hProcess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hProcess, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hProcess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hProcess,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwMilliseconds','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwMilliseconds, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwMilliseconds','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwMilliseconds,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pWaitForInputIdle(hProcess,dwMilliseconds);
	fprintf(fp,"OUT ['WaitForInputIdle',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCharToOemW) (LPCWSTR pSrc,LPSTR pDst) = CharToOemW;
BOOL fake_CharToOemW(LPCWSTR pSrc,LPSTR pDst){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharToOemW',");
	if(1)
	{
		fprintf(fp,"{'name':'pSrc',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", pSrc);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", pSrc);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'pSrc',");
		fwprintf(fp, L"'value': '\"%s\"', ", pSrc);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCharToOemW(pSrc,pDst);
	fprintf(fp,"OUT ['CharToOemW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pDst','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pDst, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'pDst','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pDst,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetRawInputDeviceInfoW) (HANDLE hDevice,UINT uiCommand,LPVOID pData,PUINT pcbSize) = GetRawInputDeviceInfoW;
UINT fake_GetRawInputDeviceInfoW(HANDLE hDevice,UINT uiCommand,LPVOID pData,PUINT pcbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetRawInputDeviceInfoW',");
	if(1) fprintf(fp,"{'name':'hDevice','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDevice, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hDevice','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDevice,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiCommand','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiCommand, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiCommand','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiCommand,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pData','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pData, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'pData','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pData,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetRawInputDeviceInfoW(hDevice,uiCommand,pData,pcbSize);
	fprintf(fp,"OUT ['GetRawInputDeviceInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pData','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pData, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'pData','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pData,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pTrackMouseEvent) (LPTRACKMOUSEEVENT lpEventTrack) = TrackMouseEvent;
BOOL fake_TrackMouseEvent(LPTRACKMOUSEEVENT lpEventTrack){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TrackMouseEvent',");
	if(1) fprintf(fp,"{'name':'lpEventTrack','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEventTrack, sizeof(LPTRACKMOUSEEVENT),1);
 	else fprintf(fp,"{'name':'lpEventTrack','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEventTrack,sizeof(LPTRACKMOUSEEVENT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pTrackMouseEvent(lpEventTrack);
	fprintf(fp,"OUT ['TrackMouseEvent',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEventTrack','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEventTrack, sizeof(LPTRACKMOUSEEVENT),1);
 	else fprintf(fp,"{'name':'lpEventTrack','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEventTrack,sizeof(LPTRACKMOUSEEVENT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pCharUpperBuffW) (LPWSTR lpsz,DWORD cchLength) = CharUpperBuffW;
DWORD fake_CharUpperBuffW(LPWSTR lpsz,DWORD cchLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharUpperBuffW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchLength);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': %p, ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pCharUpperBuffW(lpsz,cchLength);
	fprintf(fp,"OUT ['CharUpperBuffW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchLength);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': %p, ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPostThreadMessageW) (DWORD idThread,UINT Msg,WPARAM wParam,LPARAM lParam) = PostThreadMessageW;
BOOL fake_PostThreadMessageW(DWORD idThread,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PostThreadMessageW',");
	if(1) fprintf(fp,"{'name':'idThread','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idThread, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idThread','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idThread,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPostThreadMessageW(idThread,Msg,wParam,lParam);
	fprintf(fp,"OUT ['PostThreadMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HKL (WINAPI *pLoadKeyboardLayoutA) (LPCSTR pwszKLID,UINT Flags) = LoadKeyboardLayoutA;
HKL fake_LoadKeyboardLayoutA(LPCSTR pwszKLID,UINT Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadKeyboardLayoutA',");
	if(1) fprintf(fp,"{'name':'pwszKLID','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pwszKLID, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'pwszKLID','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pwszKLID,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HKL ret = pLoadKeyboardLayoutA(pwszKLID,Flags);
	fprintf(fp,"OUT ['LoadKeyboardLayoutA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pRemovePropA) (HWND hWnd,LPCSTR lpString) = RemovePropA;
HANDLE fake_RemovePropA(HWND hWnd,LPCSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RemovePropA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpString','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pRemovePropA(hWnd,lpString);
	fprintf(fp,"OUT ['RemovePropA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pTabbedTextOutA) (HDC hdc,int x,int y,LPCSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions,int nTabOrigin) = TabbedTextOutA;
LONG fake_TabbedTextOutA(HDC hdc,int x,int y,LPCSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions,int nTabOrigin){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TabbedTextOutA',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'x','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",x, sizeof(int),1);
 	else fprintf(fp,"{'name':'x','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",x,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",y, sizeof(int),1);
 	else fprintf(fp,"{'name':'y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),chCount);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	if(lpString){
		for(int i=0; i<chCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'chCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",chCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'chCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",chCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nTabPositions','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTabPositions, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTabPositions','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTabPositions,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnTabStopPositions','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnTabStopPositions, sizeof(CONST INT*),nTabPositions);
 	else fprintf(fp,"{'name':'lpnTabStopPositions','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnTabStopPositions,sizeof(CONST INT*));
	if(lpnTabStopPositions){
		for(int i=0; i<nTabPositions;i++){
			fprintf(fp,"0x%x,",lpnTabStopPositions[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nTabOrigin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTabOrigin, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTabOrigin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTabOrigin,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pTabbedTextOutA(hdc,x,y,lpString,chCount,nTabPositions,lpnTabStopPositions,nTabOrigin);
	fprintf(fp,"OUT ['TabbedTextOutA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetActiveWindow) () = GetActiveWindow;
HWND fake_GetActiveWindow(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetActiveWindow',");
	fprintf(fp,"]\n");
	HWND ret = pGetActiveWindow();
	fprintf(fp,"OUT ['GetActiveWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsWindowVisible) (HWND hWnd) = IsWindowVisible;
BOOL fake_IsWindowVisible(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsWindowVisible',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsWindowVisible(hWnd);
	fprintf(fp,"OUT ['IsWindowVisible',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetTitleBarInfo) (HWND hwnd,PTITLEBARINFO pti) = GetTitleBarInfo;
BOOL fake_GetTitleBarInfo(HWND hwnd,PTITLEBARINFO pti){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetTitleBarInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pti','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pti, sizeof(PTITLEBARINFO),1);
 	else fprintf(fp,"{'name':'pti','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pti,sizeof(PTITLEBARINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetTitleBarInfo(hwnd,pti);
	fprintf(fp,"OUT ['GetTitleBarInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pti','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pti, sizeof(PTITLEBARINFO),1);
 	else fprintf(fp,"{'name':'pti','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pti,sizeof(PTITLEBARINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

long (WINAPI *pBroadcastSystemMessageA) (DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam) = BroadcastSystemMessageA;
long fake_BroadcastSystemMessageA(DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BroadcastSystemMessageA',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	long ret = pBroadcastSystemMessageA(flags,lpInfo,Msg,wParam,lParam);
	fprintf(fp,"OUT ['BroadcastSystemMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(long),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(long));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetForegroundWindow) (HWND hWnd) = SetForegroundWindow;
BOOL fake_SetForegroundWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetForegroundWindow(hWnd);
	fprintf(fp,"OUT ['SetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDispatchMessageA) (CONST MSG* lpMsg) = DispatchMessageA;
LRESULT fake_DispatchMessageA(CONST MSG* lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DispatchMessageA',");
	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(CONST MSG*),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(CONST MSG*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDispatchMessageA(lpMsg);
	fprintf(fp,"OUT ['DispatchMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HPOWERNOTIFY (WINAPI *pRegisterPowerSettingNotification) (HANDLE hRecipient,LPCGUID PowerSettingGuid) = RegisterPowerSettingNotification;
HPOWERNOTIFY fake_RegisterPowerSettingNotification(HANDLE hRecipient,LPCGUID PowerSettingGuid){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterPowerSettingNotification',");
	if(1) fprintf(fp,"{'name':'hRecipient','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRecipient, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hRecipient','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRecipient,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'PowerSettingGuid','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",PowerSettingGuid, sizeof(LPCGUID),1);
 	else fprintf(fp,"{'name':'PowerSettingGuid','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",PowerSettingGuid,sizeof(LPCGUID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HPOWERNOTIFY ret = pRegisterPowerSettingNotification(hRecipient,PowerSettingGuid);
	fprintf(fp,"OUT ['RegisterPowerSettingNotification',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HPOWERNOTIFY),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HPOWERNOTIFY));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pChangeWindowMessageFilter) (UINT message,DWORD dwFlag) = ChangeWindowMessageFilter;
BOOL fake_ChangeWindowMessageFilter(UINT message,DWORD dwFlag){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeWindowMessageFilter',");
	if(1) fprintf(fp,"{'name':'message','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",message, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'message','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",message,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlag','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlag, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlag','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlag,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pChangeWindowMessageFilter(message,dwFlag);
	fprintf(fp,"OUT ['ChangeWindowMessageFilter',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMapWindowPoints) (HWND hWndFrom,HWND hWndTo,LPPOINT lpPoints,UINT cPoints) = MapWindowPoints;
int fake_MapWindowPoints(HWND hWndFrom,HWND hWndTo,LPPOINT lpPoints,UINT cPoints){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MapWindowPoints',");
	if(1) fprintf(fp,"{'name':'hWndFrom','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndFrom, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndFrom','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndFrom,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndTo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndTo, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndTo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndTo,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoints','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoints, sizeof(LPPOINT),cPoints);
 	else fprintf(fp,"{'name':'lpPoints','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoints,sizeof(LPPOINT));
	if(lpPoints){
		for(int i=0; i<cPoints;i++){
			fprintf(fp,"0x%x,",lpPoints[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cPoints','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cPoints, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cPoints','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cPoints,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMapWindowPoints(hWndFrom,hWndTo,lpPoints,cPoints);
	fprintf(fp,"OUT ['MapWindowPoints',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoints','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoints, sizeof(LPPOINT),cPoints);
 	else fprintf(fp,"{'name':'lpPoints','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoints,sizeof(LPPOINT));
	if(lpPoints){
		for(int i=0; i<cPoints;i++){
			fprintf(fp,"0x%x,",lpPoints[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetTopWindow) (HWND hWnd) = GetTopWindow;
HWND fake_GetTopWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetTopWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetTopWindow(hWnd);
	fprintf(fp,"OUT ['GetTopWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetLayeredWindowAttributes) (HWND hwnd,COLORREF*  pcrKey,BYTE*  pbAlpha,DWORD*  pdwFlags) = GetLayeredWindowAttributes;
BOOL fake_GetLayeredWindowAttributes(HWND hwnd,COLORREF*  pcrKey,BYTE*  pbAlpha,DWORD*  pdwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetLayeredWindowAttributes',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetLayeredWindowAttributes(hwnd, pcrKey, pbAlpha, pdwFlags);
	fprintf(fp,"OUT ['GetLayeredWindowAttributes',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pcrKey','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pcrKey, sizeof(COLORREF*),1);
 	else fprintf(fp,"{'name':' pcrKey','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pcrKey,sizeof(COLORREF*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pbAlpha','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pbAlpha, sizeof(BYTE*),1);
 	else fprintf(fp,"{'name':' pbAlpha','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pbAlpha,sizeof(BYTE*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pdwFlags','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pdwFlags, sizeof(DWORD*),1);
 	else fprintf(fp,"{'name':' pdwFlags','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pdwFlags,sizeof(DWORD*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ATOM (WINAPI *pRegisterClassA) (CONST WNDCLASSA* lpWndClass) = RegisterClassA;
ATOM fake_RegisterClassA(CONST WNDCLASSA* lpWndClass){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterClassA',");
	if(1) fprintf(fp,"{'name':'lpWndClass','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpWndClass, sizeof(CONST WNDCLASSA*),1);
 	else fprintf(fp,"{'name':'lpWndClass','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWndClass,sizeof(CONST WNDCLASSA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ATOM ret = pRegisterClassA(lpWndClass);
	fprintf(fp,"OUT ['RegisterClassA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ATOM),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ATOM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetDlgItem) (HWND hDlg,int nIDDlgItem) = GetDlgItem;
HWND fake_GetDlgItem(HWND hDlg,int nIDDlgItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDlgItem',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetDlgItem(hDlg,nIDDlgItem);
	fprintf(fp,"OUT ['GetDlgItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPaintDesktop) (HDC hdc) = PaintDesktop;
BOOL fake_PaintDesktop(HDC hdc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PaintDesktop',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPaintDesktop(hdc);
	fprintf(fp,"OUT ['PaintDesktop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPhysicalToLogicalPoint) (HWND hWnd,LPPOINT lpPoint) = PhysicalToLogicalPoint;
BOOL fake_PhysicalToLogicalPoint(HWND hWnd,LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PhysicalToLogicalPoint',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPhysicalToLogicalPoint(hWnd,lpPoint);
	fprintf(fp,"OUT ['PhysicalToLogicalPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pGetMenu) (HWND hWnd) = GetMenu;
HMENU fake_GetMenu(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenu',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pGetMenu(hWnd);
	fprintf(fp,"OUT ['GetMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDC (WINAPI *pGetDCEx) (HWND hWnd,HRGN hrgnClip,DWORD flags) = GetDCEx;
HDC fake_GetDCEx(HWND hWnd,HRGN hrgnClip,DWORD flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDCEx',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hrgnClip','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hrgnClip, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hrgnClip','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hrgnClip,sizeof(HRGN));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDC ret = pGetDCEx(hWnd,hrgnClip,flags);
	fprintf(fp,"OUT ['GetDCEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pCallWindowProcA) (FARPROC lpPrevWndFunc,HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = CallWindowProcA;
LRESULT fake_CallWindowProcA(FARPROC lpPrevWndFunc,HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CallWindowProcA',");
	if(1) fprintf(fp,"{'name':'lpPrevWndFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPrevWndFunc, sizeof(FARPROC),1);
 	else fprintf(fp,"{'name':'lpPrevWndFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPrevWndFunc,sizeof(FARPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pCallWindowProcA(lpPrevWndFunc,hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['CallWindowProcA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

INT_PTR (WINAPI *pDialogBoxIndirectParamA) (HINSTANCE hInstance,LPCDLGTEMPLATEA hDialogTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = DialogBoxIndirectParamA;
INT_PTR fake_DialogBoxIndirectParamA(HINSTANCE hInstance,LPCDLGTEMPLATEA hDialogTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DialogBoxIndirectParamA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hDialogTemplate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDialogTemplate, sizeof(LPCDLGTEMPLATEA),1);
 	else fprintf(fp,"{'name':'hDialogTemplate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDialogTemplate,sizeof(LPCDLGTEMPLATEA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	INT_PTR ret = pDialogBoxIndirectParamA(hInstance,hDialogTemplate,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['DialogBoxIndirectParamA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(INT_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(INT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMenuItemInfoW) (HMENU hmenu,UINT item,BOOL fByPosition,LPMENUITEMINFOW lpmii) = GetMenuItemInfoW;
BOOL fake_GetMenuItemInfoW(HMENU hmenu,UINT item,BOOL fByPosition,LPMENUITEMINFOW lpmii){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuItemInfoW',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'item','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",item, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'item','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",item,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPosition, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fByPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPosition,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmii, sizeof(LPMENUITEMINFOW),1);
 	else fprintf(fp,"{'name':'lpmii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmii,sizeof(LPMENUITEMINFOW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMenuItemInfoW(hmenu,item,fByPosition,lpmii);
	fprintf(fp,"OUT ['GetMenuItemInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmii, sizeof(LPMENUITEMINFOW),1);
 	else fprintf(fp,"{'name':'lpmii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmii,sizeof(LPMENUITEMINFOW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

SHORT (WINAPI *pVkKeyScanW) (WCHAR ch) = VkKeyScanW;
SHORT fake_VkKeyScanW(WCHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['VkKeyScanW',");
	if(1)
	{
		fprintf(fp,"{'name':'ch',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%c\"',", ch);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%c\"',", ch);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(WCHAR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ch',");
		fwprintf(fp, L"'value': '\"%c\"', ", ch);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(WCHAR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	SHORT ret = pVkKeyScanW(ch);
	fprintf(fp,"OUT ['VkKeyScanW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(SHORT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(SHORT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInsertMenuA) (HMENU hMenu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCSTR lpNewItem) = InsertMenuA;
BOOL fake_InsertMenuA(HMENU hMenu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCSTR lpNewItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InsertMenuA',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDNewItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDNewItem, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDNewItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDNewItem,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpNewItem','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpNewItem, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpNewItem','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpNewItem,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInsertMenuA(hMenu,uPosition,uFlags,uIDNewItem,lpNewItem);
	fprintf(fp,"OUT ['InsertMenuA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HHOOK (WINAPI *pSetWindowsHookExW) (int idHook,HOOKPROC lpfn,HINSTANCE hmod,DWORD dwThreadId) = SetWindowsHookExW;
HHOOK fake_SetWindowsHookExW(int idHook,HOOKPROC lpfn,HINSTANCE hmod,DWORD dwThreadId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowsHookExW',");
	if(1) fprintf(fp,"{'name':'idHook','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idHook, sizeof(int),1);
 	else fprintf(fp,"{'name':'idHook','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idHook,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpfn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpfn, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'lpfn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpfn,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hmod','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmod, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hmod','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmod,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwThreadId','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwThreadId, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwThreadId','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwThreadId,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HHOOK ret = pSetWindowsHookExW(idHook,lpfn,hmod,dwThreadId);
	fprintf(fp,"OUT ['SetWindowsHookExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HHOOK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HHOOK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetUserObjectSecurity) (HANDLE hObj,PSECURITY_INFORMATION pSIRequested,PSECURITY_DESCRIPTOR pSID,DWORD nLength,LPDWORD lpnLengthNeeded) = GetUserObjectSecurity;
BOOL fake_GetUserObjectSecurity(HANDLE hObj,PSECURITY_INFORMATION pSIRequested,PSECURITY_DESCRIPTOR pSID,DWORD nLength,LPDWORD lpnLengthNeeded){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetUserObjectSecurity',");
	if(1) fprintf(fp,"{'name':'hObj','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hObj, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hObj','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hObj,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pSIRequested','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pSIRequested, sizeof(PSECURITY_INFORMATION),1);
 	else fprintf(fp,"{'name':'pSIRequested','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSIRequested,sizeof(PSECURITY_INFORMATION));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetUserObjectSecurity(hObj,pSIRequested,pSID,nLength,lpnLengthNeeded);
	fprintf(fp,"OUT ['GetUserObjectSecurity',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pSID','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pSID, sizeof(PSECURITY_DESCRIPTOR),1);
 	else fprintf(fp,"{'name':'pSID','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSID,sizeof(PSECURITY_DESCRIPTOR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnLengthNeeded','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnLengthNeeded, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpnLengthNeeded','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnLengthNeeded,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pSetFocus) (HWND hWnd) = SetFocus;
HWND fake_SetFocus(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetFocus',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pSetFocus(hWnd);
	fprintf(fp,"OUT ['SetFocus',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetThreadDesktop) (HDESK hDesktop) = SetThreadDesktop;
BOOL fake_SetThreadDesktop(HDESK hDesktop){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetThreadDesktop',");
	if(1) fprintf(fp,"{'name':'hDesktop','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDesktop, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'hDesktop','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDesktop,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetThreadDesktop(hDesktop);
	fprintf(fp,"OUT ['SetThreadDesktop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pLogicalToPhysicalPoint) (HWND hWnd,LPPOINT lpPoint) = LogicalToPhysicalPoint;
BOOL fake_LogicalToPhysicalPoint(HWND hWnd,LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LogicalToPhysicalPoint',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pLogicalToPhysicalPoint(hWnd,lpPoint);
	fprintf(fp,"OUT ['LogicalToPhysicalPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG_PTR (WINAPI *pSetWindowLongPtrW) (HWND hWnd,int nIndex,LONG_PTR dwNewLong) = SetWindowLongPtrW;
LONG_PTR fake_SetWindowLongPtrW(HWND hWnd,int nIndex,LONG_PTR dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowLongPtrW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG_PTR ret = pSetWindowLongPtrW(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetWindowLongPtrW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefMDIChildProcA) (HWND hWnd,UINT uMsg,WPARAM wParam,LPARAM lParam) = DefMDIChildProcA;
LRESULT fake_DefMDIChildProcA(HWND hWnd,UINT uMsg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefMDIChildProcA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMsg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMsg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMsg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMsg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefMDIChildProcA(hWnd,uMsg,wParam,lParam);
	fprintf(fp,"OUT ['DefMDIChildProcA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShowOwnedPopups) (HWND hWnd,BOOL fShow) = ShowOwnedPopups;
BOOL fake_ShowOwnedPopups(HWND hWnd,BOOL fShow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShowOwnedPopups',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fShow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fShow, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fShow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fShow,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShowOwnedPopups(hWnd,fShow);
	fprintf(fp,"OUT ['ShowOwnedPopups',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetProcessDefaultLayout) (DWORD* pdwDefaultLayout) = GetProcessDefaultLayout;
BOOL fake_GetProcessDefaultLayout(DWORD* pdwDefaultLayout){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetProcessDefaultLayout',");
	fprintf(fp,"]\n");
	BOOL ret = pGetProcessDefaultLayout(pdwDefaultLayout);
	fprintf(fp,"OUT ['GetProcessDefaultLayout',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pdwDefaultLayout','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pdwDefaultLayout, sizeof(DWORD*),1);
 	else fprintf(fp,"{'name':'pdwDefaultLayout','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pdwDefaultLayout,sizeof(DWORD*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pHideCaret) (HWND hWnd) = HideCaret;
BOOL fake_HideCaret(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['HideCaret',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pHideCaret(hWnd);
	fprintf(fp,"OUT ['HideCaret',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEndDialog) (HWND hDlg,INT_PTR nResult) = EndDialog;
BOOL fake_EndDialog(HWND hDlg,INT_PTR nResult){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EndDialog',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nResult','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nResult, sizeof(INT_PTR),1);
 	else fprintf(fp,"{'name':'nResult','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nResult,sizeof(INT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEndDialog(hDlg,nResult);
	fprintf(fp,"OUT ['EndDialog',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnloadKeyboardLayout) (HKL hkl) = UnloadKeyboardLayout;
BOOL fake_UnloadKeyboardLayout(HKL hkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnloadKeyboardLayout',");
	if(1) fprintf(fp,"{'name':'hkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'hkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnloadKeyboardLayout(hkl);
	fprintf(fp,"OUT ['UnloadKeyboardLayout',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pSetClassLongW) (HWND hWnd,int nIndex,LONG dwNewLong) = SetClassLongW;
DWORD fake_SetClassLongW(HWND hWnd,int nIndex,LONG dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClassLongW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pSetClassLongW(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetClassLongW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pMapVirtualKeyExW) (UINT uCode,UINT uMapType,HKL dwhkl) = MapVirtualKeyExW;
UINT fake_MapVirtualKeyExW(UINT uCode,UINT uMapType,HKL dwhkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MapVirtualKeyExW',");
	if(1) fprintf(fp,"{'name':'uCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMapType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMapType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMapType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMapType,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwhkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwhkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'dwhkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwhkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pMapVirtualKeyExW(uCode,uMapType,dwhkl);
	fprintf(fp,"OUT ['MapVirtualKeyExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HHOOK (WINAPI *pSetWindowsHookExA) (int idHook,HOOKPROC lpfn,HINSTANCE hmod,DWORD dwThreadId) = SetWindowsHookExA;
HHOOK fake_SetWindowsHookExA(int idHook,HOOKPROC lpfn,HINSTANCE hmod,DWORD dwThreadId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowsHookExA',");
	if(1) fprintf(fp,"{'name':'idHook','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idHook, sizeof(int),1);
 	else fprintf(fp,"{'name':'idHook','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idHook,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpfn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpfn, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'lpfn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpfn,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hmod','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmod, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hmod','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmod,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwThreadId','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwThreadId, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwThreadId','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwThreadId,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HHOOK ret = pSetWindowsHookExA(idHook,lpfn,hmod,dwThreadId);
	fprintf(fp,"OUT ['SetWindowsHookExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HHOOK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HHOOK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pHiliteMenuItem) (HWND hWnd,HMENU hMenu,UINT uIDHiliteItem,UINT uHilite) = HiliteMenuItem;
BOOL fake_HiliteMenuItem(HWND hWnd,HMENU hMenu,UINT uIDHiliteItem,UINT uHilite){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['HiliteMenuItem',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDHiliteItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDHiliteItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uIDHiliteItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDHiliteItem,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uHilite','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uHilite, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uHilite','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uHilite,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pHiliteMenuItem(hWnd,hMenu,uIDHiliteItem,uHilite);
	fprintf(fp,"OUT ['HiliteMenuItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pCopyImage) (HANDLE h,UINT type,int cx,int cy,UINT flags) = CopyImage;
HANDLE fake_CopyImage(HANDLE h,UINT type,int cx,int cy,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CopyImage',");
	if(1) fprintf(fp,"{'name':'h','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",h, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'h','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",h,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'type','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",type, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'type','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",type,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pCopyImage(h,type,cx,cy,flags);
	fprintf(fp,"OUT ['CopyImage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDesktopsA) (HWINSTA hwinsta,DESKTOPENUMPROCA lpEnumFunc,LPARAM lParam) = EnumDesktopsA;
BOOL fake_EnumDesktopsA(HWINSTA hwinsta,DESKTOPENUMPROCA lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDesktopsA',");
	if(1) fprintf(fp,"{'name':'hwinsta','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwinsta, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'hwinsta','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwinsta,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(DESKTOPENUMPROCA),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(DESKTOPENUMPROCA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDesktopsA(hwinsta,lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumDesktopsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCheckMenuRadioItem) (HMENU hmenu,UINT first,UINT last,UINT check,UINT flags) = CheckMenuRadioItem;
BOOL fake_CheckMenuRadioItem(HMENU hmenu,UINT first,UINT last,UINT check,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CheckMenuRadioItem',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'first','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",first, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'first','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",first,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'last','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",last, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'last','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",last,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'check','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",check, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'check','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",check,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCheckMenuRadioItem(hmenu,first,last,check,flags);
	fprintf(fp,"OUT ['CheckMenuRadioItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pMsgWaitForMultipleObjectsEx) (DWORD nCount,CONST HANDLE* pHandles,DWORD dwMilliseconds,DWORD dwWakeMask,DWORD dwFlags) = MsgWaitForMultipleObjectsEx;
DWORD fake_MsgWaitForMultipleObjectsEx(DWORD nCount,CONST HANDLE* pHandles,DWORD dwMilliseconds,DWORD dwWakeMask,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MsgWaitForMultipleObjectsEx',");
	if(1) fprintf(fp,"{'name':'nCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCount, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCount,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pHandles','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pHandles, sizeof(CONST HANDLE*),nCount);
 	else fprintf(fp,"{'name':'pHandles','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pHandles,sizeof(CONST HANDLE*));
	if(pHandles){
		for(int i=0; i<nCount;i++){
			fprintf(fp,"0x%x,",pHandles[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwMilliseconds','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwMilliseconds, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwMilliseconds','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwMilliseconds,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwWakeMask','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwWakeMask, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwWakeMask','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwWakeMask,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pMsgWaitForMultipleObjectsEx(nCount,pHandles,dwMilliseconds,dwWakeMask,dwFlags);
	fprintf(fp,"OUT ['MsgWaitForMultipleObjectsEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInsertMenuItemW) (HMENU hmenu,UINT item,BOOL fByPosition,LPCMENUITEMINFOW lpmi) = InsertMenuItemW;
BOOL fake_InsertMenuItemW(HMENU hmenu,UINT item,BOOL fByPosition,LPCMENUITEMINFOW lpmi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InsertMenuItemW',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'item','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",item, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'item','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",item,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPosition, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fByPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPosition,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmi, sizeof(LPCMENUITEMINFOW),1);
 	else fprintf(fp,"{'name':'lpmi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmi,sizeof(LPCMENUITEMINFOW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInsertMenuItemW(hmenu,item,fByPosition,lpmi);
	fprintf(fp,"OUT ['InsertMenuItemW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pExcludeUpdateRgn) (HDC hDC,HWND hWnd) = ExcludeUpdateRgn;
int fake_ExcludeUpdateRgn(HDC hDC,HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ExcludeUpdateRgn',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pExcludeUpdateRgn(hDC,hWnd);
	fprintf(fp,"OUT ['ExcludeUpdateRgn',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCloseTouchInputHandle) (HTOUCHINPUT hTouchInput) = CloseTouchInputHandle;
BOOL fake_CloseTouchInputHandle(HTOUCHINPUT hTouchInput){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CloseTouchInputHandle',");
	if(1) fprintf(fp,"{'name':'hTouchInput','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hTouchInput, sizeof(HTOUCHINPUT),1);
 	else fprintf(fp,"{'name':'hTouchInput','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hTouchInput,sizeof(HTOUCHINPUT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCloseTouchInputHandle(hTouchInput);
	fprintf(fp,"OUT ['CloseTouchInputHandle',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnionRect) (LPRECT lprcDst,CONST RECT* lprcSrc1,CONST RECT* lprcSrc2) = UnionRect;
BOOL fake_UnionRect(LPRECT lprcDst,CONST RECT* lprcSrc1,CONST RECT* lprcSrc2){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnionRect',");
	if(1) fprintf(fp,"{'name':'lprcSrc1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc1, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc1,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcSrc2','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc2, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc2','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc2,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnionRect(lprcDst,lprcSrc1,lprcSrc2);
	fprintf(fp,"OUT ['UnionRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcDst, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprcDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcDst,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pLoadCursorFromFileW) (LPCWSTR lpFileName) = LoadCursorFromFileW;
HCURSOR fake_LoadCursorFromFileW(LPCWSTR lpFileName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadCursorFromFileW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpFileName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpFileName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpFileName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpFileName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpFileName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pLoadCursorFromFileW(lpFileName);
	fprintf(fp,"OUT ['LoadCursorFromFileW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pPostQuitMessage) (int nExitCode) = PostQuitMessage;
VOID fake_PostQuitMessage(int nExitCode){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PostQuitMessage',");
	if(1) fprintf(fp,"{'name':'nExitCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nExitCode, sizeof(int),1);
 	else fprintf(fp,"{'name':'nExitCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nExitCode,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pPostQuitMessage(nExitCode);
	fprintf(fp,"OUT ['PostQuitMessage',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pWindowFromPoint) (POINT Point) = WindowFromPoint;
HWND fake_WindowFromPoint(POINT Point){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WindowFromPoint',");
	if(1) fprintf(fp,"{'name':'Point','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",Point, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'Point','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Point,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pWindowFromPoint(Point);
	fprintf(fp,"OUT ['WindowFromPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCharToOemBuffW) (LPCWSTR lpszSrc,LPSTR lpszDst,DWORD cchDstLength) = CharToOemBuffW;
BOOL fake_CharToOemBuffW(LPCWSTR lpszSrc,LPSTR lpszDst,DWORD cchDstLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharToOemBuffW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszSrc',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszSrc);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszSrc);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszSrc',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszSrc);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchDstLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchDstLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchDstLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchDstLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCharToOemBuffW(lpszSrc,lpszDst,cchDstLength);
	fprintf(fp,"OUT ['CharToOemBuffW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDst, sizeof(LPSTR),cchDstLength);
 	else fprintf(fp,"{'name':'lpszDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDst,sizeof(LPSTR));
	if(lpszDst){
		for(int i=0; i<cchDstLength;i++){
			fprintf(fp,"0x%x,",lpszDst[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWINSTA (WINAPI *pCreateWindowStationA) (LPCSTR lpwinsta,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa) = CreateWindowStationA;
HWINSTA fake_CreateWindowStationA(LPCSTR lpwinsta,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateWindowStationA',");
	if(1) fprintf(fp,"{'name':'lpwinsta','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpwinsta, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpwinsta','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpwinsta,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsa','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsa, sizeof(LPSECURITY_ATTRIBUTES),1);
 	else fprintf(fp,"{'name':'lpsa','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsa,sizeof(LPSECURITY_ATTRIBUTES));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWINSTA ret = pCreateWindowStationA(lpwinsta,dwFlags,dwDesiredAccess,lpsa);
	fprintf(fp,"OUT ['CreateWindowStationA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDWP (WINAPI *pBeginDeferWindowPos) (int nNumWindows) = BeginDeferWindowPos;
HDWP fake_BeginDeferWindowPos(int nNumWindows){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BeginDeferWindowPos',");
	if(1) fprintf(fp,"{'name':'nNumWindows','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nNumWindows, sizeof(int),1);
 	else fprintf(fp,"{'name':'nNumWindows','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nNumWindows,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDWP ret = pBeginDeferWindowPos(nNumWindows);
	fprintf(fp,"OUT ['BeginDeferWindowPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDWP),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDWP));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPeekMessageA) (LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax,UINT wRemoveMsg) = PeekMessageA;
BOOL fake_PeekMessageA(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax,UINT wRemoveMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PeekMessageA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMin, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMin,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMax,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wRemoveMsg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wRemoveMsg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wRemoveMsg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wRemoveMsg,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPeekMessageA(lpMsg,hWnd,wMsgFilterMin,wMsgFilterMax,wRemoveMsg);
	fprintf(fp,"OUT ['PeekMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetNextDlgTabItem) (HWND hDlg,HWND hCtl,BOOL bPrevious) = GetNextDlgTabItem;
HWND fake_GetNextDlgTabItem(HWND hDlg,HWND hCtl,BOOL bPrevious){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetNextDlgTabItem',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hCtl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hCtl, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hCtl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hCtl,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bPrevious','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bPrevious, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bPrevious','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bPrevious,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetNextDlgTabItem(hDlg,hCtl,bPrevious);
	fprintf(fp,"OUT ['GetNextDlgTabItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pLoadStringA) (HINSTANCE hInstance,UINT uID,LPSTR lpBuffer,int cchBufferMax) = LoadStringA;
int fake_LoadStringA(HINSTANCE hInstance,UINT uID,LPSTR lpBuffer,int cchBufferMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadStringA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uID','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uID, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uID','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uID,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchBufferMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchBufferMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchBufferMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchBufferMax,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pLoadStringA(hInstance,uID,lpBuffer,cchBufferMax);
	fprintf(fp,"OUT ['LoadStringA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpBuffer','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpBuffer, sizeof(LPSTR),cchBufferMax, ret + 1);
 	else fprintf(fp,"{'name':'lpBuffer','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpBuffer,sizeof(LPSTR));
	if(lpBuffer){
		for(int i=0; i<cchBufferMax <  ret + 1 ? cchBufferMax :  ret + 1;i++){
			fprintf(fp,"0x%x,",lpBuffer[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetClassInfoW) (HINSTANCE hInstance,LPCWSTR lpClassName,LPWNDCLASSW lpWndClass) = GetClassInfoW;
BOOL fake_GetClassInfoW(HINSTANCE hInstance,LPCWSTR lpClassName,LPWNDCLASSW lpWndClass){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassInfoW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpClassName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetClassInfoW(hInstance,lpClassName,lpWndClass);
	fprintf(fp,"OUT ['GetClassInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpWndClass','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpWndClass, sizeof(LPWNDCLASSW),1);
 	else fprintf(fp,"{'name':'lpWndClass','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWndClass,sizeof(LPWNDCLASSW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsWinEventHookInstalled) (DWORD event) = IsWinEventHookInstalled;
BOOL fake_IsWinEventHookInstalled(DWORD event){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsWinEventHookInstalled',");
	if(1) fprintf(fp,"{'name':'event','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",event, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'event','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",event,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsWinEventHookInstalled(event);
	fprintf(fp,"OUT ['IsWinEventHookInstalled',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetWindowContextHelpId) (HWND arg0) = GetWindowContextHelpId;
DWORD fake_GetWindowContextHelpId(HWND arg0){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowContextHelpId',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetWindowContextHelpId(arg0);
	fprintf(fp,"OUT ['GetWindowContextHelpId',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateMDIWindowA) (LPCSTR lpClassName,LPCSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HINSTANCE hInstance,LPARAM lParam) = CreateMDIWindowA;
HWND fake_CreateMDIWindowA(LPCSTR lpClassName,LPCSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HINSTANCE hInstance,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateMDIWindowA',");
	if(1) fprintf(fp,"{'name':'lpClassName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpClassName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpClassName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClassName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpWindowName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpWindowName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpWindowName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWindowName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateMDIWindowA(lpClassName,lpWindowName,dwStyle,X,Y,nWidth,nHeight,hWndParent,hInstance,lParam);
	fprintf(fp,"OUT ['CreateMDIWindowA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefDlgProcW) (HWND hDlg,UINT Msg,WPARAM wParam,LPARAM lParam) = DefDlgProcW;
LRESULT fake_DefDlgProcW(HWND hDlg,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefDlgProcW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefDlgProcW(hDlg,Msg,wParam,lParam);
	fprintf(fp,"OUT ['DefDlgProcW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pRegisterClipboardFormatA) (LPCSTR lpszFormat) = RegisterClipboardFormatA;
UINT fake_RegisterClipboardFormatA(LPCSTR lpszFormat){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterClipboardFormatA',");
	if(1) fprintf(fp,"{'name':'lpszFormat','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszFormat, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszFormat','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszFormat,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pRegisterClipboardFormatA(lpszFormat);
	fprintf(fp,"OUT ['RegisterClipboardFormatA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HOOKPROC (WINAPI *pSetWindowsHookA) (int nFilterType,HOOKPROC pfnFilterProc) = SetWindowsHookA;
HOOKPROC fake_SetWindowsHookA(int nFilterType,HOOKPROC pfnFilterProc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowsHookA',");
	if(1) fprintf(fp,"{'name':'nFilterType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nFilterType, sizeof(int),1);
 	else fprintf(fp,"{'name':'nFilterType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nFilterType,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pfnFilterProc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",pfnFilterProc, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'pfnFilterProc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pfnFilterProc,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HOOKPROC ret = pSetWindowsHookA(nFilterType,pfnFilterProc);
	fprintf(fp,"OUT ['SetWindowsHookA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDC (WINAPI *pGetDC) (HWND hWnd) = GetDC;
HDC fake_GetDC(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDC',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDC ret = pGetDC(hWnd);
	fprintf(fp,"OUT ['GetDC',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDlgDirListComboBoxA) (HWND hDlg,LPSTR lpPathSpec,int nIDComboBox,int nIDStaticPath,UINT uFiletype) = DlgDirListComboBoxA;
int fake_DlgDirListComboBoxA(HWND hDlg,LPSTR lpPathSpec,int nIDComboBox,int nIDStaticPath,UINT uFiletype){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirListComboBoxA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpPathSpec, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPathSpec,sizeof(LPSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDComboBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDComboBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDComboBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDComboBox,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDStaticPath, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDStaticPath,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFiletype','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFiletype, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFiletype','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFiletype,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDlgDirListComboBoxA(hDlg,lpPathSpec,nIDComboBox,nIDStaticPath,uFiletype);
	fprintf(fp,"OUT ['DlgDirListComboBoxA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpPathSpec, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPathSpec,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ATOM (WINAPI *pRegisterClassExA) (CONST WNDCLASSEXA* arg0) = RegisterClassExA;
ATOM fake_RegisterClassExA(CONST WNDCLASSEXA* arg0){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterClassExA',");
	if(1) fprintf(fp,"{'name':'arg0','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(CONST WNDCLASSEXA*),1);
 	else fprintf(fp,"{'name':'arg0','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(CONST WNDCLASSEXA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ATOM ret = pRegisterClassExA(arg0);
	fprintf(fp,"OUT ['RegisterClassExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ATOM),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ATOM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetPropA) (HWND hWnd,LPCSTR lpString,HANDLE hData) = SetPropA;
BOOL fake_SetPropA(HWND hWnd,LPCSTR lpString,HANDLE hData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetPropA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpString','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hData, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hData,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetPropA(hWnd,lpString,hData);
	fprintf(fp,"OUT ['SetPropA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateDialogIndirectParamW) (HINSTANCE hInstance,LPCDLGTEMPLATEW lpTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = CreateDialogIndirectParamW;
HWND fake_CreateDialogIndirectParamW(HINSTANCE hInstance,LPCDLGTEMPLATEW lpTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDialogIndirectParamW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTemplate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpTemplate, sizeof(LPCDLGTEMPLATEW),1);
 	else fprintf(fp,"{'name':'lpTemplate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTemplate,sizeof(LPCDLGTEMPLATEW));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateDialogIndirectParamW(hInstance,lpTemplate,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['CreateDialogIndirectParamW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pToAscii) (UINT uVirtKey,UINT uScanCode,CONST BYTE* lpKeyState,LPWORD lpChar,UINT uFlags) = ToAscii;
int fake_ToAscii(UINT uVirtKey,UINT uScanCode,CONST BYTE* lpKeyState,LPWORD lpChar,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ToAscii',");
	if(1) fprintf(fp,"{'name':'uVirtKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uVirtKey, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uVirtKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uVirtKey,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uScanCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uScanCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uScanCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uScanCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpKeyState','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpKeyState, sizeof(CONST BYTE*),256);
 	else fprintf(fp,"{'name':'lpKeyState','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpKeyState,sizeof(CONST BYTE*));
	if(lpKeyState){
		for(int i=0; i<256;i++){
			fprintf(fp,"0x%x,",lpKeyState[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pToAscii(uVirtKey,uScanCode,lpKeyState,lpChar,uFlags);
	fprintf(fp,"OUT ['ToAscii',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpChar','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpChar, sizeof(LPWORD),1);
 	else fprintf(fp,"{'name':'lpChar','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpChar,sizeof(LPWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSoundSentry) () = SoundSentry;
BOOL fake_SoundSentry(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SoundSentry',");
	fprintf(fp,"]\n");
	BOOL ret = pSoundSentry();
	fprintf(fp,"OUT ['SoundSentry',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDrawTextW) (HDC hdc,LPCWSTR lpchText,int cchText,LPRECT lprc,UINT format) = DrawTextW;
int fake_DrawTextW(HDC hdc,LPCWSTR lpchText,int cchText,LPRECT lprc,UINT format){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawTextW',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpchText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpchText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpchText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),cchText);
 	}else 
	{
		fprintf(fp,"{'name':'lpchText',");
		fwprintf(fp, L"'value': %p, ", lpchText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchText','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchText, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchText','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchText,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDrawTextW(hdc,lpchText,cchText,lprc,format);
	fprintf(fp,"OUT ['DrawTextW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpchText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpchText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpchText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),cchText);
 	}else 
	{
		fprintf(fp,"{'name':'lpchText',");
		fwprintf(fp, L"'value': %p, ", lpchText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetWindowPos) (HWND hWnd,HWND hWndInsertAfter,int X,int Y,int cx,int cy,UINT uFlags) = SetWindowPos;
BOOL fake_SetWindowPos(HWND hWnd,HWND hWndInsertAfter,int X,int Y,int cx,int cy,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowPos',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndInsertAfter','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndInsertAfter, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndInsertAfter','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndInsertAfter,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetWindowPos(hWnd,hWndInsertAfter,X,Y,cx,cy,uFlags);
	fprintf(fp,"OUT ['SetWindowPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pToUnicodeEx) (UINT wVirtKey,UINT wScanCode,CONST BYTE* lpKeyState,LPWSTR pwszBuff,int cchBuff,UINT wFlags,HKL dwhkl) = ToUnicodeEx;
int fake_ToUnicodeEx(UINT wVirtKey,UINT wScanCode,CONST BYTE* lpKeyState,LPWSTR pwszBuff,int cchBuff,UINT wFlags,HKL dwhkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ToUnicodeEx',");
	if(1) fprintf(fp,"{'name':'wVirtKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wVirtKey, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wVirtKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wVirtKey,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wScanCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wScanCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wScanCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wScanCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpKeyState','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpKeyState, sizeof(CONST BYTE*),1);
 	else fprintf(fp,"{'name':'lpKeyState','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpKeyState,sizeof(CONST BYTE*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchBuff','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchBuff, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchBuff','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchBuff,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwhkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwhkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'dwhkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwhkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pToUnicodeEx(wVirtKey,wScanCode,lpKeyState,pwszBuff,cchBuff,wFlags,dwhkl);
	fprintf(fp,"OUT ['ToUnicodeEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pwszBuff',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pwszBuff);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pwszBuff);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchBuff);
 	}else 
	{
		fprintf(fp,"{'name':'pwszBuff',");
		fwprintf(fp, L"'value': %p, ", pwszBuff);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pwszBuff){
		for(int i=0; i<cchBuff;i++){
			fprintf(fp,"0x%x,",pwszBuff[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pwvsprintfW) (LPWSTR arg0,LPCWSTR arg1,va_list arglist) = wvsprintfW;
int fake_wvsprintfW(LPWSTR arg0,LPCWSTR arg1,va_list arglist){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['wvsprintfW',");
	if(1)
	{
		fprintf(fp,"{'name':'arg1',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", arg1);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", arg1);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'arg1',");
		fwprintf(fp, L"'value': '\"%s\"', ", arg1);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arglist','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arglist, sizeof(va_list),1);
 	else fprintf(fp,"{'name':'arglist','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arglist,sizeof(va_list));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pwvsprintfW(arg0,arg1,arglist);
	fprintf(fp,"OUT ['wvsprintfW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'arg0',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", arg0);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", arg0);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'arg0',");
		fwprintf(fp, L"'value': '\"%s\"', ", arg0);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pSetScrollInfo) (HWND hwnd,int nBar,LPCSCROLLINFO lpsi,BOOL redraw) = SetScrollInfo;
int fake_SetScrollInfo(HWND hwnd,int nBar,LPCSCROLLINFO lpsi,BOOL redraw){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetScrollInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBar,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsi, sizeof(LPCSCROLLINFO),1);
 	else fprintf(fp,"{'name':'lpsi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsi,sizeof(LPCSCROLLINFO));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'redraw','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",redraw, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'redraw','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",redraw,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pSetScrollInfo(hwnd,nBar,lpsi,redraw);
	fprintf(fp,"OUT ['SetScrollInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateWindowExA) (DWORD dwExStyle,LPCSTR lpClassName,LPCSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HMENU hMenu,HINSTANCE hInstance,LPVOID lpParam) = CreateWindowExA;
HWND fake_CreateWindowExA(DWORD dwExStyle,LPCSTR lpClassName,LPCSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HMENU hMenu,HINSTANCE hInstance,LPVOID lpParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateWindowExA',");
	if(1) fprintf(fp,"{'name':'dwExStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwExStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwExStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwExStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpClassName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpClassName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpClassName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClassName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpWindowName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpWindowName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpWindowName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWindowName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpParam, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'lpParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpParam,sizeof(LPVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateWindowExA(dwExStyle,lpClassName,lpWindowName,dwStyle,X,Y,nWidth,nHeight,hWndParent,hMenu,hInstance,lpParam);
	fprintf(fp,"OUT ['CreateWindowExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetClipboardFormatNameW) (UINT format,LPWSTR lpszFormatName,int cchMaxCount) = GetClipboardFormatNameW;
int fake_GetClipboardFormatNameW(UINT format,LPWSTR lpszFormatName,int cchMaxCount){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipboardFormatNameW',");
	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMaxCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMaxCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMaxCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMaxCount,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetClipboardFormatNameW(format,lpszFormatName,cchMaxCount);
	fprintf(fp,"OUT ['GetClipboardFormatNameW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszFormatName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpszFormatName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpszFormatName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchMaxCount);
 	}else 
	{
		fprintf(fp,"{'name':'lpszFormatName',");
		fwprintf(fp, L"'value': %p, ", lpszFormatName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpszFormatName){
		for(int i=0; i<cchMaxCount;i++){
			fprintf(fp,"0x%x,",lpszFormatName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetClipboardSequenceNumber) () = GetClipboardSequenceNumber;
DWORD fake_GetClipboardSequenceNumber(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipboardSequenceNumber',");
	fprintf(fp,"]\n");
	DWORD ret = pGetClipboardSequenceNumber();
	fprintf(fp,"OUT ['GetClipboardSequenceNumber',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDrawTextA) (HDC hdc,LPCSTR lpchText,int cchText,LPRECT lprc,UINT format) = DrawTextA;
int fake_DrawTextA(HDC hdc,LPCSTR lpchText,int cchText,LPRECT lprc,UINT format){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawTextA',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpchText','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpchText, sizeof(LPCSTR),cchText);
 	else fprintf(fp,"{'name':'lpchText','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpchText,sizeof(LPCSTR));
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchText','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchText, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchText','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchText,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDrawTextA(hdc,lpchText,cchText,lprc,format);
	fprintf(fp,"OUT ['DrawTextA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpchText','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpchText, sizeof(LPCSTR),cchText);
 	else fprintf(fp,"{'name':'lpchText','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpchText,sizeof(LPCSTR));
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShowCaret) (HWND hWnd) = ShowCaret;
BOOL fake_ShowCaret(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShowCaret',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShowCaret(hWnd);
	fprintf(fp,"OUT ['ShowCaret',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pGetWindowLongA) (HWND hWnd,int nIndex) = GetWindowLongA;
LONG fake_GetWindowLongA(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowLongA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pGetWindowLongA(hWnd,nIndex);
	fprintf(fp,"OUT ['GetWindowLongA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetSysColors) (int cElements,CONST INT*  lpaElements,CONST COLORREF*  lpaRgbValues) = SetSysColors;
BOOL fake_SetSysColors(int cElements,CONST INT*  lpaElements,CONST COLORREF*  lpaRgbValues){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetSysColors',");
	if(1) fprintf(fp,"{'name':'cElements','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cElements, sizeof(int),1);
 	else fprintf(fp,"{'name':'cElements','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cElements,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpaElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpaElements, sizeof(CONST INT*),cElements);
 	else fprintf(fp,"{'name':' lpaElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpaElements,sizeof(CONST INT*));
	if( lpaElements){
		for(int i=0; i<cElements;i++){
			fprintf(fp,"0x%x,", lpaElements[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpaRgbValues','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpaRgbValues, sizeof(CONST COLORREF*),cElements);
 	else fprintf(fp,"{'name':' lpaRgbValues','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpaRgbValues,sizeof(CONST COLORREF*));
	if( lpaRgbValues){
		for(int i=0; i<cElements;i++){
			fprintf(fp,"0x%x,", lpaRgbValues[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetSysColors(cElements, lpaElements, lpaRgbValues);
	fprintf(fp,"OUT ['SetSysColors',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetAncestor) (HWND hwnd,UINT gaFlags) = GetAncestor;
HWND fake_GetAncestor(HWND hwnd,UINT gaFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetAncestor',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'gaFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",gaFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'gaFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",gaFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetAncestor(hwnd,gaFlags);
	fprintf(fp,"OUT ['GetAncestor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pLoadIconA) (HINSTANCE hInstance,LPCSTR lpIconName) = LoadIconA;
HICON fake_LoadIconA(HINSTANCE hInstance,LPCSTR lpIconName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadIconA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpIconName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpIconName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpIconName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpIconName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pLoadIconA(hInstance,lpIconName);
	fprintf(fp,"OUT ['LoadIconA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pwsprintfW) (LPWSTR arg0,LPCWSTR arg1) = wsprintfW;
int fake_wsprintfW(LPWSTR arg0,LPCWSTR arg1){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['wsprintfW',");
	if(1)
	{
		fprintf(fp,"{'name':'arg1',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", arg1);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", arg1);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'arg1',");
		fwprintf(fp, L"'value': '\"%s\"', ", arg1);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pwsprintfW(arg0,arg1);
	fprintf(fp,"OUT ['wsprintfW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'arg0',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", arg0);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", arg0);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'arg0',");
		fwprintf(fp, L"'value': '\"%s\"', ", arg0);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnregisterHotKey) (HWND hWnd,int id) = UnregisterHotKey;
BOOL fake_UnregisterHotKey(HWND hWnd,int id){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnregisterHotKey',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'id','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",id, sizeof(int),1);
 	else fprintf(fp,"{'name':'id','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",id,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnregisterHotKey(hWnd,id);
	fprintf(fp,"OUT ['UnregisterHotKey',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pGetSubMenu) (HMENU hMenu,int nPos) = GetSubMenu;
HMENU fake_GetSubMenu(HMENU hMenu,int nPos){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetSubMenu',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nPos, sizeof(int),1);
 	else fprintf(fp,"{'name':'nPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nPos,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pGetSubMenu(hMenu,nPos);
	fprintf(fp,"OUT ['GetSubMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCloseWindow) (HWND hWnd) = CloseWindow;
BOOL fake_CloseWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CloseWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCloseWindow(hWnd);
	fprintf(fp,"OUT ['CloseWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSendMessageCallbackA) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,SENDASYNCPROC lpResultCallBack,ULONG_PTR dwData) = SendMessageCallbackA;
BOOL fake_SendMessageCallbackA(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,SENDASYNCPROC lpResultCallBack,ULONG_PTR dwData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendMessageCallbackA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpResultCallBack','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpResultCallBack, sizeof(SENDASYNCPROC),1);
 	else fprintf(fp,"{'name':'lpResultCallBack','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpResultCallBack,sizeof(SENDASYNCPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwData, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'dwData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwData,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSendMessageCallbackA(hWnd,Msg,wParam,lParam,lpResultCallBack,dwData);
	fprintf(fp,"OUT ['SendMessageCallbackA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRemoveMenu) (HMENU hMenu,UINT uPosition,UINT uFlags) = RemoveMenu;
BOOL fake_RemoveMenu(HMENU hMenu,UINT uPosition,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RemoveMenu',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRemoveMenu(hMenu,uPosition,uFlags);
	fprintf(fp,"OUT ['RemoveMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsDialogMessageA) (HWND hDlg,LPMSG lpMsg) = IsDialogMessageA;
BOOL fake_IsDialogMessageA(HWND hDlg,LPMSG lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsDialogMessageA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsDialogMessageA(hDlg,lpMsg);
	fprintf(fp,"OUT ['IsDialogMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pLoadMenuA) (HINSTANCE hInstance,LPCSTR lpMenuName) = LoadMenuA;
HMENU fake_LoadMenuA(HINSTANCE hInstance,LPCSTR lpMenuName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadMenuA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMenuName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpMenuName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpMenuName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMenuName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pLoadMenuA(hInstance,lpMenuName);
	fprintf(fp,"OUT ['LoadMenuA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetRawInputBuffer) (PRAWINPUT pData,PUINT pcbSize,UINT cbSizeHeader) = GetRawInputBuffer;
UINT fake_GetRawInputBuffer(PRAWINPUT pData,PUINT pcbSize,UINT cbSizeHeader){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetRawInputBuffer',");
	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSizeHeader','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSizeHeader, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSizeHeader','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSizeHeader,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetRawInputBuffer(pData,pcbSize,cbSizeHeader);
	fprintf(fp,"OUT ['GetRawInputBuffer',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pData','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pData, sizeof(PRAWINPUT),1);
 	else fprintf(fp,"{'name':'pData','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pData,sizeof(PRAWINPUT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSystemParametersInfoW) (UINT uiAction,UINT uiParam,PVOID pvParam,UINT fWinIni) = SystemParametersInfoW;
BOOL fake_SystemParametersInfoW(UINT uiAction,UINT uiParam,PVOID pvParam,UINT fWinIni){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SystemParametersInfoW',");
	if(1) fprintf(fp,"{'name':'uiAction','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiAction, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiAction','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiAction,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiParam, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiParam,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvParam, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvParam,sizeof(PVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fWinIni','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fWinIni, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fWinIni','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fWinIni,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSystemParametersInfoW(uiAction,uiParam,pvParam,fWinIni);
	fprintf(fp,"OUT ['SystemParametersInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvParam, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvParam,sizeof(PVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pArrangeIconicWindows) (HWND hWnd) = ArrangeIconicWindows;
UINT fake_ArrangeIconicWindows(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ArrangeIconicWindows',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pArrangeIconicWindows(hWnd);
	fprintf(fp,"OUT ['ArrangeIconicWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetMenuState) (HMENU hMenu,UINT uId,UINT uFlags) = GetMenuState;
UINT fake_GetMenuState(HMENU hMenu,UINT uId,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuState',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uId','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uId, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uId','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uId,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetMenuState(hMenu,uId,uFlags);
	fprintf(fp,"OUT ['GetMenuState',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetClipCursor) (LPRECT lpRect) = GetClipCursor;
BOOL fake_GetClipCursor(LPRECT lpRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipCursor',");
	fprintf(fp,"]\n");
	BOOL ret = pGetClipCursor(lpRect);
	fprintf(fp,"OUT ['GetClipCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetKeyNameTextA) (LONG lParam,LPSTR lpString,int cchSize) = GetKeyNameTextA;
int fake_GetKeyNameTextA(LONG lParam,LPSTR lpString,int cchSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyNameTextA',");
	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchSize, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchSize,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetKeyNameTextA(lParam,lpString,cchSize);
	fprintf(fp,"OUT ['GetKeyNameTextA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPSTR),cchSize);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPSTR));
	if(lpString){
		for(int i=0; i<cchSize;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCallMsgFilterW) (LPMSG lpMsg,int nCode) = CallMsgFilterW;
BOOL fake_CallMsgFilterW(LPMSG lpMsg,int nCode){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CallMsgFilterW',");
	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCode, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCode,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCallMsgFilterW(lpMsg,nCode);
	fprintf(fp,"OUT ['CallMsgFilterW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCloseGestureInfoHandle) (HGESTUREINFO hGestureInfo) = CloseGestureInfoHandle;
BOOL fake_CloseGestureInfoHandle(HGESTUREINFO hGestureInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CloseGestureInfoHandle',");
	if(1) fprintf(fp,"{'name':'hGestureInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hGestureInfo, sizeof(HGESTUREINFO),1);
 	else fprintf(fp,"{'name':'hGestureInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hGestureInfo,sizeof(HGESTUREINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCloseGestureInfoHandle(hGestureInfo);
	fprintf(fp,"OUT ['CloseGestureInfoHandle',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pScrollDC) (HDC hDC,int dx,int dy,CONST RECT* lprcScroll,CONST RECT* lprcClip,HRGN hrgnUpdate,LPRECT lprcUpdate) = ScrollDC;
BOOL fake_ScrollDC(HDC hDC,int dx,int dy,CONST RECT* lprcScroll,CONST RECT* lprcClip,HRGN hrgnUpdate,LPRECT lprcUpdate){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ScrollDC',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dx, sizeof(int),1);
 	else fprintf(fp,"{'name':'dx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dy, sizeof(int),1);
 	else fprintf(fp,"{'name':'dy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcScroll','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcScroll, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcScroll','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcScroll,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcClip','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcClip, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcClip','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcClip,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hrgnUpdate','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hrgnUpdate, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hrgnUpdate','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hrgnUpdate,sizeof(HRGN));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pScrollDC(hDC,dx,dy,lprcScroll,lprcClip,hrgnUpdate,lprcUpdate);
	fprintf(fp,"OUT ['ScrollDC',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcUpdate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcUpdate, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprcUpdate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcUpdate,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pKillTimer) (HWND hWnd,UINT_PTR uIDEvent) = KillTimer;
BOOL fake_KillTimer(HWND hWnd,UINT_PTR uIDEvent){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['KillTimer',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDEvent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDEvent, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDEvent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDEvent,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pKillTimer(hWnd,uIDEvent);
	fprintf(fp,"OUT ['KillTimer',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pCreateDesktopExA) (LPCSTR lpszDesktop,LPCSTR lpszDevice,DEVMODEA*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa,ULONG ulHeapSize,PVOID pvoid) = CreateDesktopExA;
HDESK fake_CreateDesktopExA(LPCSTR lpszDesktop,LPCSTR lpszDevice,DEVMODEA*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa,ULONG ulHeapSize,PVOID pvoid){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDesktopExA',");
	if(1) fprintf(fp,"{'name':'lpszDesktop','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDesktop, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDesktop','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDesktop,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszDevice','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDevice, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDevice','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDevice,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pDevmode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pDevmode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' pDevmode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pDevmode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsa','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsa, sizeof(LPSECURITY_ATTRIBUTES),1);
 	else fprintf(fp,"{'name':'lpsa','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsa,sizeof(LPSECURITY_ATTRIBUTES));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'ulHeapSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ulHeapSize, sizeof(ULONG),1);
 	else fprintf(fp,"{'name':'ulHeapSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ulHeapSize,sizeof(ULONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvoid','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvoid, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvoid','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvoid,sizeof(PVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pCreateDesktopExA(lpszDesktop,lpszDevice, pDevmode,dwFlags,dwDesiredAccess,lpsa,ulHeapSize,pvoid);
	fprintf(fp,"OUT ['CreateDesktopExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawFrameControl) (HDC arg0,LPRECT arg1,UINT arg2,UINT arg3) = DrawFrameControl;
BOOL fake_DrawFrameControl(HDC arg0,LPRECT arg1,UINT arg2,UINT arg3){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawFrameControl',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'arg1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg2','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg2, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'arg2','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg2,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg3','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg3, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'arg3','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg3,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawFrameControl(arg0,arg1,arg2,arg3);
	fprintf(fp,"OUT ['DrawFrameControl',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'arg1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGrayStringA) (HDC hDC,HBRUSH hBrush,GRAYSTRINGPROC lpOutputFunc,LPARAM lpData,int nCount,int X,int Y,int nWidth,int nHeight) = GrayStringA;
BOOL fake_GrayStringA(HDC hDC,HBRUSH hBrush,GRAYSTRINGPROC lpOutputFunc,LPARAM lpData,int nCount,int X,int Y,int nWidth,int nHeight){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GrayStringA',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hBrush','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hBrush, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'hBrush','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hBrush,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpOutputFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpOutputFunc, sizeof(GRAYSTRINGPROC),1);
 	else fprintf(fp,"{'name':'lpOutputFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpOutputFunc,sizeof(GRAYSTRINGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpData, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lpData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpData,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGrayStringA(hDC,hBrush,lpOutputFunc,lpData,nCount,X,Y,nWidth,nHeight);
	fprintf(fp,"OUT ['GrayStringA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsWindowEnabled) (HWND hWnd) = IsWindowEnabled;
BOOL fake_IsWindowEnabled(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsWindowEnabled',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsWindowEnabled(hWnd);
	fprintf(fp,"OUT ['IsWindowEnabled',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetScrollBarInfo) (HWND hwnd,LONG idObject,PSCROLLBARINFO psbi) = GetScrollBarInfo;
BOOL fake_GetScrollBarInfo(HWND hwnd,LONG idObject,PSCROLLBARINFO psbi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetScrollBarInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idObject','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idObject, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'idObject','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idObject,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'psbi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",psbi, sizeof(PSCROLLBARINFO),1);
 	else fprintf(fp,"{'name':'psbi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",psbi,sizeof(PSCROLLBARINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetScrollBarInfo(hwnd,idObject,psbi);
	fprintf(fp,"OUT ['GetScrollBarInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'psbi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",psbi, sizeof(PSCROLLBARINFO),1);
 	else fprintf(fp,"{'name':'psbi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",psbi,sizeof(PSCROLLBARINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetGestureConfig) (HWND hwnd,DWORD dwReserved,DWORD dwFlags,PUINT pcIDs,PGESTURECONFIG pGestureConfig,UINT cbSize) = GetGestureConfig;
BOOL fake_GetGestureConfig(HWND hwnd,DWORD dwReserved,DWORD dwFlags,PUINT pcIDs,PGESTURECONFIG pGestureConfig,UINT cbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetGestureConfig',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwReserved','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwReserved, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwReserved','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwReserved,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcIDs','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcIDs, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcIDs','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcIDs,sizeof(PUINT));
	fprintf(fp,"]},");
 	if(pcIDs && 1) fprintf(fp,"{'name':'pGestureConfig','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pGestureConfig, sizeof(PGESTURECONFIG),*pcIDs);
 	else fprintf(fp,"{'name':'pGestureConfig','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pGestureConfig,sizeof(PGESTURECONFIG));
	if(pcIDs && pGestureConfig){
		for(int i=0; i<*pcIDs;i++){
			fprintf(fp,"0x%x,",pGestureConfig[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetGestureConfig(hwnd,dwReserved,dwFlags,pcIDs,pGestureConfig,cbSize);
	fprintf(fp,"OUT ['GetGestureConfig',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(pcIDs && 1) fprintf(fp,"{'name':'pGestureConfig','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pGestureConfig, sizeof(PGESTURECONFIG),*pcIDs);
 	else fprintf(fp,"{'name':'pGestureConfig','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pGestureConfig,sizeof(PGESTURECONFIG));
	if(pcIDs && pGestureConfig){
		for(int i=0; i<*pcIDs;i++){
			fprintf(fp,"0x%x,",pGestureConfig[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pScrollWindowEx) (HWND hWnd,int dx,int dy,CONST RECT* prcScroll,CONST RECT* prcClip,HRGN hrgnUpdate,LPRECT prcUpdate,UINT flags) = ScrollWindowEx;
int fake_ScrollWindowEx(HWND hWnd,int dx,int dy,CONST RECT* prcScroll,CONST RECT* prcClip,HRGN hrgnUpdate,LPRECT prcUpdate,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ScrollWindowEx',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dx, sizeof(int),1);
 	else fprintf(fp,"{'name':'dx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dy, sizeof(int),1);
 	else fprintf(fp,"{'name':'dy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'prcScroll','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",prcScroll, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'prcScroll','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",prcScroll,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'prcClip','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",prcClip, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'prcClip','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",prcClip,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hrgnUpdate','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hrgnUpdate, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hrgnUpdate','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hrgnUpdate,sizeof(HRGN));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pScrollWindowEx(hWnd,dx,dy,prcScroll,prcClip,hrgnUpdate,prcUpdate,flags);
	fprintf(fp,"OUT ['ScrollWindowEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'prcUpdate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",prcUpdate, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'prcUpdate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",prcUpdate,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDestroyWindow) (HWND hWnd) = DestroyWindow;
BOOL fake_DestroyWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DestroyWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDestroyWindow(hWnd);
	fprintf(fp,"OUT ['DestroyWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pWaitMessage) () = WaitMessage;
BOOL fake_WaitMessage(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WaitMessage',");
	fprintf(fp,"]\n");
	BOOL ret = pWaitMessage();
	fprintf(fp,"OUT ['WaitMessage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pIsDlgButtonChecked) (HWND hDlg,int nIDButton) = IsDlgButtonChecked;
UINT fake_IsDlgButtonChecked(HWND hDlg,int nIDButton){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsDlgButtonChecked',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDButton','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDButton, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDButton','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDButton,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pIsDlgButtonChecked(hDlg,nIDButton);
	fprintf(fp,"OUT ['IsDlgButtonChecked',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEndTask) (HWND hWnd,BOOL fShutDown,BOOL fForce) = EndTask;
BOOL fake_EndTask(HWND hWnd,BOOL fShutDown,BOOL fForce){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EndTask',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fShutDown','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fShutDown, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fShutDown','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fShutDown,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fForce','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fForce, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fForce','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fForce,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEndTask(hWnd,fShutDown,fForce);
	fprintf(fp,"OUT ['EndTask',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

SHORT (WINAPI *pGetKeyState) (int nVirtKey) = GetKeyState;
SHORT fake_GetKeyState(int nVirtKey){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyState',");
	if(1) fprintf(fp,"{'name':'nVirtKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nVirtKey, sizeof(int),1);
 	else fprintf(fp,"{'name':'nVirtKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nVirtKey,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	SHORT ret = pGetKeyState(nVirtKey);
	fprintf(fp,"OUT ['GetKeyState',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(SHORT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(SHORT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pLookupIconIdFromDirectoryEx) (PBYTE presbits,BOOL fIcon,int cxDesired,int cyDesired,UINT Flags) = LookupIconIdFromDirectoryEx;
int fake_LookupIconIdFromDirectoryEx(PBYTE presbits,BOOL fIcon,int cxDesired,int cyDesired,UINT Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LookupIconIdFromDirectoryEx',");
	if(1) fprintf(fp,"{'name':'presbits','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",presbits, sizeof(PBYTE),1);
 	else fprintf(fp,"{'name':'presbits','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",presbits,sizeof(PBYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fIcon, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fIcon,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cxDesired','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cxDesired, sizeof(int),1);
 	else fprintf(fp,"{'name':'cxDesired','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cxDesired,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cyDesired','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cyDesired, sizeof(int),1);
 	else fprintf(fp,"{'name':'cyDesired','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cyDesired,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pLookupIconIdFromDirectoryEx(presbits,fIcon,cxDesired,cyDesired,Flags);
	fprintf(fp,"OUT ['LookupIconIdFromDirectoryEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pLockWorkStation) () = LockWorkStation;
BOOL fake_LockWorkStation(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LockWorkStation',");
	fprintf(fp,"]\n");
	BOOL ret = pLockWorkStation();
	fprintf(fp,"OUT ['LockWorkStation',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnhookWinEvent) (HWINEVENTHOOK hWinEventHook) = UnhookWinEvent;
BOOL fake_UnhookWinEvent(HWINEVENTHOOK hWinEventHook){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnhookWinEvent',");
	if(1) fprintf(fp,"{'name':'hWinEventHook','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWinEventHook, sizeof(HWINEVENTHOOK),1);
 	else fprintf(fp,"{'name':'hWinEventHook','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWinEventHook,sizeof(HWINEVENTHOOK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnhookWinEvent(hWinEventHook);
	fprintf(fp,"OUT ['UnhookWinEvent',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsClipboardFormatAvailable) (UINT format) = IsClipboardFormatAvailable;
BOOL fake_IsClipboardFormatAvailable(UINT format){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsClipboardFormatAvailable',");
	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsClipboardFormatAvailable(format);
	fprintf(fp,"OUT ['IsClipboardFormatAvailable',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetCaretPos) (LPPOINT lpPoint) = GetCaretPos;
BOOL fake_GetCaretPos(LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetCaretPos',");
	fprintf(fp,"]\n");
	BOOL ret = pGetCaretPos(lpPoint);
	fprintf(fp,"OUT ['GetCaretPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pPrivateExtractIconsW) (LPCWSTR szFileName,int nIconIndex,int cxIcon,int cyIcon,HICON* phicon,UINT* piconid,UINT nIcons,UINT flags) = PrivateExtractIconsW;
UINT fake_PrivateExtractIconsW(LPCWSTR szFileName,int nIconIndex,int cxIcon,int cyIcon,HICON* phicon,UINT* piconid,UINT nIcons,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PrivateExtractIconsW',");
	if(1)
	{
		fprintf(fp,"{'name':'szFileName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", szFileName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", szFileName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'szFileName',");
		fwprintf(fp, L"'value': '\"%s\"', ", szFileName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIconIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIconIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIconIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIconIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cxIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cxIcon, sizeof(int),1);
 	else fprintf(fp,"{'name':'cxIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cxIcon,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cyIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cyIcon, sizeof(int),1);
 	else fprintf(fp,"{'name':'cyIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cyIcon,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIcons','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIcons, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'nIcons','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIcons,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pPrivateExtractIconsW(szFileName,nIconIndex,cxIcon,cyIcon,phicon,piconid,nIcons,flags);
	fprintf(fp,"OUT ['PrivateExtractIconsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'phicon','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",phicon, sizeof(HICON*),nIcons, ret);
 	else fprintf(fp,"{'name':'phicon','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",phicon,sizeof(HICON*));
	if(phicon){
		for(int i=0; i<nIcons <  ret ? nIcons :  ret;i++){
			fprintf(fp,"0x%x,",phicon[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconid','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconid, sizeof(UINT*),nIcons, ret);
 	else fprintf(fp,"{'name':'piconid','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconid,sizeof(UINT*));
	if(piconid){
		for(int i=0; i<nIcons <  ret ? nIcons :  ret;i++){
			fprintf(fp,"0x%x,",piconid[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDragDetect) (HWND hwnd,POINT pt) = DragDetect;
BOOL fake_DragDetect(HWND hwnd,POINT pt){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DragDetect',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pt','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",pt, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'pt','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pt,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDragDetect(hwnd,pt);
	fprintf(fp,"OUT ['DragDetect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetDlgCtrlID) (HWND hWnd) = GetDlgCtrlID;
int fake_GetDlgCtrlID(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDlgCtrlID',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetDlgCtrlID(hWnd);
	fprintf(fp,"OUT ['GetDlgCtrlID',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetWindowTextLengthA) (HWND hWnd) = GetWindowTextLengthA;
int fake_GetWindowTextLengthA(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowTextLengthA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetWindowTextLengthA(hWnd);
	fprintf(fp,"OUT ['GetWindowTextLengthA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetQueueStatus) (UINT flags) = GetQueueStatus;
DWORD fake_GetQueueStatus(UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetQueueStatus',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetQueueStatus(flags);
	fprintf(fp,"OUT ['GetQueueStatus',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetIconInfoExW) (HICON hicon,PICONINFOEXW piconinfo) = GetIconInfoExW;
BOOL fake_GetIconInfoExW(HICON hicon,PICONINFOEXW piconinfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetIconInfoExW',");
	if(1) fprintf(fp,"{'name':'hicon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hicon, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'hicon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hicon,sizeof(HICON));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconinfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconinfo, sizeof(PICONINFOEXW),1);
 	else fprintf(fp,"{'name':'piconinfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconinfo,sizeof(PICONINFOEXW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetIconInfoExW(hicon,piconinfo);
	fprintf(fp,"OUT ['GetIconInfoExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconinfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconinfo, sizeof(PICONINFOEXW),1);
 	else fprintf(fp,"{'name':'piconinfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconinfo,sizeof(PICONINFOEXW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRemoveClipboardFormatListener) (HWND hwnd) = RemoveClipboardFormatListener;
BOOL fake_RemoveClipboardFormatListener(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RemoveClipboardFormatListener',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRemoveClipboardFormatListener(hwnd);
	fprintf(fp,"OUT ['RemoveClipboardFormatListener',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HBRUSH (WINAPI *pGetSysColorBrush) (int nIndex) = GetSysColorBrush;
HBRUSH fake_GetSysColorBrush(int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetSysColorBrush',");
	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HBRUSH ret = pGetSysColorBrush(nIndex);
	fprintf(fp,"OUT ['GetSysColorBrush',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pSendMessageTimeoutA) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,UINT fuFlags,UINT uTimeout,PDWORD_PTR lpdwResult) = SendMessageTimeoutA;
LRESULT fake_SendMessageTimeoutA(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,UINT fuFlags,UINT uTimeout,PDWORD_PTR lpdwResult){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendMessageTimeoutA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fuFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fuFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fuFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fuFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uTimeout','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uTimeout, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uTimeout','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uTimeout,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pSendMessageTimeoutA(hWnd,Msg,wParam,lParam,fuFlags,uTimeout,lpdwResult);
	fprintf(fp,"OUT ['SendMessageTimeoutA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpdwResult','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpdwResult, sizeof(PDWORD_PTR),1);
 	else fprintf(fp,"{'name':'lpdwResult','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpdwResult,sizeof(PDWORD_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetKeyboardState) (LPBYTE lpKeyState) = SetKeyboardState;
BOOL fake_SetKeyboardState(LPBYTE lpKeyState){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetKeyboardState',");
	if(1) fprintf(fp,"{'name':'lpKeyState','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpKeyState, sizeof(LPBYTE),256);
 	else fprintf(fp,"{'name':'lpKeyState','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpKeyState,sizeof(LPBYTE));
	if(lpKeyState){
		for(int i=0; i<256;i++){
			fprintf(fp,"0x%x,",lpKeyState[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetKeyboardState(lpKeyState);
	fprintf(fp,"OUT ['SetKeyboardState',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetUserObjectSecurity) (HANDLE hObj,PSECURITY_INFORMATION pSIRequested,PSECURITY_DESCRIPTOR pSID) = SetUserObjectSecurity;
BOOL fake_SetUserObjectSecurity(HANDLE hObj,PSECURITY_INFORMATION pSIRequested,PSECURITY_DESCRIPTOR pSID){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetUserObjectSecurity',");
	if(1) fprintf(fp,"{'name':'hObj','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hObj, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hObj','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hObj,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pSIRequested','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pSIRequested, sizeof(PSECURITY_INFORMATION),1);
 	else fprintf(fp,"{'name':'pSIRequested','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSIRequested,sizeof(PSECURITY_INFORMATION));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pSID','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pSID, sizeof(PSECURITY_DESCRIPTOR),1);
 	else fprintf(fp,"{'name':'pSID','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSID,sizeof(PSECURITY_DESCRIPTOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetUserObjectSecurity(hObj,pSIRequested,pSID);
	fprintf(fp,"OUT ['SetUserObjectSecurity',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOemToCharBuffW) (LPCSTR lpszSrc,LPWSTR lpszDst,DWORD cchDstLength) = OemToCharBuffW;
BOOL fake_OemToCharBuffW(LPCSTR lpszSrc,LPWSTR lpszDst,DWORD cchDstLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OemToCharBuffW',");
	if(1) fprintf(fp,"{'name':'lpszSrc','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszSrc, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszSrc','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszSrc,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchDstLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchDstLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchDstLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchDstLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOemToCharBuffW(lpszSrc,lpszDst,cchDstLength);
	fprintf(fp,"OUT ['OemToCharBuffW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszDst',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpszDst);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpszDst);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchDstLength);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDst',");
		fwprintf(fp, L"'value': %p, ", lpszDst);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpszDst){
		for(int i=0; i<cchDstLength;i++){
			fprintf(fp,"0x%x,",lpszDst[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pMsgWaitForMultipleObjects) (DWORD nCount,CONST HANDLE* pHandles,BOOL fWaitAll,DWORD dwMilliseconds,DWORD dwWakeMask) = MsgWaitForMultipleObjects;
DWORD fake_MsgWaitForMultipleObjects(DWORD nCount,CONST HANDLE* pHandles,BOOL fWaitAll,DWORD dwMilliseconds,DWORD dwWakeMask){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MsgWaitForMultipleObjects',");
	if(1) fprintf(fp,"{'name':'nCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCount, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCount,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pHandles','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pHandles, sizeof(CONST HANDLE*),nCount);
 	else fprintf(fp,"{'name':'pHandles','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pHandles,sizeof(CONST HANDLE*));
	if(pHandles){
		for(int i=0; i<nCount;i++){
			fprintf(fp,"0x%x,",pHandles[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fWaitAll','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fWaitAll, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fWaitAll','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fWaitAll,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwMilliseconds','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwMilliseconds, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwMilliseconds','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwMilliseconds,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwWakeMask','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwWakeMask, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwWakeMask','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwWakeMask,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pMsgWaitForMultipleObjects(nCount,pHandles,fWaitAll,dwMilliseconds,dwWakeMask);
	fprintf(fp,"OUT ['MsgWaitForMultipleObjects',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pWinHelpA) (HWND hWndMain,LPCSTR lpszHelp,UINT uCommand,ULONG_PTR dwData) = WinHelpA;
BOOL fake_WinHelpA(HWND hWndMain,LPCSTR lpszHelp,UINT uCommand,ULONG_PTR dwData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WinHelpA',");
	if(1) fprintf(fp,"{'name':'hWndMain','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndMain, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndMain','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndMain,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszHelp','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszHelp, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszHelp','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszHelp,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uCommand','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCommand, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCommand','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCommand,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwData, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'dwData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwData,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pWinHelpA(hWndMain,lpszHelp,uCommand,dwData);
	fprintf(fp,"OUT ['WinHelpA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pCreateMenu) () = CreateMenu;
HMENU fake_CreateMenu(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateMenu',");
	fprintf(fp,"]\n");
	HMENU ret = pCreateMenu();
	fprintf(fp,"OUT ['CreateMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawFocusRect) (HDC hDC,CONST RECT*  lprc) = DrawFocusRect;
BOOL fake_DrawFocusRect(HDC hDC,CONST RECT*  lprc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawFocusRect',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lprc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':' lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lprc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawFocusRect(hDC, lprc);
	fprintf(fp,"OUT ['DrawFocusRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDispatchMessageW) (CONST MSG* lpMsg) = DispatchMessageW;
LRESULT fake_DispatchMessageW(CONST MSG* lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DispatchMessageW',");
	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(CONST MSG*),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(CONST MSG*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDispatchMessageW(lpMsg);
	fprintf(fp,"OUT ['DispatchMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pChangeMenuA) (HMENU hMenu,UINT cmd,LPCSTR lpszNewItem,UINT cmdInsert,UINT flags) = ChangeMenuA;
BOOL fake_ChangeMenuA(HMENU hMenu,UINT cmd,LPCSTR lpszNewItem,UINT cmdInsert,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeMenuA',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cmd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cmd, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cmd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cmd,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszNewItem','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszNewItem, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszNewItem','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszNewItem,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cmdInsert','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cmdInsert, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cmdInsert','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cmdInsert,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pChangeMenuA(hMenu,cmd,lpszNewItem,cmdInsert,flags);
	fprintf(fp,"OUT ['ChangeMenuA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateMDIWindowW) (LPCWSTR lpClassName,LPCWSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HINSTANCE hInstance,LPARAM lParam) = CreateMDIWindowW;
HWND fake_CreateMDIWindowW(LPCWSTR lpClassName,LPCWSTR lpWindowName,DWORD dwStyle,int X,int Y,int nWidth,int nHeight,HWND hWndParent,HINSTANCE hInstance,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateMDIWindowW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpClassName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpWindowName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpWindowName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpWindowName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpWindowName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpWindowName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateMDIWindowW(lpClassName,lpWindowName,dwStyle,X,Y,nWidth,nHeight,hWndParent,hInstance,lParam);
	fprintf(fp,"OUT ['CreateMDIWindowW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplayDevicesW) (LPCWSTR lpDevice,DWORD iDevNum,PDISPLAY_DEVICEW lpDisplayDevice,DWORD dwFlags) = EnumDisplayDevicesW;
BOOL fake_EnumDisplayDevicesW(LPCWSTR lpDevice,DWORD iDevNum,PDISPLAY_DEVICEW lpDisplayDevice,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplayDevicesW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpDevice',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpDevice);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpDevice);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpDevice',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpDevice);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iDevNum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iDevNum, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'iDevNum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iDevNum,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDisplayDevice','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDisplayDevice, sizeof(PDISPLAY_DEVICEW),1);
 	else fprintf(fp,"{'name':'lpDisplayDevice','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDisplayDevice,sizeof(PDISPLAY_DEVICEW));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplayDevicesW(lpDevice,iDevNum,lpDisplayDevice,dwFlags);
	fprintf(fp,"OUT ['EnumDisplayDevicesW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDisplayDevice','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDisplayDevice, sizeof(PDISPLAY_DEVICEW),1);
 	else fprintf(fp,"{'name':'lpDisplayDevice','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDisplayDevice,sizeof(PDISPLAY_DEVICEW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMenuItemFromPoint) (HWND hWnd,HMENU hMenu,POINT ptScreen) = MenuItemFromPoint;
int fake_MenuItemFromPoint(HWND hWnd,HMENU hMenu,POINT ptScreen){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MenuItemFromPoint',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'ptScreen','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ptScreen, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'ptScreen','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ptScreen,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMenuItemFromPoint(hWnd,hMenu,ptScreen);
	fprintf(fp,"OUT ['MenuItemFromPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnregisterClassA) (LPCSTR lpClassName,HINSTANCE hInstance) = UnregisterClassA;
BOOL fake_UnregisterClassA(LPCSTR lpClassName,HINSTANCE hInstance){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnregisterClassA',");
	if(1) fprintf(fp,"{'name':'lpClassName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpClassName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpClassName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClassName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnregisterClassA(lpClassName,hInstance);
	fprintf(fp,"OUT ['UnregisterClassA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDeregisterShellHookWindow) (HWND hwnd) = DeregisterShellHookWindow;
BOOL fake_DeregisterShellHookWindow(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DeregisterShellHookWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDeregisterShellHookWindow(hwnd);
	fprintf(fp,"OUT ['DeregisterShellHookWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetDoubleClickTime) (UINT arg0) = SetDoubleClickTime;
BOOL fake_SetDoubleClickTime(UINT arg0){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetDoubleClickTime',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetDoubleClickTime(arg0);
	fprintf(fp,"OUT ['SetDoubleClickTime',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetProcessWindowStation) (HWINSTA hWinSta) = SetProcessWindowStation;
BOOL fake_SetProcessWindowStation(HWINSTA hWinSta){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetProcessWindowStation',");
	if(1) fprintf(fp,"{'name':'hWinSta','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWinSta, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'hWinSta','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWinSta,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetProcessWindowStation(hWinSta);
	fprintf(fp,"OUT ['SetProcessWindowStation',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HACCEL (WINAPI *pLoadAcceleratorsW) (HINSTANCE hInstance,LPCWSTR lpTableName) = LoadAcceleratorsW;
HACCEL fake_LoadAcceleratorsW(HINSTANCE hInstance,LPCWSTR lpTableName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadAcceleratorsW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpTableName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpTableName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpTableName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpTableName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpTableName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HACCEL ret = pLoadAcceleratorsW(hInstance,lpTableName);
	fprintf(fp,"OUT ['LoadAcceleratorsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HACCEL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEndMenu) () = EndMenu;
BOOL fake_EndMenu(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EndMenu',");
	fprintf(fp,"]\n");
	BOOL ret = pEndMenu();
	fprintf(fp,"OUT ['EndMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HBITMAP (WINAPI *pLoadBitmapW) (HINSTANCE hInstance,LPCWSTR lpBitmapName) = LoadBitmapW;
HBITMAP fake_LoadBitmapW(HINSTANCE hInstance,LPCWSTR lpBitmapName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadBitmapW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpBitmapName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpBitmapName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpBitmapName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpBitmapName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpBitmapName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HBITMAP ret = pLoadBitmapW(hInstance,lpBitmapName);
	fprintf(fp,"OUT ['LoadBitmapW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HBITMAP),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HBITMAP));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetRawInputDeviceInfoA) (HANDLE hDevice,UINT uiCommand,LPVOID pData,PUINT pcbSize) = GetRawInputDeviceInfoA;
UINT fake_GetRawInputDeviceInfoA(HANDLE hDevice,UINT uiCommand,LPVOID pData,PUINT pcbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetRawInputDeviceInfoA',");
	if(1) fprintf(fp,"{'name':'hDevice','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDevice, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hDevice','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDevice,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiCommand','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiCommand, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiCommand','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiCommand,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pData','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pData, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'pData','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pData,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetRawInputDeviceInfoA(hDevice,uiCommand,pData,pcbSize);
	fprintf(fp,"OUT ['GetRawInputDeviceInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pData','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pData, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'pData','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pData,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMenuItemInfoA) (HMENU hmenu,UINT item,BOOL fByPosition,LPMENUITEMINFOA lpmii) = GetMenuItemInfoA;
BOOL fake_GetMenuItemInfoA(HMENU hmenu,UINT item,BOOL fByPosition,LPMENUITEMINFOA lpmii){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuItemInfoA',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'item','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",item, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'item','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",item,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPosition, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fByPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPosition,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmii, sizeof(LPMENUITEMINFOA),1);
 	else fprintf(fp,"{'name':'lpmii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmii,sizeof(LPMENUITEMINFOA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMenuItemInfoA(hmenu,item,fByPosition,lpmii);
	fprintf(fp,"OUT ['GetMenuItemInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmii, sizeof(LPMENUITEMINFOA),1);
 	else fprintf(fp,"{'name':'lpmii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmii,sizeof(LPMENUITEMINFOA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawMenuBar) (HWND hWnd) = DrawMenuBar;
BOOL fake_DrawMenuBar(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawMenuBar',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawMenuBar(hWnd);
	fprintf(fp,"OUT ['DrawMenuBar',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAppendMenuA) (HMENU hMenu,UINT uFlags,UINT_PTR uIDNewItem,LPCSTR lpNewItem) = AppendMenuA;
BOOL fake_AppendMenuA(HMENU hMenu,UINT uFlags,UINT_PTR uIDNewItem,LPCSTR lpNewItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AppendMenuA',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDNewItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDNewItem, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDNewItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDNewItem,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpNewItem','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpNewItem, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpNewItem','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpNewItem,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAppendMenuA(hMenu,uFlags,uIDNewItem,lpNewItem);
	fprintf(fp,"OUT ['AppendMenuA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetSystemCursor) (HCURSOR hcur,DWORD id) = SetSystemCursor;
BOOL fake_SetSystemCursor(HCURSOR hcur,DWORD id){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetSystemCursor',");
	if(1) fprintf(fp,"{'name':'hcur','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hcur, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'hcur','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hcur,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'id','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",id, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'id','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",id,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetSystemCursor(hcur,id);
	fprintf(fp,"OUT ['SetSystemCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWINSTA (WINAPI *pOpenWindowStationA) (LPCSTR lpszWinSta,BOOL fInherit,ACCESS_MASK dwDesiredAccess) = OpenWindowStationA;
HWINSTA fake_OpenWindowStationA(LPCSTR lpszWinSta,BOOL fInherit,ACCESS_MASK dwDesiredAccess){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenWindowStationA',");
	if(1) fprintf(fp,"{'name':'lpszWinSta','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszWinSta, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszWinSta','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszWinSta,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fInherit','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fInherit, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fInherit','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fInherit,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWINSTA ret = pOpenWindowStationA(lpszWinSta,fInherit,dwDesiredAccess);
	fprintf(fp,"OUT ['OpenWindowStationA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetScrollPos) (HWND hWnd,int nBar) = GetScrollPos;
int fake_GetScrollPos(HWND hWnd,int nBar){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetScrollPos',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBar,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetScrollPos(hWnd,nBar);
	fprintf(fp,"OUT ['GetScrollPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDestroyMenu) (HMENU hMenu) = DestroyMenu;
BOOL fake_DestroyMenu(HMENU hMenu){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DestroyMenu',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDestroyMenu(hMenu);
	fprintf(fp,"OUT ['DestroyMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetScrollRange) (HWND hWnd,int nBar,int nMinPos,int nMaxPos,BOOL bRedraw) = SetScrollRange;
BOOL fake_SetScrollRange(HWND hWnd,int nBar,int nMinPos,int nMaxPos,BOOL bRedraw){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetScrollRange',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBar,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nMinPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nMinPos, sizeof(int),1);
 	else fprintf(fp,"{'name':'nMinPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nMinPos,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nMaxPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nMaxPos, sizeof(int),1);
 	else fprintf(fp,"{'name':'nMaxPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nMaxPos,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bRedraw','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bRedraw, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bRedraw','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bRedraw,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetScrollRange(hWnd,nBar,nMinPos,nMaxPos,bRedraw);
	fprintf(fp,"OUT ['SetScrollRange',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pSendMessageW) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = SendMessageW;
LRESULT fake_SendMessageW(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendMessageW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pSendMessageW(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['SendMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDeleteMenu) (HMENU hMenu,UINT uPosition,UINT uFlags) = DeleteMenu;
BOOL fake_DeleteMenu(HMENU hMenu,UINT uPosition,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DeleteMenu',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDeleteMenu(hMenu,uPosition,uFlags);
	fprintf(fp,"OUT ['DeleteMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetGUIThreadInfo) (DWORD idThread,PGUITHREADINFO pgui) = GetGUIThreadInfo;
BOOL fake_GetGUIThreadInfo(DWORD idThread,PGUITHREADINFO pgui){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetGUIThreadInfo',");
	if(1) fprintf(fp,"{'name':'idThread','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idThread, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idThread','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idThread,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pgui','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pgui, sizeof(PGUITHREADINFO),1);
 	else fprintf(fp,"{'name':'pgui','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pgui,sizeof(PGUITHREADINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetGUIThreadInfo(idThread,pgui);
	fprintf(fp,"OUT ['GetGUIThreadInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pgui','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pgui, sizeof(PGUITHREADINFO),1);
 	else fprintf(fp,"{'name':'pgui','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pgui,sizeof(PGUITHREADINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetUpdatedClipboardFormats) (PUINT lpuiFormats,UINT cFormats,PUINT pcFormatsOut) = GetUpdatedClipboardFormats;
BOOL fake_GetUpdatedClipboardFormats(PUINT lpuiFormats,UINT cFormats,PUINT pcFormatsOut){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetUpdatedClipboardFormats',");
	if(1) fprintf(fp,"{'name':'cFormats','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cFormats, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cFormats','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cFormats,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetUpdatedClipboardFormats(lpuiFormats,cFormats,pcFormatsOut);
	fprintf(fp,"OUT ['GetUpdatedClipboardFormats',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpuiFormats','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpuiFormats, sizeof(PUINT),cFormats);
 	else fprintf(fp,"{'name':'lpuiFormats','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpuiFormats,sizeof(PUINT));
	if(lpuiFormats){
		for(int i=0; i<cFormats;i++){
			fprintf(fp,"0x%x,",lpuiFormats[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcFormatsOut','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcFormatsOut, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcFormatsOut','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcFormatsOut,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetRegisteredRawInputDevices) (PRAWINPUTDEVICE pRawInputDevices,PUINT puiNumDevices,UINT cbSize) = GetRegisteredRawInputDevices;
UINT fake_GetRegisteredRawInputDevices(PRAWINPUTDEVICE pRawInputDevices,PUINT puiNumDevices,UINT cbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetRegisteredRawInputDevices',");
	if(1) fprintf(fp,"{'name':'puiNumDevices','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",puiNumDevices, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'puiNumDevices','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",puiNumDevices,sizeof(PUINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetRegisteredRawInputDevices(pRawInputDevices,puiNumDevices,cbSize);
	fprintf(fp,"OUT ['GetRegisteredRawInputDevices',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pRawInputDevices','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pRawInputDevices, sizeof(PRAWINPUTDEVICE), *puiNumDevices);
 	else fprintf(fp,"{'name':'pRawInputDevices','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pRawInputDevices,sizeof(PRAWINPUTDEVICE));
	if(pRawInputDevices){
		for(int i=0; i< *puiNumDevices;i++){
			fprintf(fp,"0x%x,",pRawInputDevices[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'puiNumDevices','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",puiNumDevices, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'puiNumDevices','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",puiNumDevices,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetCursorPos) (int X,int Y) = SetCursorPos;
BOOL fake_SetCursorPos(int X,int Y){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetCursorPos',");
	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetCursorPos(X,Y);
	fprintf(fp,"OUT ['SetCursorPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsZoomed) (HWND hWnd) = IsZoomed;
BOOL fake_IsZoomed(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsZoomed',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsZoomed(hWnd);
	fprintf(fp,"OUT ['IsZoomed',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ULONG_PTR (WINAPI *pGetClassLongPtrW) (HWND hWnd,int nIndex) = GetClassLongPtrW;
ULONG_PTR fake_GetClassLongPtrW(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassLongPtrW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ULONG_PTR ret = pGetClassLongPtrW(hWnd,nIndex);
	fprintf(fp,"OUT ['GetClassLongPtrW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pExitWindowsEx) (UINT uFlags,DWORD dwReason) = ExitWindowsEx;
BOOL fake_ExitWindowsEx(UINT uFlags,DWORD dwReason){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ExitWindowsEx',");
	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwReason','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwReason, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwReason','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwReason,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pExitWindowsEx(uFlags,dwReason);
	fprintf(fp,"OUT ['ExitWindowsEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pToUnicode) (UINT wVirtKey,UINT wScanCode,CONST BYTE* lpKeyState,LPWSTR pwszBuff,int cchBuff,UINT wFlags) = ToUnicode;
int fake_ToUnicode(UINT wVirtKey,UINT wScanCode,CONST BYTE* lpKeyState,LPWSTR pwszBuff,int cchBuff,UINT wFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ToUnicode',");
	if(1) fprintf(fp,"{'name':'wVirtKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wVirtKey, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wVirtKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wVirtKey,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wScanCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wScanCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wScanCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wScanCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpKeyState','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpKeyState, sizeof(CONST BYTE*),1);
 	else fprintf(fp,"{'name':'lpKeyState','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpKeyState,sizeof(CONST BYTE*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchBuff','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchBuff, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchBuff','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchBuff,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pToUnicode(wVirtKey,wScanCode,lpKeyState,pwszBuff,cchBuff,wFlags);
	fprintf(fp,"OUT ['ToUnicode',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pwszBuff',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pwszBuff);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pwszBuff);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchBuff);
 	}else 
	{
		fprintf(fp,"{'name':'pwszBuff',");
		fwprintf(fp, L"'value': %p, ", pwszBuff);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pwszBuff){
		for(int i=0; i<cchBuff;i++){
			fprintf(fp,"0x%x,",pwszBuff[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pGetPropA) (HWND hWnd,LPCSTR lpString) = GetPropA;
HANDLE fake_GetPropA(HWND hWnd,LPCSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetPropA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpString','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pGetPropA(hWnd,lpString);
	fprintf(fp,"OUT ['GetPropA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetUpdateRect) (HWND hWnd,LPRECT lpRect,BOOL bErase) = GetUpdateRect;
BOOL fake_GetUpdateRect(HWND hWnd,LPRECT lpRect,BOOL bErase){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetUpdateRect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bErase','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bErase, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bErase','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bErase,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetUpdateRect(hWnd,lpRect,bErase);
	fprintf(fp,"OUT ['GetUpdateRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pMapVirtualKeyExA) (UINT uCode,UINT uMapType,HKL dwhkl) = MapVirtualKeyExA;
UINT fake_MapVirtualKeyExA(UINT uCode,UINT uMapType,HKL dwhkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MapVirtualKeyExA',");
	if(1) fprintf(fp,"{'name':'uCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMapType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMapType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMapType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMapType,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwhkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwhkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'dwhkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwhkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pMapVirtualKeyExA(uCode,uMapType,dwhkl);
	fprintf(fp,"OUT ['MapVirtualKeyExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pSetWindowRgn) (HWND hWnd,HRGN hRgn,BOOL bRedraw) = SetWindowRgn;
int fake_SetWindowRgn(HWND hWnd,HRGN hRgn,BOOL bRedraw){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowRgn',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hRgn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRgn, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hRgn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRgn,sizeof(HRGN));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bRedraw','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bRedraw, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bRedraw','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bRedraw,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pSetWindowRgn(hWnd,hRgn,bRedraw);
	fprintf(fp,"OUT ['SetWindowRgn',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDesktopsW) (HWINSTA hwinsta,DESKTOPENUMPROCW lpEnumFunc,LPARAM lParam) = EnumDesktopsW;
BOOL fake_EnumDesktopsW(HWINSTA hwinsta,DESKTOPENUMPROCW lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDesktopsW',");
	if(1) fprintf(fp,"{'name':'hwinsta','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwinsta, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'hwinsta','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwinsta,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(DESKTOPENUMPROCW),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(DESKTOPENUMPROCW));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDesktopsW(hwinsta,lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumDesktopsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetDlgItemTextA) (HWND hDlg,int nIDDlgItem,LPSTR lpString,int cchMax) = GetDlgItemTextA;
UINT fake_GetDlgItemTextA(HWND hDlg,int nIDDlgItem,LPSTR lpString,int cchMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDlgItemTextA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMax,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetDlgItemTextA(hDlg,nIDDlgItem,lpString,cchMax);
	fprintf(fp,"OUT ['GetDlgItemTextA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPSTR),cchMax);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPSTR));
	if(lpString){
		for(int i=0; i<cchMax;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pDisplayConfigSetDeviceInfo) (DISPLAYCONFIG_DEVICE_INFO_HEADER*  setPacket) = DisplayConfigSetDeviceInfo;
LONG fake_DisplayConfigSetDeviceInfo(DISPLAYCONFIG_DEVICE_INFO_HEADER*  setPacket){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DisplayConfigSetDeviceInfo',");
	if(1) fprintf(fp,"{'name':' setPacket','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", setPacket, sizeof(DISPLAYCONFIG_DEVICE_INFO_HEADER*),1);
 	else fprintf(fp,"{'name':' setPacket','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", setPacket,sizeof(DISPLAYCONFIG_DEVICE_INFO_HEADER*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pDisplayConfigSetDeviceInfo( setPacket);
	fprintf(fp,"OUT ['DisplayConfigSetDeviceInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

WORD (WINAPI *pGetWindowWord) (HWND hWnd,int nIndex) = GetWindowWord;
WORD fake_GetWindowWord(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowWord',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	WORD ret = pGetWindowWord(hWnd,nIndex);
	fprintf(fp,"OUT ['GetWindowWord',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetMessagePos) () = GetMessagePos;
DWORD fake_GetMessagePos(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMessagePos',");
	fprintf(fp,"]\n");
	DWORD ret = pGetMessagePos();
	fprintf(fp,"OUT ['GetMessagePos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPSTR (WINAPI *pCharPrevExA) (WORD CodePage,LPCSTR lpStart,LPCSTR lpCurrentChar,DWORD dwFlags) = CharPrevExA;
LPSTR fake_CharPrevExA(WORD CodePage,LPCSTR lpStart,LPCSTR lpCurrentChar,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharPrevExA',");
	if(1) fprintf(fp,"{'name':'CodePage','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",CodePage, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'CodePage','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",CodePage,sizeof(WORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpStart','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpStart, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpStart','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpStart,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpCurrentChar','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpCurrentChar, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpCurrentChar','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpCurrentChar,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPSTR ret = pCharPrevExA(CodePage,lpStart,lpCurrentChar,dwFlags);
	fprintf(fp,"OUT ['CharPrevExA',");
	if(1) fprintf(fp,"{'name':'ret','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'ret','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pCharUpperBuffA) (LPSTR lpsz,DWORD cchLength) = CharUpperBuffA;
DWORD fake_CharUpperBuffA(LPSTR lpsz,DWORD cchLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharUpperBuffA',");
	if(1) fprintf(fp,"{'name':'lpsz','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),cchLength);
 	else fprintf(fp,"{'name':'lpsz','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pCharUpperBuffA(lpsz,cchLength);
	fprintf(fp,"OUT ['CharUpperBuffA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsz','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),cchLength);
 	else fprintf(fp,"{'name':'lpsz','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMenuItemRect) (HWND hWnd,HMENU hMenu,UINT uItem,LPRECT lprcItem) = GetMenuItemRect;
BOOL fake_GetMenuItemRect(HWND hWnd,HMENU hMenu,UINT uItem,LPRECT lprcItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuItemRect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uItem,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMenuItemRect(hWnd,hMenu,uItem,lprcItem);
	fprintf(fp,"OUT ['GetMenuItemRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcItem','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcItem, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprcItem','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcItem,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pValidateRgn) (HWND hWnd,HRGN hRgn) = ValidateRgn;
BOOL fake_ValidateRgn(HWND hWnd,HRGN hRgn){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ValidateRgn',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hRgn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRgn, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hRgn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRgn,sizeof(HRGN));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pValidateRgn(hWnd,hRgn);
	fprintf(fp,"OUT ['ValidateRgn',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDestroyIcon) (HICON hIcon) = DestroyIcon;
BOOL fake_DestroyIcon(HICON hIcon){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DestroyIcon',");
	if(1) fprintf(fp,"{'name':'hIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hIcon, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'hIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hIcon,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDestroyIcon(hIcon);
	fprintf(fp,"OUT ['DestroyIcon',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOpenIcon) (HWND hWnd) = OpenIcon;
BOOL fake_OpenIcon(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenIcon',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOpenIcon(hWnd);
	fprintf(fp,"OUT ['OpenIcon',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPostThreadMessageA) (DWORD idThread,UINT Msg,WPARAM wParam,LPARAM lParam) = PostThreadMessageA;
BOOL fake_PostThreadMessageA(DWORD idThread,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PostThreadMessageA',");
	if(1) fprintf(fp,"{'name':'idThread','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idThread, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idThread','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idThread,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPostThreadMessageA(idThread,Msg,wParam,lParam);
	fprintf(fp,"OUT ['PostThreadMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pSetClipboardData) (UINT uFormat,HANDLE hMem) = SetClipboardData;
HANDLE fake_SetClipboardData(UINT uFormat,HANDLE hMem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClipboardData',");
	if(1) fprintf(fp,"{'name':'uFormat','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFormat, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFormat','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFormat,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMem, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hMem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMem,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pSetClipboardData(uFormat,hMem);
	fprintf(fp,"OUT ['SetClipboardData',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pRegisterClipboardFormatW) (LPCWSTR lpszFormat) = RegisterClipboardFormatW;
UINT fake_RegisterClipboardFormatW(LPCWSTR lpszFormat){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterClipboardFormatW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszFormat',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszFormat);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszFormat);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszFormat',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszFormat);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pRegisterClipboardFormatW(lpszFormat);
	fprintf(fp,"OUT ['RegisterClipboardFormatW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShutdownBlockReasonQuery) (HWND hWnd,LPWSTR pwszBuff,DWORD* pcchBuff) = ShutdownBlockReasonQuery;
BOOL fake_ShutdownBlockReasonQuery(HWND hWnd,LPWSTR pwszBuff,DWORD* pcchBuff){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShutdownBlockReasonQuery',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcchBuff','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcchBuff, sizeof(DWORD*),1);
 	else fprintf(fp,"{'name':'pcchBuff','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcchBuff,sizeof(DWORD*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShutdownBlockReasonQuery(hWnd,pwszBuff,pcchBuff);
	fprintf(fp,"OUT ['ShutdownBlockReasonQuery',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(pcchBuff && 1)
	{
		fprintf(fp,"{'name':'pwszBuff',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pwszBuff);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pwszBuff);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),*pcchBuff);
 	}else 
	{
		fprintf(fp,"{'name':'pwszBuff',");
		fwprintf(fp, L"'value': %p, ", pwszBuff);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pcchBuff && pwszBuff){
		for(int i=0; i<*pcchBuff;i++){
			fprintf(fp,"0x%x,",pwszBuff[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcchBuff','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcchBuff, sizeof(DWORD*),1);
 	else fprintf(fp,"{'name':'pcchBuff','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcchBuff,sizeof(DWORD*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pMapVirtualKeyW) (UINT uCode,UINT uMapType) = MapVirtualKeyW;
UINT fake_MapVirtualKeyW(UINT uCode,UINT uMapType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MapVirtualKeyW',");
	if(1) fprintf(fp,"{'name':'uCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMapType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMapType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMapType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMapType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pMapVirtualKeyW(uCode,uMapType);
	fprintf(fp,"OUT ['MapVirtualKeyW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pSendMessageTimeoutW) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,UINT fuFlags,UINT uTimeout,PDWORD_PTR lpdwResult) = SendMessageTimeoutW;
LRESULT fake_SendMessageTimeoutW(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,UINT fuFlags,UINT uTimeout,PDWORD_PTR lpdwResult){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendMessageTimeoutW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fuFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fuFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fuFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fuFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uTimeout','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uTimeout, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uTimeout','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uTimeout,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pSendMessageTimeoutW(hWnd,Msg,wParam,lParam,fuFlags,uTimeout,lpdwResult);
	fprintf(fp,"OUT ['SendMessageTimeoutW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpdwResult','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpdwResult, sizeof(PDWORD_PTR),1);
 	else fprintf(fp,"{'name':'lpdwResult','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpdwResult,sizeof(PDWORD_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pReplyMessage) (LRESULT lResult) = ReplyMessage;
BOOL fake_ReplyMessage(LRESULT lResult){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ReplyMessage',");
	if(1) fprintf(fp,"{'name':'lResult','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lResult, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'lResult','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lResult,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pReplyMessage(lResult);
	fprintf(fp,"OUT ['ReplyMessage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pCreateIconFromResource) (PBYTE presbits,DWORD dwResSize,BOOL fIcon,DWORD dwVer) = CreateIconFromResource;
HICON fake_CreateIconFromResource(PBYTE presbits,DWORD dwResSize,BOOL fIcon,DWORD dwVer){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateIconFromResource',");
	if(1) fprintf(fp,"{'name':'presbits','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",presbits, sizeof(PBYTE),1);
 	else fprintf(fp,"{'name':'presbits','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",presbits,sizeof(PBYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwResSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwResSize, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwResSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwResSize,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fIcon, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fIcon,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwVer','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwVer, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwVer','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwVer,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pCreateIconFromResource(presbits,dwResSize,fIcon,dwVer);
	fprintf(fp,"OUT ['CreateIconFromResource',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetSysColor) (int nIndex) = GetSysColor;
DWORD fake_GetSysColor(int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetSysColor',");
	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetSysColor(nIndex);
	fprintf(fp,"OUT ['GetSysColor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetIconInfoExA) (HICON hicon,PICONINFOEXA piconinfo) = GetIconInfoExA;
BOOL fake_GetIconInfoExA(HICON hicon,PICONINFOEXA piconinfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetIconInfoExA',");
	if(1) fprintf(fp,"{'name':'hicon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hicon, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'hicon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hicon,sizeof(HICON));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconinfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconinfo, sizeof(PICONINFOEXA),1);
 	else fprintf(fp,"{'name':'piconinfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconinfo,sizeof(PICONINFOEXA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetIconInfoExA(hicon,piconinfo);
	fprintf(fp,"OUT ['GetIconInfoExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconinfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconinfo, sizeof(PICONINFOEXA),1);
 	else fprintf(fp,"{'name':'piconinfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconinfo,sizeof(PICONINFOEXA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDrawTextExW) (HDC hdc,LPWSTR lpchText,int cchText,LPRECT lprc,UINT format,LPDRAWTEXTPARAMS lpdtp) = DrawTextExW;
int fake_DrawTextExW(HDC hdc,LPWSTR lpchText,int cchText,LPRECT lprc,UINT format,LPDRAWTEXTPARAMS lpdtp){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawTextExW',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpchText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpchText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpchText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchText);
 	}else 
	{
		fprintf(fp,"{'name':'lpchText',");
		fwprintf(fp, L"'value': %p, ", lpchText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchText','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchText, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchText','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchText,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpdtp','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpdtp, sizeof(LPDRAWTEXTPARAMS),1);
 	else fprintf(fp,"{'name':'lpdtp','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpdtp,sizeof(LPDRAWTEXTPARAMS));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDrawTextExW(hdc,lpchText,cchText,lprc,format,lpdtp);
	fprintf(fp,"OUT ['DrawTextExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpchText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpchText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpchText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchText);
 	}else 
	{
		fprintf(fp,"{'name':'lpchText',");
		fwprintf(fp, L"'value': %p, ", lpchText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetWindowRect) (HWND hWnd,LPRECT lpRect) = GetWindowRect;
BOOL fake_GetWindowRect(HWND hWnd,LPRECT lpRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowRect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetWindowRect(hWnd,lpRect);
	fprintf(fp,"OUT ['GetWindowRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG_PTR (WINAPI *pGetWindowLongPtrA) (HWND hWnd,int nIndex) = GetWindowLongPtrA;
LONG_PTR fake_GetWindowLongPtrA(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowLongPtrA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG_PTR ret = pGetWindowLongPtrA(hWnd,nIndex);
	fprintf(fp,"OUT ['GetWindowLongPtrA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWINSTA (WINAPI *pCreateWindowStationW) (LPCWSTR lpwinsta,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa) = CreateWindowStationW;
HWINSTA fake_CreateWindowStationW(LPCWSTR lpwinsta,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateWindowStationW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpwinsta',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpwinsta);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpwinsta);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpwinsta',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpwinsta);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsa','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsa, sizeof(LPSECURITY_ATTRIBUTES),1);
 	else fprintf(fp,"{'name':'lpsa','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsa,sizeof(LPSECURITY_ATTRIBUTES));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWINSTA ret = pCreateWindowStationW(lpwinsta,dwFlags,dwDesiredAccess,lpsa);
	fprintf(fp,"OUT ['CreateWindowStationW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetWindow) (HWND hWnd,UINT uCmd) = GetWindow;
HWND fake_GetWindow(HWND hWnd,UINT uCmd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uCmd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCmd, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCmd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCmd,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetWindow(hWnd,uCmd);
	fprintf(fp,"OUT ['GetWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pChangeDisplaySettingsExA) (LPCSTR lpszDeviceName,DEVMODEA*  lpDevMode,HWND hwnd,DWORD dwflags,LPVOID lParam) = ChangeDisplaySettingsExA;
LONG fake_ChangeDisplaySettingsExA(LPCSTR lpszDeviceName,DEVMODEA*  lpDevMode,HWND hwnd,DWORD dwflags,LPVOID lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeDisplaySettingsExA',");
	if(1) fprintf(fp,"{'name':'lpszDeviceName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDeviceName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDeviceName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDeviceName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwflags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwflags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwflags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwflags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'lParam','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPVOID));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pChangeDisplaySettingsExA(lpszDeviceName, lpDevMode,hwnd,dwflags,lParam);
	fprintf(fp,"OUT ['ChangeDisplaySettingsExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pSetCursor) (HCURSOR hCursor) = SetCursor;
HCURSOR fake_SetCursor(HCURSOR hCursor){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetCursor',");
	if(1) fprintf(fp,"{'name':'hCursor','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hCursor, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'hCursor','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hCursor,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pSetCursor(hCursor);
	fprintf(fp,"OUT ['SetCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pMapDialogRect) (HWND hDlg,LPRECT lpRect) = MapDialogRect;
BOOL fake_MapDialogRect(HWND hDlg,LPRECT lpRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MapDialogRect',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pMapDialogRect(hDlg,lpRect);
	fprintf(fp,"OUT ['MapDialogRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSubtractRect) (LPRECT lprcDst,CONST RECT* lprcSrc1,CONST RECT* lprcSrc2) = SubtractRect;
BOOL fake_SubtractRect(LPRECT lprcDst,CONST RECT* lprcSrc1,CONST RECT* lprcSrc2){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SubtractRect',");
	if(1) fprintf(fp,"{'name':'lprcSrc1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc1, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc1,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcSrc2','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc2, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc2','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc2,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSubtractRect(lprcDst,lprcSrc1,lprcSrc2);
	fprintf(fp,"OUT ['SubtractRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcDst, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprcDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcDst,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pLockSetForegroundWindow) (UINT uLockCode) = LockSetForegroundWindow;
BOOL fake_LockSetForegroundWindow(UINT uLockCode){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LockSetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'uLockCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uLockCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uLockCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uLockCode,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pLockSetForegroundWindow(uLockCode);
	fprintf(fp,"OUT ['LockSetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnregisterClassW) (LPCWSTR lpClassName,HINSTANCE hInstance) = UnregisterClassW;
BOOL fake_UnregisterClassW(LPCWSTR lpClassName,HINSTANCE hInstance){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnregisterClassW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpClassName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnregisterClassW(lpClassName,hInstance);
	fprintf(fp,"OUT ['UnregisterClassW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplaySettingsA) (LPCSTR lpszDeviceName,DWORD iModeNum,DEVMODEA*  lpDevMode) = EnumDisplaySettingsA;
BOOL fake_EnumDisplaySettingsA(LPCSTR lpszDeviceName,DWORD iModeNum,DEVMODEA*  lpDevMode){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplaySettingsA',");
	if(1) fprintf(fp,"{'name':'lpszDeviceName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDeviceName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDeviceName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDeviceName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iModeNum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iModeNum, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'iModeNum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iModeNum,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplaySettingsA(lpszDeviceName,iModeNum, lpDevMode);
	fprintf(fp,"OUT ['EnumDisplaySettingsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pSetLastErrorEx) (DWORD dwErrCode,DWORD dwType) = SetLastErrorEx;
VOID fake_SetLastErrorEx(DWORD dwErrCode,DWORD dwType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetLastErrorEx',");
	if(1) fprintf(fp,"{'name':'dwErrCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwErrCode, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwErrCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwErrCode,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwType, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwType,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pSetLastErrorEx(dwErrCode,dwType);
	fprintf(fp,"OUT ['SetLastErrorEx',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMonitorInfoW) (HMONITOR hMonitor,LPMONITORINFO lpmi) = GetMonitorInfoW;
BOOL fake_GetMonitorInfoW(HMONITOR hMonitor,LPMONITORINFO lpmi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMonitorInfoW',");
	if(1) fprintf(fp,"{'name':'hMonitor','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMonitor, sizeof(HMONITOR),1);
 	else fprintf(fp,"{'name':'hMonitor','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMonitor,sizeof(HMONITOR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmi, sizeof(LPMONITORINFO),1);
 	else fprintf(fp,"{'name':'lpmi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmi,sizeof(LPMONITORINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMonitorInfoW(hMonitor,lpmi);
	fprintf(fp,"OUT ['GetMonitorInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmi, sizeof(LPMONITORINFO),1);
 	else fprintf(fp,"{'name':'lpmi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmi,sizeof(LPMONITORINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pCreateIconIndirect) (PICONINFO piconinfo) = CreateIconIndirect;
HICON fake_CreateIconIndirect(PICONINFO piconinfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateIconIndirect',");
	if(1) fprintf(fp,"{'name':'piconinfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconinfo, sizeof(PICONINFO),1);
 	else fprintf(fp,"{'name':'piconinfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconinfo,sizeof(PICONINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pCreateIconIndirect(piconinfo);
	fprintf(fp,"OUT ['CreateIconIndirect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pDisableProcessWindowsGhosting) () = DisableProcessWindowsGhosting;
VOID fake_DisableProcessWindowsGhosting(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DisableProcessWindowsGhosting',");
	fprintf(fp,"]\n");
	VOID ret = pDisableProcessWindowsGhosting();
	fprintf(fp,"OUT ['DisableProcessWindowsGhosting',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRegisterTouchWindow) (HWND hwnd,ULONG ulFlags) = RegisterTouchWindow;
BOOL fake_RegisterTouchWindow(HWND hwnd,ULONG ulFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterTouchWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'ulFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ulFlags, sizeof(ULONG),1);
 	else fprintf(fp,"{'name':'ulFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ulFlags,sizeof(ULONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRegisterTouchWindow(hwnd,ulFlags);
	fprintf(fp,"OUT ['RegisterTouchWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pDragObject) (HWND hwndParent,HWND hwndFrom,UINT fmt,ULONG_PTR data,HCURSOR hcur) = DragObject;
DWORD fake_DragObject(HWND hwndParent,HWND hwndFrom,UINT fmt,ULONG_PTR data,HCURSOR hcur){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DragObject',");
	if(1) fprintf(fp,"{'name':'hwndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hwndFrom','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndFrom, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndFrom','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndFrom,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fmt','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fmt, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fmt','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fmt,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'data','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",data, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'data','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",data,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hcur','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hcur, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'hcur','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hcur,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pDragObject(hwndParent,hwndFrom,fmt,data,hcur);
	fprintf(fp,"OUT ['DragObject',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pReleaseCapture) () = ReleaseCapture;
BOOL fake_ReleaseCapture(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ReleaseCapture',");
	fprintf(fp,"]\n");
	BOOL ret = pReleaseCapture();
	fprintf(fp,"OUT ['ReleaseCapture',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pScreenToClient) (HWND hWnd,LPPOINT lpPoint) = ScreenToClient;
BOOL fake_ScreenToClient(HWND hWnd,LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ScreenToClient',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pScreenToClient(hWnd,lpPoint);
	fprintf(fp,"OUT ['ScreenToClient',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pFindWindowExW) (HWND hWndParent,HWND hWndChildAfter,LPCWSTR lpszClass,LPCWSTR lpszWindow) = FindWindowExW;
HWND fake_FindWindowExW(HWND hWndParent,HWND hWndChildAfter,LPCWSTR lpszClass,LPCWSTR lpszWindow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FindWindowExW',");
	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndChildAfter','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndChildAfter, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndChildAfter','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndChildAfter,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszClass',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszClass);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszClass);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszClass',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszClass);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszWindow',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszWindow);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszWindow);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszWindow',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszWindow);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pFindWindowExW(hWndParent,hWndChildAfter,lpszClass,lpszWindow);
	fprintf(fp,"OUT ['FindWindowExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDlgDirListA) (HWND hDlg,LPSTR lpPathSpec,int nIDListBox,int nIDStaticPath,UINT uFileType) = DlgDirListA;
int fake_DlgDirListA(HWND hDlg,LPSTR lpPathSpec,int nIDListBox,int nIDStaticPath,UINT uFileType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirListA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpPathSpec, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPathSpec,sizeof(LPSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDListBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDListBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDListBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDListBox,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDStaticPath, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDStaticPath,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFileType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFileType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFileType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFileType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDlgDirListA(hDlg,lpPathSpec,nIDListBox,nIDStaticPath,uFileType);
	fprintf(fp,"OUT ['DlgDirListA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpPathSpec, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpPathSpec','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPathSpec,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pWindowFromDC) (HDC hDC) = WindowFromDC;
HWND fake_WindowFromDC(HDC hDC){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WindowFromDC',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pWindowFromDC(hDC);
	fprintf(fp,"OUT ['WindowFromDC',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUpdateLayeredWindow) (HWND hWnd,HDC hdcDst,POINT*  pptDst,SIZE*  psize,HDC hdcSrc,POINT*  pptSrc,COLORREF crKey,BLENDFUNCTION*  pblend,DWORD dwFlags) = UpdateLayeredWindow;
BOOL fake_UpdateLayeredWindow(HWND hWnd,HDC hdcDst,POINT*  pptDst,SIZE*  psize,HDC hdcSrc,POINT*  pptSrc,COLORREF crKey,BLENDFUNCTION*  pblend,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UpdateLayeredWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hdcDst','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdcDst, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdcDst','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdcDst,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pptDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pptDst, sizeof(POINT*),1);
 	else fprintf(fp,"{'name':' pptDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pptDst,sizeof(POINT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' psize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", psize, sizeof(SIZE*),1);
 	else fprintf(fp,"{'name':' psize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", psize,sizeof(SIZE*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hdcSrc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdcSrc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdcSrc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdcSrc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pptSrc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pptSrc, sizeof(POINT*),1);
 	else fprintf(fp,"{'name':' pptSrc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pptSrc,sizeof(POINT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'crKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",crKey, sizeof(COLORREF),1);
 	else fprintf(fp,"{'name':'crKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",crKey,sizeof(COLORREF));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pblend','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pblend, sizeof(BLENDFUNCTION*),1);
 	else fprintf(fp,"{'name':' pblend','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pblend,sizeof(BLENDFUNCTION*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUpdateLayeredWindow(hWnd,hdcDst, pptDst, psize,hdcSrc, pptSrc,crKey, pblend,dwFlags);
	fprintf(fp,"OUT ['UpdateLayeredWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ATOM (WINAPI *pRegisterClassExW) (CONST WNDCLASSEXW* arg0) = RegisterClassExW;
ATOM fake_RegisterClassExW(CONST WNDCLASSEXW* arg0){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterClassExW',");
	if(1) fprintf(fp,"{'name':'arg0','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(CONST WNDCLASSEXW*),1);
 	else fprintf(fp,"{'name':'arg0','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(CONST WNDCLASSEXW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ATOM ret = pRegisterClassExW(arg0);
	fprintf(fp,"OUT ['RegisterClassExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ATOM),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ATOM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetWindowTextLengthW) (HWND hWnd) = GetWindowTextLengthW;
int fake_GetWindowTextLengthW(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowTextLengthW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetWindowTextLengthW(hWnd);
	fprintf(fp,"OUT ['GetWindowTextLengthW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pCreateDesktopA) (LPCSTR lpszDesktop,LPCSTR lpszDevice,DEVMODEA*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa) = CreateDesktopA;
HDESK fake_CreateDesktopA(LPCSTR lpszDesktop,LPCSTR lpszDevice,DEVMODEA*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDesktopA',");
	if(1) fprintf(fp,"{'name':'lpszDesktop','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDesktop, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDesktop','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDesktop,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszDevice','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDevice, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDevice','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDevice,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pDevmode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pDevmode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' pDevmode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pDevmode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsa','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsa, sizeof(LPSECURITY_ATTRIBUTES),1);
 	else fprintf(fp,"{'name':'lpsa','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsa,sizeof(LPSECURITY_ATTRIBUTES));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pCreateDesktopA(lpszDesktop,lpszDevice, pDevmode,dwFlags,dwDesiredAccess,lpsa);
	fprintf(fp,"OUT ['CreateDesktopA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pFillRect) (HDC hDC,CONST RECT* lprc,HBRUSH hbr) = FillRect;
int fake_FillRect(HDC hDC,CONST RECT* lprc,HBRUSH hbr){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FillRect',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hbr','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hbr, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'hbr','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hbr,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pFillRect(hDC,lprc,hbr);
	fprintf(fp,"OUT ['FillRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pMoveWindow) (HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint) = MoveWindow;
BOOL fake_MoveWindow(HWND hWnd,int X,int Y,int nWidth,int nHeight,BOOL bRepaint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MoveWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bRepaint','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bRepaint, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bRepaint','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bRepaint,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pMoveWindow(hWnd,X,Y,nWidth,nHeight,bRepaint);
	fprintf(fp,"OUT ['MoveWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetDlgItemTextW) (HWND hDlg,int nIDDlgItem,LPCWSTR lpString) = SetDlgItemTextW;
BOOL fake_SetDlgItemTextW(HWND hDlg,int nIDDlgItem,LPCWSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetDlgItemTextW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetDlgItemTextW(hDlg,nIDDlgItem,lpString);
	fprintf(fp,"OUT ['SetDlgItemTextW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawStateW) (HDC hdc,HBRUSH hbrFore,DRAWSTATEPROC qfnCallBack,LPARAM lData,WPARAM wData,int x,int y,int cx,int cy,UINT uFlags) = DrawStateW;
BOOL fake_DrawStateW(HDC hdc,HBRUSH hbrFore,DRAWSTATEPROC qfnCallBack,LPARAM lData,WPARAM wData,int x,int y,int cx,int cy,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawStateW',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hbrFore','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hbrFore, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'hbrFore','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hbrFore,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'qfnCallBack','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",qfnCallBack, sizeof(DRAWSTATEPROC),1);
 	else fprintf(fp,"{'name':'qfnCallBack','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",qfnCallBack,sizeof(DRAWSTATEPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lData, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lData,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wData, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wData,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'x','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",x, sizeof(int),1);
 	else fprintf(fp,"{'name':'x','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",x,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",y, sizeof(int),1);
 	else fprintf(fp,"{'name':'y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawStateW(hdc,hbrFore,qfnCallBack,lData,wData,x,y,cx,cy,uFlags);
	fprintf(fp,"OUT ['DrawStateW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pLoadIconW) (HINSTANCE hInstance,LPCWSTR lpIconName) = LoadIconW;
HICON fake_LoadIconW(HINSTANCE hInstance,LPCWSTR lpIconName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadIconW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpIconName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpIconName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpIconName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpIconName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpIconName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pLoadIconW(hInstance,lpIconName);
	fprintf(fp,"OUT ['LoadIconW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsWindowUnicode) (HWND hWnd) = IsWindowUnicode;
BOOL fake_IsWindowUnicode(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsWindowUnicode',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsWindowUnicode(hWnd);
	fprintf(fp,"OUT ['IsWindowUnicode',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawStateA) (HDC hdc,HBRUSH hbrFore,DRAWSTATEPROC qfnCallBack,LPARAM lData,WPARAM wData,int x,int y,int cx,int cy,UINT uFlags) = DrawStateA;
BOOL fake_DrawStateA(HDC hdc,HBRUSH hbrFore,DRAWSTATEPROC qfnCallBack,LPARAM lData,WPARAM wData,int x,int y,int cx,int cy,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawStateA',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hbrFore','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hbrFore, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'hbrFore','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hbrFore,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'qfnCallBack','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",qfnCallBack, sizeof(DRAWSTATEPROC),1);
 	else fprintf(fp,"{'name':'qfnCallBack','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",qfnCallBack,sizeof(DRAWSTATEPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lData, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lData,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wData, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wData,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'x','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",x, sizeof(int),1);
 	else fprintf(fp,"{'name':'x','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",x,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",y, sizeof(int),1);
 	else fprintf(fp,"{'name':'y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawStateA(hdc,hbrFore,qfnCallBack,lData,wData,x,y,cx,cy,uFlags);
	fprintf(fp,"OUT ['DrawStateA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pRealGetWindowClassW) (HWND hwnd,LPWSTR ptszClassName,UINT cchClassNameMax) = RealGetWindowClassW;
UINT fake_RealGetWindowClassW(HWND hwnd,LPWSTR ptszClassName,UINT cchClassNameMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RealGetWindowClassW',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchClassNameMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchClassNameMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cchClassNameMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchClassNameMax,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pRealGetWindowClassW(hwnd,ptszClassName,cchClassNameMax);
	fprintf(fp,"OUT ['RealGetWindowClassW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'ptszClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", ptszClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", ptszClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchClassNameMax, ret);
 	}else 
	{
		fprintf(fp,"{'name':'ptszClassName',");
		fwprintf(fp, L"'value': %p, ", ptszClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(ptszClassName){
		for(int i=0; i<cchClassNameMax <  ret ? cchClassNameMax :  ret;i++){
			fprintf(fp,"0x%x,",ptszClassName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCheckDlgButton) (HWND hDlg,int nIDButton,UINT uCheck) = CheckDlgButton;
BOOL fake_CheckDlgButton(HWND hDlg,int nIDButton,UINT uCheck){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CheckDlgButton',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDButton','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDButton, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDButton','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDButton,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uCheck','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCheck, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCheck','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCheck,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCheckDlgButton(hDlg,nIDButton,uCheck);
	fprintf(fp,"OUT ['CheckDlgButton',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetWindowTextA) (HWND hWnd,LPSTR lpString,int nMaxCount) = GetWindowTextA;
int fake_GetWindowTextA(HWND hWnd,LPSTR lpString,int nMaxCount){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowTextA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nMaxCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nMaxCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'nMaxCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nMaxCount,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetWindowTextA(hWnd,lpString,nMaxCount);
	fprintf(fp,"OUT ['GetWindowTextA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPSTR),nMaxCount);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPSTR));
	if(lpString){
		for(int i=0; i<nMaxCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMONITOR (WINAPI *pMonitorFromWindow) (HWND hwnd,DWORD dwFlags) = MonitorFromWindow;
HMONITOR fake_MonitorFromWindow(HWND hwnd,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MonitorFromWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMONITOR ret = pMonitorFromWindow(hwnd,dwFlags);
	fprintf(fp,"OUT ['MonitorFromWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMONITOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMONITOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefWindowProcW) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = DefWindowProcW;
LRESULT fake_DefWindowProcW(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefWindowProcW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefWindowProcW(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['DefWindowProcW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsWindow) (HWND hWnd) = IsWindow;
BOOL fake_IsWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsWindow(hWnd);
	fprintf(fp,"OUT ['IsWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pSendDlgItemMessageA) (HWND hDlg,int nIDDlgItem,UINT Msg,WPARAM wParam,LPARAM lParam) = SendDlgItemMessageA;
LRESULT fake_SendDlgItemMessageA(HWND hDlg,int nIDDlgItem,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendDlgItemMessageA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pSendDlgItemMessageA(hDlg,nIDDlgItem,Msg,wParam,lParam);
	fprintf(fp,"OUT ['SendDlgItemMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pCreateIconFromResourceEx) (PBYTE presbits,DWORD dwResSize,BOOL fIcon,DWORD dwVer,int cxDesired,int cyDesired,UINT Flags) = CreateIconFromResourceEx;
HICON fake_CreateIconFromResourceEx(PBYTE presbits,DWORD dwResSize,BOOL fIcon,DWORD dwVer,int cxDesired,int cyDesired,UINT Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateIconFromResourceEx',");
	if(1) fprintf(fp,"{'name':'presbits','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",presbits, sizeof(PBYTE),1);
 	else fprintf(fp,"{'name':'presbits','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",presbits,sizeof(PBYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwResSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwResSize, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwResSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwResSize,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fIcon, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fIcon,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwVer','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwVer, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwVer','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwVer,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cxDesired','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cxDesired, sizeof(int),1);
 	else fprintf(fp,"{'name':'cxDesired','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cxDesired,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cyDesired','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cyDesired, sizeof(int),1);
 	else fprintf(fp,"{'name':'cyDesired','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cyDesired,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pCreateIconFromResourceEx(presbits,dwResSize,fIcon,dwVer,cxDesired,cyDesired,Flags);
	fprintf(fp,"OUT ['CreateIconFromResourceEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pGetClipboardData) (UINT uFormat) = GetClipboardData;
HANDLE fake_GetClipboardData(UINT uFormat){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipboardData',");
	if(1) fprintf(fp,"{'name':'uFormat','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFormat, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFormat','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFormat,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pGetClipboardData(uFormat);
	fprintf(fp,"OUT ['GetClipboardData',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pSendInput) (UINT cInputs,LPINPUT pInputs,int cbSize) = SendInput;
UINT fake_SendInput(UINT cInputs,LPINPUT pInputs,int cbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendInput',");
	if(1) fprintf(fp,"{'name':'cInputs','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cInputs, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cInputs','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cInputs,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pInputs','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pInputs, sizeof(LPINPUT),cInputs);
 	else fprintf(fp,"{'name':'pInputs','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pInputs,sizeof(LPINPUT));
	if(pInputs){
		for(int i=0; i<cInputs;i++){
			fprintf(fp,"0x%x,",pInputs[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(int),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pSendInput(cInputs,pInputs,cbSize);
	fprintf(fp,"OUT ['SendInput',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pNotifyWinEvent) (DWORD event,HWND hwnd,LONG idObject,LONG idChild) = NotifyWinEvent;
VOID fake_NotifyWinEvent(DWORD event,HWND hwnd,LONG idObject,LONG idChild){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['NotifyWinEvent',");
	if(1) fprintf(fp,"{'name':'event','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",event, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'event','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",event,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idObject','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idObject, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'idObject','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idObject,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idChild','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idChild, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'idChild','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idChild,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pNotifyWinEvent(event,hwnd,idObject,idChild);
	fprintf(fp,"OUT ['NotifyWinEvent',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetWindowModuleFileNameW) (HWND hwnd,LPWSTR pszFileName,UINT cchFileNameMax) = GetWindowModuleFileNameW;
UINT fake_GetWindowModuleFileNameW(HWND hwnd,LPWSTR pszFileName,UINT cchFileNameMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowModuleFileNameW',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchFileNameMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchFileNameMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cchFileNameMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchFileNameMax,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetWindowModuleFileNameW(hwnd,pszFileName,cchFileNameMax);
	fprintf(fp,"OUT ['GetWindowModuleFileNameW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pszFileName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pszFileName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pszFileName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchFileNameMax, ret);
 	}else 
	{
		fprintf(fp,"{'name':'pszFileName',");
		fwprintf(fp, L"'value': %p, ", pszFileName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pszFileName){
		for(int i=0; i<cchFileNameMax <  ret ? cchFileNameMax :  ret;i++){
			fprintf(fp,"0x%x,",pszFileName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnableScrollBar) (HWND hWnd,UINT wSBflags,UINT wArrows) = EnableScrollBar;
BOOL fake_EnableScrollBar(HWND hWnd,UINT wSBflags,UINT wArrows){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnableScrollBar',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wSBflags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wSBflags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wSBflags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wSBflags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wArrows','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wArrows, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wArrows','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wArrows,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnableScrollBar(hWnd,wSBflags,wArrows);
	fprintf(fp,"OUT ['EnableScrollBar',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSendMessageCallbackW) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,SENDASYNCPROC lpResultCallBack,ULONG_PTR dwData) = SendMessageCallbackW;
BOOL fake_SendMessageCallbackW(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam,SENDASYNCPROC lpResultCallBack,ULONG_PTR dwData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendMessageCallbackW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpResultCallBack','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpResultCallBack, sizeof(SENDASYNCPROC),1);
 	else fprintf(fp,"{'name':'lpResultCallBack','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpResultCallBack,sizeof(SENDASYNCPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwData, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'dwData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwData,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSendMessageCallbackW(hWnd,Msg,wParam,lParam,lpResultCallBack,dwData);
	fprintf(fp,"OUT ['SendMessageCallbackW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pClientToScreen) (HWND hWnd,LPPOINT lpPoint) = ClientToScreen;
BOOL fake_ClientToScreen(HWND hWnd,LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ClientToScreen',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pClientToScreen(hWnd,lpPoint);
	fprintf(fp,"OUT ['ClientToScreen',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumThreadWindows) (DWORD dwThreadId,WNDENUMPROC lpfn,LPARAM lParam) = EnumThreadWindows;
BOOL fake_EnumThreadWindows(DWORD dwThreadId,WNDENUMPROC lpfn,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumThreadWindows',");
	if(1) fprintf(fp,"{'name':'dwThreadId','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwThreadId, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwThreadId','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwThreadId,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpfn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpfn, sizeof(WNDENUMPROC),1);
 	else fprintf(fp,"{'name':'lpfn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpfn,sizeof(WNDENUMPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumThreadWindows(dwThreadId,lpfn,lParam);
	fprintf(fp,"OUT ['EnumThreadWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pSetScrollPos) (HWND hWnd,int nBar,int nPos,BOOL bRedraw) = SetScrollPos;
int fake_SetScrollPos(HWND hWnd,int nBar,int nPos,BOOL bRedraw){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetScrollPos',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBar,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nPos, sizeof(int),1);
 	else fprintf(fp,"{'name':'nPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nPos,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bRedraw','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bRedraw, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bRedraw','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bRedraw,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pSetScrollPos(hWnd,nBar,nPos,bRedraw);
	fprintf(fp,"OUT ['SetScrollPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pGetWindowLongW) (HWND hWnd,int nIndex) = GetWindowLongW;
LONG fake_GetWindowLongW(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowLongW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pGetWindowLongW(hWnd,nIndex);
	fprintf(fp,"OUT ['GetWindowLongW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetWindowDisplayAffinity) (HWND hWnd,DWORD dwAffinity) = SetWindowDisplayAffinity;
BOOL fake_SetWindowDisplayAffinity(HWND hWnd,DWORD dwAffinity){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowDisplayAffinity',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwAffinity','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwAffinity, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwAffinity','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwAffinity,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetWindowDisplayAffinity(hWnd,dwAffinity);
	fprintf(fp,"OUT ['SetWindowDisplayAffinity',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pTranslateAcceleratorW) (HWND hWnd,HACCEL hAccTable,LPMSG lpMsg) = TranslateAcceleratorW;
int fake_TranslateAcceleratorW(HWND hWnd,HACCEL hAccTable,LPMSG lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TranslateAcceleratorW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hAccTable','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hAccTable, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'hAccTable','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hAccTable,sizeof(HACCEL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pTranslateAcceleratorW(hWnd,hAccTable,lpMsg);
	fprintf(fp,"OUT ['TranslateAcceleratorW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDlgDirListW) (HWND hDlg,LPWSTR lpPathSpec,int nIDListBox,int nIDStaticPath,UINT uFileType) = DlgDirListW;
int fake_DlgDirListW(HWND hDlg,LPWSTR lpPathSpec,int nIDListBox,int nIDStaticPath,UINT uFileType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirListW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpPathSpec);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpPathSpec);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpPathSpec);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDListBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDListBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDListBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDListBox,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDStaticPath, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDStaticPath,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFileType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFileType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFileType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFileType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDlgDirListW(hDlg,lpPathSpec,nIDListBox,nIDStaticPath,uFileType);
	fprintf(fp,"OUT ['DlgDirListW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpPathSpec);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpPathSpec);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpPathSpec);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

INT_PTR (WINAPI *pDialogBoxParamW) (HINSTANCE hInstance,LPCWSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = DialogBoxParamW;
INT_PTR fake_DialogBoxParamW(HINSTANCE hInstance,LPCWSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DialogBoxParamW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpTemplateName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpTemplateName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpTemplateName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpTemplateName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpTemplateName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	INT_PTR ret = pDialogBoxParamW(hInstance,lpTemplateName,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['DialogBoxParamW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(INT_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(INT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetClipboardOwner) () = GetClipboardOwner;
HWND fake_GetClipboardOwner(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipboardOwner',");
	fprintf(fp,"]\n");
	HWND ret = pGetClipboardOwner();
	fprintf(fp,"OUT ['GetClipboardOwner',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMessageBoxIndirectW) (CONST MSGBOXPARAMSW*  lpmbp) = MessageBoxIndirectW;
int fake_MessageBoxIndirectW(CONST MSGBOXPARAMSW*  lpmbp){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBoxIndirectW',");
	if(1) fprintf(fp,"{'name':' lpmbp','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpmbp, sizeof(CONST MSGBOXPARAMSW*),1);
 	else fprintf(fp,"{'name':' lpmbp','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpmbp,sizeof(CONST MSGBOXPARAMSW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMessageBoxIndirectW( lpmbp);
	fprintf(fp,"OUT ['MessageBoxIndirectW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pGetCursor) () = GetCursor;
HCURSOR fake_GetCursor(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetCursor',");
	fprintf(fp,"]\n");
	HCURSOR ret = pGetCursor();
	fprintf(fp,"OUT ['GetCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pSetClassLongA) (HWND hWnd,int nIndex,LONG dwNewLong) = SetClassLongA;
DWORD fake_SetClassLongA(HWND hWnd,int nIndex,LONG dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClassLongA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pSetClassLongA(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetClassLongA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMessageQueue) (int cMessagesMax) = SetMessageQueue;
BOOL fake_SetMessageQueue(int cMessagesMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMessageQueue',");
	if(1) fprintf(fp,"{'name':'cMessagesMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cMessagesMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cMessagesMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cMessagesMax,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMessageQueue(cMessagesMax);
	fprintf(fp,"OUT ['SetMessageQueue',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCharToOemBuffA) (LPCSTR lpszSrc,LPSTR lpszDst,DWORD cchDstLength) = CharToOemBuffA;
BOOL fake_CharToOemBuffA(LPCSTR lpszSrc,LPSTR lpszDst,DWORD cchDstLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharToOemBuffA',");
	if(1) fprintf(fp,"{'name':'lpszSrc','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszSrc, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszSrc','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszSrc,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchDstLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchDstLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchDstLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchDstLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCharToOemBuffA(lpszSrc,lpszDst,cchDstLength);
	fprintf(fp,"OUT ['CharToOemBuffA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDst, sizeof(LPSTR),cchDstLength);
 	else fprintf(fp,"{'name':'lpszDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDst,sizeof(LPSTR));
	if(lpszDst){
		for(int i=0; i<cchDstLength;i++){
			fprintf(fp,"0x%x,",lpszDst[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAdjustWindowRect) (LPRECT lpRect,DWORD dwStyle,BOOL bMenu) = AdjustWindowRect;
BOOL fake_AdjustWindowRect(LPRECT lpRect,DWORD dwStyle,BOOL bMenu){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AdjustWindowRect',");
	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bMenu, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bMenu,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAdjustWindowRect(lpRect,dwStyle,bMenu);
	fprintf(fp,"OUT ['AdjustWindowRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetMenuStringW) (HMENU hMenu,UINT uIDItem,LPWSTR lpString,int cchMax,UINT flags) = GetMenuStringW;
int fake_GetMenuStringW(HMENU hMenu,UINT uIDItem,LPWSTR lpString,int cchMax,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuStringW',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uIDItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDItem,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMax,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetMenuStringW(hMenu,uIDItem,lpString,cchMax,flags);
	fprintf(fp,"OUT ['GetMenuStringW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchMax);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpString){
		for(int i=0; i<cchMax;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ATOM (WINAPI *pRegisterClassW) (CONST WNDCLASSW* lpWndClass) = RegisterClassW;
ATOM fake_RegisterClassW(CONST WNDCLASSW* lpWndClass){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterClassW',");
	if(1) fprintf(fp,"{'name':'lpWndClass','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpWndClass, sizeof(CONST WNDCLASSW*),1);
 	else fprintf(fp,"{'name':'lpWndClass','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWndClass,sizeof(CONST WNDCLASSW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ATOM ret = pRegisterClassW(lpWndClass);
	fprintf(fp,"OUT ['RegisterClassW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ATOM),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ATOM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInsertMenuItemA) (HMENU hmenu,UINT item,BOOL fByPosition,LPCMENUITEMINFOA lpmi) = InsertMenuItemA;
BOOL fake_InsertMenuItemA(HMENU hmenu,UINT item,BOOL fByPosition,LPCMENUITEMINFOA lpmi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InsertMenuItemA',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'item','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",item, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'item','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",item,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPosition, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fByPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPosition,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmi, sizeof(LPCMENUITEMINFOA),1);
 	else fprintf(fp,"{'name':'lpmi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmi,sizeof(LPCMENUITEMINFOA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInsertMenuItemA(hmenu,item,fByPosition,lpmi);
	fprintf(fp,"OUT ['InsertMenuItemA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetWindowPlacement) (HWND hWnd,WINDOWPLACEMENT* lpwndpl) = GetWindowPlacement;
BOOL fake_GetWindowPlacement(HWND hWnd,WINDOWPLACEMENT* lpwndpl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowPlacement',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpwndpl','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpwndpl, sizeof(WINDOWPLACEMENT*),1);
 	else fprintf(fp,"{'name':'lpwndpl','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpwndpl,sizeof(WINDOWPLACEMENT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetWindowPlacement(hWnd,lpwndpl);
	fprintf(fp,"OUT ['GetWindowPlacement',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpwndpl','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpwndpl, sizeof(WINDOWPLACEMENT*),1);
 	else fprintf(fp,"{'name':'lpwndpl','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpwndpl,sizeof(WINDOWPLACEMENT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pSetWindowLongW) (HWND hWnd,int nIndex,LONG dwNewLong) = SetWindowLongW;
LONG fake_SetWindowLongW(HWND hWnd,int nIndex,LONG dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowLongW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pSetWindowLongW(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetWindowLongW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetPropW) (HWND hWnd,LPCWSTR lpString,HANDLE hData) = SetPropW;
BOOL fake_SetPropW(HWND hWnd,LPCWSTR lpString,HANDLE hData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetPropW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hData, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hData,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetPropW(hWnd,lpString,hData);
	fprintf(fp,"OUT ['SetPropW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pInternalGetWindowText) (HWND hWnd,LPWSTR pString,int cchMaxCount) = InternalGetWindowText;
int fake_InternalGetWindowText(HWND hWnd,LPWSTR pString,int cchMaxCount){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InternalGetWindowText',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMaxCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMaxCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMaxCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMaxCount,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pInternalGetWindowText(hWnd,pString,cchMaxCount);
	fprintf(fp,"OUT ['InternalGetWindowText',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchMaxCount, ret + 1);
 	}else 
	{
		fprintf(fp,"{'name':'pString',");
		fwprintf(fp, L"'value': %p, ", pString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pString){
		for(int i=0; i<cchMaxCount <  ret + 1 ? cchMaxCount :  ret + 1;i++){
			fprintf(fp,"0x%x,",pString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharAlphaNumericA) (CHAR ch) = IsCharAlphaNumericA;
BOOL fake_IsCharAlphaNumericA(CHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharAlphaNumericA',");
	if(1) fprintf(fp,"{'name':'ch','value': '\"%c\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ch, sizeof(CHAR),1);
 	else fprintf(fp,"{'name':'ch','value': '\"%c\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ch,sizeof(CHAR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharAlphaNumericA(ch);
	fprintf(fp,"OUT ['IsCharAlphaNumericA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShowWindowAsync) (HWND hWnd,int nCmdShow) = ShowWindowAsync;
BOOL fake_ShowWindowAsync(HWND hWnd,int nCmdShow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShowWindowAsync',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCmdShow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCmdShow, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCmdShow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCmdShow,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShowWindowAsync(hWnd,nCmdShow);
	fprintf(fp,"OUT ['ShowWindowAsync',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumWindowStationsA) (WINSTAENUMPROCA lpEnumFunc,LPARAM lParam) = EnumWindowStationsA;
BOOL fake_EnumWindowStationsA(WINSTAENUMPROCA lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumWindowStationsA',");
	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(WINSTAENUMPROCA),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(WINSTAENUMPROCA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumWindowStationsA(lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumWindowStationsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetUserObjectInformationW) (HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength,LPDWORD lpnLengthNeeded) = GetUserObjectInformationW;
BOOL fake_GetUserObjectInformationW(HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength,LPDWORD lpnLengthNeeded){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetUserObjectInformationW',");
	if(1) fprintf(fp,"{'name':'hObj','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hObj, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hObj','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hObj,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetUserObjectInformationW(hObj,nIndex,pvInfo,nLength,lpnLengthNeeded);
	fprintf(fp,"OUT ['GetUserObjectInformationW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvInfo, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvInfo,sizeof(PVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnLengthNeeded','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnLengthNeeded, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpnLengthNeeded','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnLengthNeeded,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pCallNextHookEx) (HHOOK hhk,int nCode,WPARAM wParam,LPARAM lParam) = CallNextHookEx;
LRESULT fake_CallNextHookEx(HHOOK hhk,int nCode,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CallNextHookEx',");
	if(1) fprintf(fp,"{'name':'hhk','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hhk, sizeof(HHOOK),1);
 	else fprintf(fp,"{'name':'hhk','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hhk,sizeof(HHOOK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCode, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCode,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pCallNextHookEx(hhk,nCode,wParam,lParam);
	fprintf(fp,"OUT ['CallNextHookEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pFrameRect) (HDC hDC,CONST RECT* lprc,HBRUSH hbr) = FrameRect;
int fake_FrameRect(HDC hDC,CONST RECT* lprc,HBRUSH hbr){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FrameRect',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hbr','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hbr, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'hbr','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hbr,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pFrameRect(hDC,lprc,hbr);
	fprintf(fp,"OUT ['FrameRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetPriorityClipboardFormat) (UINT* paFormatPriorityList,int cFormats) = GetPriorityClipboardFormat;
int fake_GetPriorityClipboardFormat(UINT* paFormatPriorityList,int cFormats){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetPriorityClipboardFormat',");
	if(1) fprintf(fp,"{'name':'paFormatPriorityList','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",paFormatPriorityList, sizeof(UINT*),cFormats);
 	else fprintf(fp,"{'name':'paFormatPriorityList','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",paFormatPriorityList,sizeof(UINT*));
	if(paFormatPriorityList){
		for(int i=0; i<cFormats;i++){
			fprintf(fp,"0x%x,",paFormatPriorityList[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cFormats','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cFormats, sizeof(int),1);
 	else fprintf(fp,"{'name':'cFormats','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cFormats,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetPriorityClipboardFormat(paFormatPriorityList,cFormats);
	fprintf(fp,"OUT ['GetPriorityClipboardFormat',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HOOKPROC (WINAPI *pSetWindowsHookW) (int nFilterType,HOOKPROC pfnFilterProc) = SetWindowsHookW;
HOOKPROC fake_SetWindowsHookW(int nFilterType,HOOKPROC pfnFilterProc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowsHookW',");
	if(1) fprintf(fp,"{'name':'nFilterType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nFilterType, sizeof(int),1);
 	else fprintf(fp,"{'name':'nFilterType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nFilterType,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pfnFilterProc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",pfnFilterProc, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'pfnFilterProc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pfnFilterProc,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HOOKPROC ret = pSetWindowsHookW(nFilterType,pfnFilterProc);
	fprintf(fp,"OUT ['SetWindowsHookW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenuItemInfoW) (HMENU hmenu,UINT item,BOOL fByPositon,LPCMENUITEMINFOW lpmii) = SetMenuItemInfoW;
BOOL fake_SetMenuItemInfoW(HMENU hmenu,UINT item,BOOL fByPositon,LPCMENUITEMINFOW lpmii){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenuItemInfoW',");
	if(1) fprintf(fp,"{'name':'hmenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hmenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'item','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",item, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'item','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",item,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPositon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPositon, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fByPositon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPositon,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmii, sizeof(LPCMENUITEMINFOW),1);
 	else fprintf(fp,"{'name':'lpmii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmii,sizeof(LPCMENUITEMINFOW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenuItemInfoW(hmenu,item,fByPositon,lpmii);
	fprintf(fp,"OUT ['SetMenuItemInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateDialogIndirectParamA) (HINSTANCE hInstance,LPCDLGTEMPLATEA lpTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = CreateDialogIndirectParamA;
HWND fake_CreateDialogIndirectParamA(HINSTANCE hInstance,LPCDLGTEMPLATEA lpTemplate,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDialogIndirectParamA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTemplate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpTemplate, sizeof(LPCDLGTEMPLATEA),1);
 	else fprintf(fp,"{'name':'lpTemplate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTemplate,sizeof(LPCDLGTEMPLATEA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateDialogIndirectParamA(hInstance,lpTemplate,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['CreateDialogIndirectParamA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRegisterRawInputDevices) (PCRAWINPUTDEVICE pRawInputDevices,UINT uiNumDevices,UINT cbSize) = RegisterRawInputDevices;
BOOL fake_RegisterRawInputDevices(PCRAWINPUTDEVICE pRawInputDevices,UINT uiNumDevices,UINT cbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterRawInputDevices',");
	if(1) fprintf(fp,"{'name':'pRawInputDevices','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pRawInputDevices, sizeof(PCRAWINPUTDEVICE),uiNumDevices);
 	else fprintf(fp,"{'name':'pRawInputDevices','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pRawInputDevices,sizeof(PCRAWINPUTDEVICE));
	if(pRawInputDevices){
		for(int i=0; i<uiNumDevices;i++){
			fprintf(fp,"0x%x,",pRawInputDevices[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiNumDevices','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiNumDevices, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiNumDevices','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiNumDevices,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRegisterRawInputDevices(pRawInputDevices,uiNumDevices,cbSize);
	fprintf(fp,"OUT ['RegisterRawInputDevices',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

WORD (WINAPI *pSetClassWord) (HWND hWnd,int nIndex,WORD wNewWord) = SetClassWord;
WORD fake_SetClassWord(HWND hWnd,int nIndex,WORD wNewWord){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClassWord',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wNewWord','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",wNewWord, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'wNewWord','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wNewWord,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	WORD ret = pSetClassWord(hWnd,nIndex,wNewWord);
	fprintf(fp,"OUT ['SetClassWord',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawAnimatedRects) (HWND hwnd,int idAni,CONST RECT* lprcFrom,CONST RECT* lprcTo) = DrawAnimatedRects;
BOOL fake_DrawAnimatedRects(HWND hwnd,int idAni,CONST RECT* lprcFrom,CONST RECT* lprcTo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawAnimatedRects',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idAni','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idAni, sizeof(int),1);
 	else fprintf(fp,"{'name':'idAni','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idAni,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcFrom','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcFrom, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcFrom','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcFrom,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcTo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcTo, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcTo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcTo,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawAnimatedRects(hwnd,idAni,lprcFrom,lprcTo);
	fprintf(fp,"OUT ['DrawAnimatedRects',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnregisterPowerSettingNotification) () = UnregisterPowerSettingNotification;
BOOL fake_UnregisterPowerSettingNotification(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnregisterPowerSettingNotification',");
	fprintf(fp,"]\n");
	BOOL ret = pUnregisterPowerSettingNotification();
	fprintf(fp,"OUT ['UnregisterPowerSettingNotification',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetClipboardViewer) () = GetClipboardViewer;
HWND fake_GetClipboardViewer(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipboardViewer',");
	fprintf(fp,"]\n");
	HWND ret = pGetClipboardViewer();
	fprintf(fp,"OUT ['GetClipboardViewer',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetClassLongW) (HWND hWnd,int nIndex) = GetClassLongW;
DWORD fake_GetClassLongW(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassLongW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetClassLongW(hWnd,nIndex);
	fprintf(fp,"OUT ['GetClassLongW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pShowCursor) (BOOL bShow) = ShowCursor;
int fake_ShowCursor(BOOL bShow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShowCursor',");
	if(1) fprintf(fp,"{'name':'bShow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bShow, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bShow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bShow,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pShowCursor(bShow);
	fprintf(fp,"OUT ['ShowCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMONITOR (WINAPI *pMonitorFromPoint) (POINT pt,DWORD dwFlags) = MonitorFromPoint;
HMONITOR fake_MonitorFromPoint(POINT pt,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MonitorFromPoint',");
	if(1) fprintf(fp,"{'name':'pt','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",pt, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'pt','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pt,sizeof(POINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMONITOR ret = pMonitorFromPoint(pt,dwFlags);
	fprintf(fp,"OUT ['MonitorFromPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMONITOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMONITOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDlgDirSelectComboBoxExW) (HWND hwndDlg,LPWSTR lpString,int cchOut,int idComboBox) = DlgDirSelectComboBoxExW;
BOOL fake_DlgDirSelectComboBoxExW(HWND hwndDlg,LPWSTR lpString,int cchOut,int idComboBox){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirSelectComboBoxExW',");
	if(1) fprintf(fp,"{'name':'hwndDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchOut','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchOut, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchOut','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchOut,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idComboBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idComboBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'idComboBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idComboBox,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDlgDirSelectComboBoxExW(hwndDlg,lpString,cchOut,idComboBox);
	fprintf(fp,"OUT ['DlgDirSelectComboBoxExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchOut);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpString){
		for(int i=0; i<cchOut;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCloseClipboard) () = CloseClipboard;
BOOL fake_CloseClipboard(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CloseClipboard',");
	fprintf(fp,"]\n");
	BOOL ret = pCloseClipboard();
	fprintf(fp,"OUT ['CloseClipboard',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplaySettingsExW) (LPCWSTR lpszDeviceName,DWORD iModeNum,DEVMODEW*  lpDevMode,DWORD dwFlags) = EnumDisplaySettingsExW;
BOOL fake_EnumDisplaySettingsExW(LPCWSTR lpszDeviceName,DWORD iModeNum,DEVMODEW*  lpDevMode,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplaySettingsExW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszDeviceName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDeviceName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDeviceName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDeviceName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDeviceName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iModeNum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iModeNum, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'iModeNum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iModeNum,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplaySettingsExW(lpszDeviceName,iModeNum, lpDevMode,dwFlags);
	fprintf(fp,"OUT ['EnumDisplaySettingsExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMenuBarInfo) (HWND hwnd,LONG idObject,LONG idItem,PMENUBARINFO pmbi) = GetMenuBarInfo;
BOOL fake_GetMenuBarInfo(HWND hwnd,LONG idObject,LONG idItem,PMENUBARINFO pmbi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuBarInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idObject','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idObject, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'idObject','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idObject,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idItem, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'idItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idItem,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pmbi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pmbi, sizeof(PMENUBARINFO),1);
 	else fprintf(fp,"{'name':'pmbi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pmbi,sizeof(PMENUBARINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMenuBarInfo(hwnd,idObject,idItem,pmbi);
	fprintf(fp,"OUT ['GetMenuBarInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pmbi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pmbi, sizeof(PMENUBARINFO),1);
 	else fprintf(fp,"{'name':'pmbi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pmbi,sizeof(PMENUBARINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pDisplayConfigGetDeviceInfo) (DISPLAYCONFIG_DEVICE_INFO_HEADER*  requestPacket) = DisplayConfigGetDeviceInfo;
LONG fake_DisplayConfigGetDeviceInfo(DISPLAYCONFIG_DEVICE_INFO_HEADER*  requestPacket){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DisplayConfigGetDeviceInfo',");
	if(1) fprintf(fp,"{'name':' requestPacket','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", requestPacket, sizeof(DISPLAYCONFIG_DEVICE_INFO_HEADER*),1);
 	else fprintf(fp,"{'name':' requestPacket','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", requestPacket,sizeof(DISPLAYCONFIG_DEVICE_INFO_HEADER*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pDisplayConfigGetDeviceInfo( requestPacket);
	fprintf(fp,"OUT ['DisplayConfigGetDeviceInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' requestPacket','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", requestPacket, sizeof(DISPLAYCONFIG_DEVICE_INFO_HEADER*),1);
 	else fprintf(fp,"{'name':' requestPacket','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", requestPacket,sizeof(DISPLAYCONFIG_DEVICE_INFO_HEADER*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pCreateDesktopW) (LPCWSTR lpszDesktop,LPCWSTR lpszDevice,DEVMODEW*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa) = CreateDesktopW;
HDESK fake_CreateDesktopW(LPCWSTR lpszDesktop,LPCWSTR lpszDevice,DEVMODEW*  pDevmode,DWORD dwFlags,ACCESS_MASK dwDesiredAccess,LPSECURITY_ATTRIBUTES lpsa){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDesktopW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszDesktop',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDesktop);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDesktop);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDesktop',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDesktop);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszDevice',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDevice);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDevice);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDevice',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDevice);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pDevmode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pDevmode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' pDevmode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pDevmode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsa','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsa, sizeof(LPSECURITY_ATTRIBUTES),1);
 	else fprintf(fp,"{'name':'lpsa','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsa,sizeof(LPSECURITY_ATTRIBUTES));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pCreateDesktopW(lpszDesktop,lpszDevice, pDevmode,dwFlags,dwDesiredAccess,lpsa);
	fprintf(fp,"OUT ['CreateDesktopW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenu) (HWND hWnd,HMENU hMenu) = SetMenu;
BOOL fake_SetMenu(HWND hWnd,HMENU hMenu){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenu',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenu(hWnd,hMenu);
	fprintf(fp,"OUT ['SetMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefFrameProcW) (HWND hWnd,HWND hWndMDIClient,UINT uMsg,WPARAM wParam,LPARAM lParam) = DefFrameProcW;
LRESULT fake_DefFrameProcW(HWND hWnd,HWND hWndMDIClient,UINT uMsg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefFrameProcW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndMDIClient','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndMDIClient, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndMDIClient','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndMDIClient,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMsg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMsg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMsg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMsg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefFrameProcW(hWnd,hWndMDIClient,uMsg,wParam,lParam);
	fprintf(fp,"OUT ['DefFrameProcW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

WORD (WINAPI *pSetWindowWord) (HWND hWnd,int nIndex,WORD wNewWord) = SetWindowWord;
WORD fake_SetWindowWord(HWND hWnd,int nIndex,WORD wNewWord){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowWord',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wNewWord','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",wNewWord, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'wNewWord','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wNewWord,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	WORD ret = pSetWindowWord(hWnd,nIndex,wNewWord);
	fprintf(fp,"OUT ['SetWindowWord',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetKeyboardLayoutNameW) (LPWSTR pwszKLID) = GetKeyboardLayoutNameW;
BOOL fake_GetKeyboardLayoutNameW(LPWSTR pwszKLID){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyboardLayoutNameW',");
	fprintf(fp,"]\n");
	BOOL ret = pGetKeyboardLayoutNameW(pwszKLID);
	fprintf(fp,"OUT ['GetKeyboardLayoutNameW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pwszKLID',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pwszKLID);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pwszKLID);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),KL_NAMELENGTH);
 	}else 
	{
		fprintf(fp,"{'name':'pwszKLID',");
		fwprintf(fp, L"'value': %p, ", pwszKLID);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pwszKLID){
		for(int i=0; i<KL_NAMELENGTH;i++){
			fprintf(fp,"0x%x,",pwszKLID[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCloseDesktop) (HDESK hDesktop) = CloseDesktop;
BOOL fake_CloseDesktop(HDESK hDesktop){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CloseDesktop',");
	if(1) fprintf(fp,"{'name':'hDesktop','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDesktop, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'hDesktop','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDesktop,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCloseDesktop(hDesktop);
	fprintf(fp,"OUT ['CloseDesktop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetProcessDefaultLayout) (DWORD dwDefaultLayout) = SetProcessDefaultLayout;
BOOL fake_SetProcessDefaultLayout(DWORD dwDefaultLayout){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetProcessDefaultLayout',");
	if(1) fprintf(fp,"{'name':'dwDefaultLayout','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDefaultLayout, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwDefaultLayout','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDefaultLayout,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetProcessDefaultLayout(dwDefaultLayout);
	fprintf(fp,"OUT ['SetProcessDefaultLayout',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

SHORT (WINAPI *pGetAsyncKeyState) (int vKey) = GetAsyncKeyState;
SHORT fake_GetAsyncKeyState(int vKey){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetAsyncKeyState',");
	if(1) fprintf(fp,"{'name':'vKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",vKey, sizeof(int),1);
 	else fprintf(fp,"{'name':'vKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",vKey,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	SHORT ret = pGetAsyncKeyState(vKey);
	fprintf(fp,"OUT ['GetAsyncKeyState',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(SHORT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(SHORT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharUpperW) (WCHAR ch) = IsCharUpperW;
BOOL fake_IsCharUpperW(WCHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharUpperW',");
	if(1)
	{
		fprintf(fp,"{'name':'ch',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%c\"',", ch);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%c\"',", ch);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(WCHAR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ch',");
		fwprintf(fp, L"'value': '\"%c\"', ", ch);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(WCHAR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharUpperW(ch);
	fprintf(fp,"OUT ['IsCharUpperW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharAlphaW) (WCHAR ch) = IsCharAlphaW;
BOOL fake_IsCharAlphaW(WCHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharAlphaW',");
	if(1)
	{
		fprintf(fp,"{'name':'ch',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%c\"',", ch);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%c\"',", ch);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(WCHAR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ch',");
		fwprintf(fp, L"'value': '\"%c\"', ", ch);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(WCHAR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharAlphaW(ch);
	fprintf(fp,"OUT ['IsCharAlphaW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplaySettingsExA) (LPCSTR lpszDeviceName,DWORD iModeNum,DEVMODEA*  lpDevMode,DWORD dwFlags) = EnumDisplaySettingsExA;
BOOL fake_EnumDisplaySettingsExA(LPCSTR lpszDeviceName,DWORD iModeNum,DEVMODEA*  lpDevMode,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplaySettingsExA',");
	if(1) fprintf(fp,"{'name':'lpszDeviceName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDeviceName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDeviceName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDeviceName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iModeNum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iModeNum, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'iModeNum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iModeNum,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplaySettingsExA(lpszDeviceName,iModeNum, lpDevMode,dwFlags);
	fprintf(fp,"OUT ['EnumDisplaySettingsExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPWSTR (WINAPI *pCharUpperW) (LPWSTR lpsz) = CharUpperW;
LPWSTR fake_CharUpperW(LPWSTR lpsz){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharUpperW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPWSTR ret = pCharUpperW(lpsz);
	fprintf(fp,"OUT ['CharUpperW',");
	if(1)
	{
		fprintf(fp,"{'name':'ret',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", ret);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", ret);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ret',");
		fwprintf(fp, L"'value': '\"%s\"', ", ret);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pTranslateMessage) (CONST MSG* lpMsg) = TranslateMessage;
BOOL fake_TranslateMessage(CONST MSG* lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TranslateMessage',");
	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(CONST MSG*),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(CONST MSG*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pTranslateMessage(lpMsg);
	fprintf(fp,"OUT ['TranslateMessage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pCreateIcon) (HINSTANCE hInstance,int nWidth,int nHeight,BYTE cPlanes,BYTE cBitsPixel,CONST BYTE* lpbANDbits,CONST BYTE* lpbXORbits) = CreateIcon;
HICON fake_CreateIcon(HINSTANCE hInstance,int nWidth,int nHeight,BYTE cPlanes,BYTE cBitsPixel,CONST BYTE* lpbANDbits,CONST BYTE* lpbXORbits){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateIcon',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cPlanes','value': 0x%hhx,'size' : 0x%lx,'cnt':0x%x, 'data':[",cPlanes, sizeof(BYTE),1);
 	else fprintf(fp,"{'name':'cPlanes','value': 0x%hhx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cPlanes,sizeof(BYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cBitsPixel','value': 0x%hhx,'size' : 0x%lx,'cnt':0x%x, 'data':[",cBitsPixel, sizeof(BYTE),1);
 	else fprintf(fp,"{'name':'cBitsPixel','value': 0x%hhx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cBitsPixel,sizeof(BYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpbANDbits','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpbANDbits, sizeof(CONST BYTE*),1);
 	else fprintf(fp,"{'name':'lpbANDbits','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpbANDbits,sizeof(CONST BYTE*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpbXORbits','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpbXORbits, sizeof(CONST BYTE*),1);
 	else fprintf(fp,"{'name':'lpbXORbits','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpbXORbits,sizeof(CONST BYTE*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pCreateIcon(hInstance,nWidth,nHeight,cPlanes,cBitsPixel,lpbANDbits,lpbXORbits);
	fprintf(fp,"OUT ['CreateIcon',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPSTR (WINAPI *pCharNextA) (LPCSTR lpsz) = CharNextA;
LPSTR fake_CharNextA(LPCSTR lpsz){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharNextA',");
	if(1) fprintf(fp,"{'name':'lpsz','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpsz','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPSTR ret = pCharNextA(lpsz);
	fprintf(fp,"OUT ['CharNextA',");
	if(1) fprintf(fp,"{'name':'ret','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'ret','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSendNotifyMessageW) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = SendNotifyMessageW;
BOOL fake_SendNotifyMessageW(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendNotifyMessageW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSendNotifyMessageW(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['SendNotifyMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pEnumPropsW) (HWND hWnd,PROPENUMPROCW lpEnumFunc) = EnumPropsW;
int fake_EnumPropsW(HWND hWnd,PROPENUMPROCW lpEnumFunc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumPropsW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(PROPENUMPROCW),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(PROPENUMPROCW));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pEnumPropsW(hWnd,lpEnumFunc);
	fprintf(fp,"OUT ['EnumPropsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetForegroundWindow) () = GetForegroundWindow;
HWND fake_GetForegroundWindow(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetForegroundWindow',");
	fprintf(fp,"]\n");
	HWND ret = pGetForegroundWindow();
	fprintf(fp,"OUT ['GetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMonitorInfoA) (HMONITOR hMonitor,LPMONITORINFO lpmi) = GetMonitorInfoA;
BOOL fake_GetMonitorInfoA(HMONITOR hMonitor,LPMONITORINFO lpmi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMonitorInfoA',");
	if(1) fprintf(fp,"{'name':'hMonitor','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMonitor, sizeof(HMONITOR),1);
 	else fprintf(fp,"{'name':'hMonitor','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMonitor,sizeof(HMONITOR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmi, sizeof(LPMONITORINFO),1);
 	else fprintf(fp,"{'name':'lpmi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmi,sizeof(LPMONITORINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMonitorInfoA(hMonitor,lpmi);
	fprintf(fp,"OUT ['GetMonitorInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpmi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpmi, sizeof(LPMONITORINFO),1);
 	else fprintf(fp,"{'name':'lpmi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpmi,sizeof(LPMONITORINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsGUIThread) (BOOL bConvert) = IsGUIThread;
BOOL fake_IsGUIThread(BOOL bConvert){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsGUIThread',");
	if(1) fprintf(fp,"{'name':'bConvert','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bConvert, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bConvert','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bConvert,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsGUIThread(bConvert);
	fprintf(fp,"OUT ['IsGUIThread',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPWSTR (WINAPI *pCharNextW) (LPCWSTR lpsz) = CharNextW;
LPWSTR fake_CharNextW(LPCWSTR lpsz){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharNextW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPWSTR ret = pCharNextW(lpsz);
	fprintf(fp,"OUT ['CharNextW',");
	if(1)
	{
		fprintf(fp,"{'name':'ret',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", ret);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", ret);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ret',");
		fwprintf(fp, L"'value': '\"%s\"', ", ret);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetLastActivePopup) (HWND hWnd) = GetLastActivePopup;
HWND fake_GetLastActivePopup(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetLastActivePopup',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetLastActivePopup(hWnd);
	fprintf(fp,"OUT ['GetLastActivePopup',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumChildWindows) (HWND hWndParent,WNDENUMPROC lpEnumFunc,LPARAM lParam) = EnumChildWindows;
BOOL fake_EnumChildWindows(HWND hWndParent,WNDENUMPROC lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumChildWindows',");
	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(WNDENUMPROC),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(WNDENUMPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumChildWindows(hWndParent,lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumChildWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pGetSystemMenu) (HWND hWnd,BOOL bRevert) = GetSystemMenu;
HMENU fake_GetSystemMenu(HWND hWnd,BOOL bRevert){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetSystemMenu',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bRevert','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bRevert, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bRevert','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bRevert,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pGetSystemMenu(hWnd,bRevert);
	fprintf(fp,"OUT ['GetSystemMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharAlphaNumericW) (WCHAR ch) = IsCharAlphaNumericW;
BOOL fake_IsCharAlphaNumericW(WCHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharAlphaNumericW',");
	if(1)
	{
		fprintf(fp,"{'name':'ch',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%c\"',", ch);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%c\"',", ch);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(WCHAR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ch',");
		fwprintf(fp, L"'value': '\"%c\"', ", ch);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(WCHAR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharAlphaNumericW(ch);
	fprintf(fp,"OUT ['IsCharAlphaNumericW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pRegisterShellHookWindow) (HWND hwnd) = RegisterShellHookWindow;
BOOL fake_RegisterShellHookWindow(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterShellHookWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pRegisterShellHookWindow(hwnd);
	fprintf(fp,"OUT ['RegisterShellHookWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOpenClipboard) (HWND hWndNewOwner) = OpenClipboard;
BOOL fake_OpenClipboard(HWND hWndNewOwner){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenClipboard',");
	if(1) fprintf(fp,"{'name':'hWndNewOwner','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndNewOwner, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndNewOwner','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndNewOwner,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOpenClipboard(hWndNewOwner);
	fprintf(fp,"OUT ['OpenClipboard',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pCopyAcceleratorTableA) (HACCEL hAccelSrc,LPACCEL lpAccelDst,int cAccelEntries) = CopyAcceleratorTableA;
int fake_CopyAcceleratorTableA(HACCEL hAccelSrc,LPACCEL lpAccelDst,int cAccelEntries){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CopyAcceleratorTableA',");
	if(1) fprintf(fp,"{'name':'hAccelSrc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hAccelSrc, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'hAccelSrc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hAccelSrc,sizeof(HACCEL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cAccelEntries','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cAccelEntries, sizeof(int),1);
 	else fprintf(fp,"{'name':'cAccelEntries','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cAccelEntries,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pCopyAcceleratorTableA(hAccelSrc,lpAccelDst,cAccelEntries);
	fprintf(fp,"OUT ['CopyAcceleratorTableA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpAccelDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpAccelDst, sizeof(LPACCEL),cAccelEntries, ret);
 	else fprintf(fp,"{'name':'lpAccelDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpAccelDst,sizeof(LPACCEL));
	if(lpAccelDst){
		for(int i=0; i<cAccelEntries <  ret ? cAccelEntries :  ret;i++){
			fprintf(fp,"0x%x,",lpAccelDst[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetGestureInfo) (HGESTUREINFO hGestureInfo,PGESTUREINFO pGestureInfo) = GetGestureInfo;
BOOL fake_GetGestureInfo(HGESTUREINFO hGestureInfo,PGESTUREINFO pGestureInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetGestureInfo',");
	if(1) fprintf(fp,"{'name':'hGestureInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hGestureInfo, sizeof(HGESTUREINFO),1);
 	else fprintf(fp,"{'name':'hGestureInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hGestureInfo,sizeof(HGESTUREINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetGestureInfo(hGestureInfo,pGestureInfo);
	fprintf(fp,"OUT ['GetGestureInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pGestureInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pGestureInfo, sizeof(PGESTUREINFO),1);
 	else fprintf(fp,"{'name':'pGestureInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pGestureInfo,sizeof(PGESTUREINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pCreateCursor) (HINSTANCE hInst,int xHotSpot,int yHotSpot,int nWidth,int nHeight,CONST VOID* pvANDPlane,CONST VOID* pvXORPlane) = CreateCursor;
HCURSOR fake_CreateCursor(HINSTANCE hInst,int xHotSpot,int yHotSpot,int nWidth,int nHeight,CONST VOID* pvANDPlane,CONST VOID* pvXORPlane){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateCursor',");
	if(1) fprintf(fp,"{'name':'hInst','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInst, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInst','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInst,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'xHotSpot','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",xHotSpot, sizeof(int),1);
 	else fprintf(fp,"{'name':'xHotSpot','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",xHotSpot,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'yHotSpot','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",yHotSpot, sizeof(int),1);
 	else fprintf(fp,"{'name':'yHotSpot','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",yHotSpot,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvANDPlane','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvANDPlane, sizeof(CONST VOID*),1);
 	else fprintf(fp,"{'name':'pvANDPlane','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvANDPlane,sizeof(CONST VOID*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvXORPlane','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvXORPlane, sizeof(CONST VOID*),1);
 	else fprintf(fp,"{'name':'pvXORPlane','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvXORPlane,sizeof(CONST VOID*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pCreateCursor(hInst,xHotSpot,yHotSpot,nWidth,nHeight,pvANDPlane,pvXORPlane);
	fprintf(fp,"OUT ['CreateCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetWindowInfo) (HWND hwnd,PWINDOWINFO pwi) = GetWindowInfo;
BOOL fake_GetWindowInfo(HWND hwnd,PWINDOWINFO pwi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pwi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pwi, sizeof(PWINDOWINFO),1);
 	else fprintf(fp,"{'name':'pwi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pwi,sizeof(PWINDOWINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetWindowInfo(hwnd,pwi);
	fprintf(fp,"OUT ['GetWindowInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pwi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pwi, sizeof(PWINDOWINFO),1);
 	else fprintf(fp,"{'name':'pwi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pwi,sizeof(PWINDOWINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOemToCharW) (LPCSTR pSrc,LPWSTR pDst) = OemToCharW;
BOOL fake_OemToCharW(LPCSTR pSrc,LPWSTR pDst){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OemToCharW',");
	if(1) fprintf(fp,"{'name':'pSrc','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pSrc, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'pSrc','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSrc,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOemToCharW(pSrc,pDst);
	fprintf(fp,"OUT ['OemToCharW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pDst',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", pDst);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", pDst);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'pDst',");
		fwprintf(fp, L"'value': '\"%s\"', ", pDst);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetWindowTextW) (HWND hWnd,LPWSTR lpString,int nMaxCount) = GetWindowTextW;
int fake_GetWindowTextW(HWND hWnd,LPWSTR lpString,int nMaxCount){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowTextW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nMaxCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nMaxCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'nMaxCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nMaxCount,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetWindowTextW(hWnd,lpString,nMaxCount);
	fprintf(fp,"OUT ['GetWindowTextW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),nMaxCount);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpString){
		for(int i=0; i<nMaxCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDrawTextExA) (HDC hdc,LPSTR lpchText,int cchText,LPRECT lprc,UINT format,LPDRAWTEXTPARAMS lpdtp) = DrawTextExA;
int fake_DrawTextExA(HDC hdc,LPSTR lpchText,int cchText,LPRECT lprc,UINT format,LPDRAWTEXTPARAMS lpdtp){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawTextExA',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpchText','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpchText, sizeof(LPSTR),cchText);
 	else fprintf(fp,"{'name':'lpchText','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpchText,sizeof(LPSTR));
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchText','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchText, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchText','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchText,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpdtp','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpdtp, sizeof(LPDRAWTEXTPARAMS),1);
 	else fprintf(fp,"{'name':'lpdtp','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpdtp,sizeof(LPDRAWTEXTPARAMS));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDrawTextExA(hdc,lpchText,cchText,lprc,format,lpdtp);
	fprintf(fp,"OUT ['DrawTextExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpchText','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpchText, sizeof(LPSTR),cchText);
 	else fprintf(fp,"{'name':'lpchText','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpchText,sizeof(LPSTR));
	if(lpchText){
		for(int i=0; i<cchText;i++){
			fprintf(fp,"0x%x,",lpchText[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDlgDirSelectExW) (HWND hwndDlg,LPWSTR lpString,int chCount,int idListBox) = DlgDirSelectExW;
BOOL fake_DlgDirSelectExW(HWND hwndDlg,LPWSTR lpString,int chCount,int idListBox){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirSelectExW',");
	if(1) fprintf(fp,"{'name':'hwndDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'chCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",chCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'chCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",chCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idListBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idListBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'idListBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idListBox,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDlgDirSelectExW(hwndDlg,lpString,chCount,idListBox);
	fprintf(fp,"OUT ['DlgDirSelectExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),chCount);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpString){
		for(int i=0; i<chCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT_PTR (WINAPI *pSetTimer) (HWND hWnd,UINT_PTR nIDEvent,UINT uElapse,TIMERPROC lpTimerFunc) = SetTimer;
UINT_PTR fake_SetTimer(HWND hWnd,UINT_PTR nIDEvent,UINT uElapse,TIMERPROC lpTimerFunc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetTimer',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDEvent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDEvent, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'nIDEvent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDEvent,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uElapse','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uElapse, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uElapse','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uElapse,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTimerFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpTimerFunc, sizeof(TIMERPROC),1);
 	else fprintf(fp,"{'name':'lpTimerFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTimerFunc,sizeof(TIMERPROC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT_PTR ret = pSetTimer(hWnd,nIDEvent,uElapse,lpTimerFunc);
	fprintf(fp,"OUT ['SetTimer',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pGetMenuCheckMarkDimensions) () = GetMenuCheckMarkDimensions;
LONG fake_GetMenuCheckMarkDimensions(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuCheckMarkDimensions',");
	fprintf(fp,"]\n");
	LONG ret = pGetMenuCheckMarkDimensions();
	fprintf(fp,"OUT ['GetMenuCheckMarkDimensions',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pPrivateExtractIconsA) (LPCSTR szFileName,int nIconIndex,int cxIcon,int cyIcon,HICON* phicon,UINT* piconid,UINT nIcons,UINT flags) = PrivateExtractIconsA;
UINT fake_PrivateExtractIconsA(LPCSTR szFileName,int nIconIndex,int cxIcon,int cyIcon,HICON* phicon,UINT* piconid,UINT nIcons,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PrivateExtractIconsA',");
	if(1) fprintf(fp,"{'name':'szFileName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",szFileName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'szFileName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",szFileName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIconIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIconIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIconIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIconIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cxIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cxIcon, sizeof(int),1);
 	else fprintf(fp,"{'name':'cxIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cxIcon,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cyIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cyIcon, sizeof(int),1);
 	else fprintf(fp,"{'name':'cyIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cyIcon,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIcons','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIcons, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'nIcons','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIcons,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pPrivateExtractIconsA(szFileName,nIconIndex,cxIcon,cyIcon,phicon,piconid,nIcons,flags);
	fprintf(fp,"OUT ['PrivateExtractIconsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'phicon','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",phicon, sizeof(HICON*),nIcons, ret);
 	else fprintf(fp,"{'name':'phicon','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",phicon,sizeof(HICON*));
	if(phicon){
		for(int i=0; i<nIcons <  ret ? nIcons :  ret;i++){
			fprintf(fp,"0x%x,",phicon[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconid','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconid, sizeof(UINT*),nIcons, ret);
 	else fprintf(fp,"{'name':'piconid','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconid,sizeof(UINT*));
	if(piconid){
		for(int i=0; i<nIcons <  ret ? nIcons :  ret;i++){
			fprintf(fp,"0x%x,",piconid[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharLowerW) (WCHAR ch) = IsCharLowerW;
BOOL fake_IsCharLowerW(WCHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharLowerW',");
	if(1)
	{
		fprintf(fp,"{'name':'ch',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%c\"',", ch);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%c\"',", ch);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(WCHAR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ch',");
		fwprintf(fp, L"'value': '\"%c\"', ", ch);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(WCHAR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharLowerW(ch);
	fprintf(fp,"OUT ['IsCharLowerW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAdjustWindowRectEx) (LPRECT lpRect,DWORD dwStyle,BOOL bMenu,DWORD dwExStyle) = AdjustWindowRectEx;
BOOL fake_AdjustWindowRectEx(LPRECT lpRect,DWORD dwStyle,BOOL bMenu,DWORD dwExStyle){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AdjustWindowRectEx',");
	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bMenu, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bMenu,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwExStyle','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwExStyle, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwExStyle','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwExStyle,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAdjustWindowRectEx(lpRect,dwStyle,bMenu,dwExStyle);
	fprintf(fp,"OUT ['AdjustWindowRectEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pkeybd_event) (BYTE bVk,BYTE bScan,DWORD dwFlags,ULONG_PTR dwExtraInfo) = keybd_event;
VOID fake_keybd_event(BYTE bVk,BYTE bScan,DWORD dwFlags,ULONG_PTR dwExtraInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['keybd_event',");
	if(1) fprintf(fp,"{'name':'bVk','value': 0x%hhx,'size' : 0x%lx,'cnt':0x%x, 'data':[",bVk, sizeof(BYTE),1);
 	else fprintf(fp,"{'name':'bVk','value': 0x%hhx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bVk,sizeof(BYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bScan','value': 0x%hhx,'size' : 0x%lx,'cnt':0x%x, 'data':[",bScan, sizeof(BYTE),1);
 	else fprintf(fp,"{'name':'bScan','value': 0x%hhx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bScan,sizeof(BYTE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwExtraInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwExtraInfo, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'dwExtraInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwExtraInfo,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pkeybd_event(bVk,bScan,dwFlags,dwExtraInfo);
	fprintf(fp,"OUT ['keybd_event',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsHungAppWindow) (HWND hwnd) = IsHungAppWindow;
BOOL fake_IsHungAppWindow(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsHungAppWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsHungAppWindow(hwnd);
	fprintf(fp,"OUT ['IsHungAppWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

SHORT (WINAPI *pVkKeyScanA) (CHAR ch) = VkKeyScanA;
SHORT fake_VkKeyScanA(CHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['VkKeyScanA',");
	if(1) fprintf(fp,"{'name':'ch','value': '\"%c\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ch, sizeof(CHAR),1);
 	else fprintf(fp,"{'name':'ch','value': '\"%c\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ch,sizeof(CHAR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	SHORT ret = pVkKeyScanA(ch);
	fprintf(fp,"OUT ['VkKeyScanA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(SHORT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(SHORT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pRealChildWindowFromPoint) (HWND hwndParent,POINT ptParentClientCoords) = RealChildWindowFromPoint;
HWND fake_RealChildWindowFromPoint(HWND hwndParent,POINT ptParentClientCoords){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RealChildWindowFromPoint',");
	if(1) fprintf(fp,"{'name':'hwndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'ptParentClientCoords','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ptParentClientCoords, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'ptParentClientCoords','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ptParentClientCoords,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pRealChildWindowFromPoint(hwndParent,ptParentClientCoords);
	fprintf(fp,"OUT ['RealChildWindowFromPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pWindowFromPhysicalPoint) (POINT Point) = WindowFromPhysicalPoint;
HWND fake_WindowFromPhysicalPoint(POINT Point){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WindowFromPhysicalPoint',");
	if(1) fprintf(fp,"{'name':'Point','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",Point, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'Point','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Point,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pWindowFromPhysicalPoint(Point);
	fprintf(fp,"OUT ['WindowFromPhysicalPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pOpenDesktopA) (LPCSTR lpszDesktop,DWORD dwFlags,BOOL fInherit,ACCESS_MASK dwDesiredAccess) = OpenDesktopA;
HDESK fake_OpenDesktopA(LPCSTR lpszDesktop,DWORD dwFlags,BOOL fInherit,ACCESS_MASK dwDesiredAccess){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenDesktopA',");
	if(1) fprintf(fp,"{'name':'lpszDesktop','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszDesktop, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszDesktop','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszDesktop,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fInherit','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fInherit, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fInherit','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fInherit,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pOpenDesktopA(lpszDesktop,dwFlags,fInherit,dwDesiredAccess);
	fprintf(fp,"OUT ['OpenDesktopA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG_PTR (WINAPI *pGetWindowLongPtrW) (HWND hWnd,int nIndex) = GetWindowLongPtrW;
LONG_PTR fake_GetWindowLongPtrW(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowLongPtrW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG_PTR ret = pGetWindowLongPtrW(hWnd,nIndex);
	fprintf(fp,"OUT ['GetWindowLongPtrW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEmptyClipboard) () = EmptyClipboard;
BOOL fake_EmptyClipboard(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EmptyClipboard',");
	fprintf(fp,"]\n");
	BOOL ret = pEmptyClipboard();
	fprintf(fp,"OUT ['EmptyClipboard',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetMenuContextHelpId) (HMENU arg0) = GetMenuContextHelpId;
DWORD fake_GetMenuContextHelpId(HMENU arg0){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuContextHelpId',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetMenuContextHelpId(arg0);
	fprintf(fp,"OUT ['GetMenuContextHelpId',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pEnumPropsExW) (HWND hWnd,PROPENUMPROCEXW lpEnumFunc,LPARAM lParam) = EnumPropsExW;
int fake_EnumPropsExW(HWND hWnd,PROPENUMPROCEXW lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumPropsExW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(PROPENUMPROCEXW),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(PROPENUMPROCEXW));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pEnumPropsExW(hWnd,lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumPropsExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInvalidateRgn) (HWND hWnd,HRGN hRgn,BOOL bErase) = InvalidateRgn;
BOOL fake_InvalidateRgn(HWND hWnd,HRGN hRgn,BOOL bErase){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InvalidateRgn',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hRgn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRgn, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hRgn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRgn,sizeof(HRGN));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bErase','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bErase, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bErase','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bErase,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInvalidateRgn(hWnd,hRgn,bErase);
	fprintf(fp,"OUT ['InvalidateRgn',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pTranslateAcceleratorA) (HWND hWnd,HACCEL hAccTable,LPMSG lpMsg) = TranslateAcceleratorA;
int fake_TranslateAcceleratorA(HWND hWnd,HACCEL hAccTable,LPMSG lpMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TranslateAcceleratorA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hAccTable','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hAccTable, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'hAccTable','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hAccTable,sizeof(HACCEL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pTranslateAcceleratorA(hWnd,hAccTable,lpMsg);
	fprintf(fp,"OUT ['TranslateAcceleratorA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pwvsprintfA) (LPSTR arg0,LPCSTR arg1,va_list arglist) = wvsprintfA;
int fake_wvsprintfA(LPSTR arg0,LPCSTR arg1,va_list arglist){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['wvsprintfA',");
	if(1) fprintf(fp,"{'name':'arg1','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'arg1','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arglist','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arglist, sizeof(va_list),1);
 	else fprintf(fp,"{'name':'arglist','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arglist,sizeof(va_list));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pwvsprintfA(arg0,arg1,arglist);
	fprintf(fp,"OUT ['wvsprintfA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg0','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'arg0','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefDlgProcA) (HWND hDlg,UINT Msg,WPARAM wParam,LPARAM lParam) = DefDlgProcA;
LRESULT fake_DefDlgProcA(HWND hDlg,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefDlgProcA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefDlgProcA(hDlg,Msg,wParam,lParam);
	fprintf(fp,"OUT ['DefDlgProcA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetTouchInputInfo) (HTOUCHINPUT hTouchInput) = GetTouchInputInfo;
BOOL fake_GetTouchInputInfo(HTOUCHINPUT hTouchInput){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetTouchInputInfo',");
	if(1) fprintf(fp,"{'name':'hTouchInput','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hTouchInput, sizeof(HTOUCHINPUT),1);
 	else fprintf(fp,"{'name':'hTouchInput','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hTouchInput,sizeof(HTOUCHINPUT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetTouchInputInfo(hTouchInput);
	fprintf(fp,"OUT ['GetTouchInputInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetPhysicalCursorPos) (LPPOINT lpPoint) = GetPhysicalCursorPos;
BOOL fake_GetPhysicalCursorPos(LPPOINT lpPoint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetPhysicalCursorPos',");
	fprintf(fp,"]\n");
	BOOL ret = pGetPhysicalCursorPos(lpPoint);
	fprintf(fp,"OUT ['GetPhysicalCursorPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPoint, sizeof(LPPOINT),1);
 	else fprintf(fp,"{'name':'lpPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPoint,sizeof(LPPOINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetDesktopWindow) () = GetDesktopWindow;
HWND fake_GetDesktopWindow(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDesktopWindow',");
	fprintf(fp,"]\n");
	HWND ret = pGetDesktopWindow();
	fprintf(fp,"OUT ['GetDesktopWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetScrollRange) (HWND hWnd,int nBar,LPINT lpMinPos,LPINT lpMaxPos) = GetScrollRange;
BOOL fake_GetScrollRange(HWND hWnd,int nBar,LPINT lpMinPos,LPINT lpMaxPos){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetScrollRange',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBar,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetScrollRange(hWnd,nBar,lpMinPos,lpMaxPos);
	fprintf(fp,"OUT ['GetScrollRange',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMinPos','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMinPos, sizeof(LPINT),1);
 	else fprintf(fp,"{'name':'lpMinPos','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMinPos,sizeof(LPINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMaxPos','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMaxPos, sizeof(LPINT),1);
 	else fprintf(fp,"{'name':'lpMaxPos','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMaxPos,sizeof(LPINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pDefFrameProcA) (HWND hWnd,HWND hWndMDIClient,UINT uMsg,WPARAM wParam,LPARAM lParam) = DefFrameProcA;
LRESULT fake_DefFrameProcA(HWND hWnd,HWND hWndMDIClient,UINT uMsg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DefFrameProcA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndMDIClient','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndMDIClient, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndMDIClient','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndMDIClient,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMsg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMsg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMsg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMsg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pDefFrameProcA(hWnd,hWndMDIClient,uMsg,wParam,lParam);
	fprintf(fp,"OUT ['DefFrameProcA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetKeyboardLayoutList) (int nBuff,HKL* lpList) = GetKeyboardLayoutList;
int fake_GetKeyboardLayoutList(int nBuff,HKL* lpList){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyboardLayoutList',");
	if(1) fprintf(fp,"{'name':'nBuff','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBuff, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBuff','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBuff,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetKeyboardLayoutList(nBuff,lpList);
	fprintf(fp,"OUT ['GetKeyboardLayoutList',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpList','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpList, sizeof(HKL*),nBuff, ret);
 	else fprintf(fp,"{'name':'lpList','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpList,sizeof(HKL*));
	if(lpList){
		for(int i=0; i<nBuff <  ret ? nBuff :  ret;i++){
			fprintf(fp,"0x%x,",lpList[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pDlgDirListComboBoxW) (HWND hDlg,LPWSTR lpPathSpec,int nIDComboBox,int nIDStaticPath,UINT uFiletype) = DlgDirListComboBoxW;
int fake_DlgDirListComboBoxW(HWND hDlg,LPWSTR lpPathSpec,int nIDComboBox,int nIDStaticPath,UINT uFiletype){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirListComboBoxW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpPathSpec);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpPathSpec);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpPathSpec);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDComboBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDComboBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDComboBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDComboBox,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDStaticPath, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDStaticPath','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDStaticPath,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFiletype','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFiletype, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFiletype','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFiletype,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pDlgDirListComboBoxW(hDlg,lpPathSpec,nIDComboBox,nIDStaticPath,uFiletype);
	fprintf(fp,"OUT ['DlgDirListComboBoxW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpPathSpec);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpPathSpec);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpPathSpec',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpPathSpec);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenuDefaultItem) (HMENU hMenu,UINT uItem,UINT fByPos) = SetMenuDefaultItem;
BOOL fake_SetMenuDefaultItem(HMENU hMenu,UINT uItem,UINT fByPos){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenuDefaultItem',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uItem,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPos, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fByPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPos,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenuDefaultItem(hMenu,uItem,fByPos);
	fprintf(fp,"OUT ['SetMenuDefaultItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsMenu) (HMENU hMenu) = IsMenu;
BOOL fake_IsMenu(HMENU hMenu){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsMenu',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsMenu(hMenu);
	fprintf(fp,"OUT ['IsMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAttachThreadInput) (DWORD idAttach,DWORD idAttachTo,BOOL fAttach) = AttachThreadInput;
BOOL fake_AttachThreadInput(DWORD idAttach,DWORD idAttachTo,BOOL fAttach){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AttachThreadInput',");
	if(1) fprintf(fp,"{'name':'idAttach','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idAttach, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idAttach','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idAttach,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idAttachTo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idAttachTo, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idAttachTo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idAttachTo,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fAttach','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fAttach, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fAttach','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fAttach,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAttachThreadInput(idAttach,idAttachTo,fAttach);
	fprintf(fp,"OUT ['AttachThreadInput',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pLoadImageA) (HINSTANCE hInst,LPCSTR name,UINT type,int cx,int cy,UINT fuLoad) = LoadImageA;
HANDLE fake_LoadImageA(HINSTANCE hInst,LPCSTR name,UINT type,int cx,int cy,UINT fuLoad){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadImageA',");
	if(1) fprintf(fp,"{'name':'hInst','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInst, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInst','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInst,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'name','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",name, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'name','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",name,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'type','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",type, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'type','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",type,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fuLoad','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fuLoad, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fuLoad','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fuLoad,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pLoadImageA(hInst,name,type,cx,cy,fuLoad);
	fprintf(fp,"OUT ['LoadImageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetTabbedTextExtentA) (HDC hdc,LPCSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions) = GetTabbedTextExtentA;
DWORD fake_GetTabbedTextExtentA(HDC hdc,LPCSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetTabbedTextExtentA',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),chCount);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	if(lpString){
		for(int i=0; i<chCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'chCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",chCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'chCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",chCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nTabPositions','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTabPositions, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTabPositions','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTabPositions,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnTabStopPositions','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnTabStopPositions, sizeof(CONST INT*),nTabPositions);
 	else fprintf(fp,"{'name':'lpnTabStopPositions','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnTabStopPositions,sizeof(CONST INT*));
	if(lpnTabStopPositions){
		for(int i=0; i<nTabPositions;i++){
			fprintf(fp,"0x%x,",lpnTabStopPositions[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetTabbedTextExtentA(hdc,lpString,chCount,nTabPositions,lpnTabStopPositions);
	fprintf(fp,"OUT ['GetTabbedTextExtentA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGrayStringW) (HDC hDC,HBRUSH hBrush,GRAYSTRINGPROC lpOutputFunc,LPARAM lpData,int nCount,int X,int Y,int nWidth,int nHeight) = GrayStringW;
BOOL fake_GrayStringW(HDC hDC,HBRUSH hBrush,GRAYSTRINGPROC lpOutputFunc,LPARAM lpData,int nCount,int X,int Y,int nWidth,int nHeight){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GrayStringW',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hBrush','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hBrush, sizeof(HBRUSH),1);
 	else fprintf(fp,"{'name':'hBrush','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hBrush,sizeof(HBRUSH));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpOutputFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpOutputFunc, sizeof(GRAYSTRINGPROC),1);
 	else fprintf(fp,"{'name':'lpOutputFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpOutputFunc,sizeof(GRAYSTRINGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpData, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lpData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpData,sizeof(LPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGrayStringW(hDC,hBrush,lpOutputFunc,lpData,nCount,X,Y,nWidth,nHeight);
	fprintf(fp,"OUT ['GrayStringW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetWindowTextA) (HWND hWnd,LPCSTR lpString) = SetWindowTextA;
BOOL fake_SetWindowTextA(HWND hWnd,LPCSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowTextA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpString','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetWindowTextA(hWnd,lpString);
	fprintf(fp,"OUT ['SetWindowTextA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDC (WINAPI *pGetWindowDC) (HWND hWnd) = GetWindowDC;
HDC fake_GetWindowDC(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowDC',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDC ret = pGetWindowDC(hWnd);
	fprintf(fp,"OUT ['GetWindowDC',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCheckRadioButton) (HWND hDlg,int nIDFirstButton,int nIDLastButton,int nIDCheckButton) = CheckRadioButton;
BOOL fake_CheckRadioButton(HWND hDlg,int nIDFirstButton,int nIDLastButton,int nIDCheckButton){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CheckRadioButton',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDFirstButton','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDFirstButton, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDFirstButton','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDFirstButton,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDLastButton','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDLastButton, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDLastButton','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDLastButton,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDCheckButton','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDCheckButton, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDCheckButton','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDCheckButton,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCheckRadioButton(hDlg,nIDFirstButton,nIDLastButton,nIDCheckButton);
	fprintf(fp,"OUT ['CheckRadioButton',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOemToCharA) (LPCSTR pSrc,LPSTR pDst) = OemToCharA;
BOOL fake_OemToCharA(LPCSTR pSrc,LPSTR pDst){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OemToCharA',");
	if(1) fprintf(fp,"{'name':'pSrc','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pSrc, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'pSrc','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pSrc,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOemToCharA(pSrc,pDst);
	fprintf(fp,"OUT ['OemToCharA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pDst','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",pDst, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'pDst','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",pDst,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

WORD (WINAPI *pCascadeWindows) (HWND hwndParent,UINT wHow,CONST RECT*  lpRect,UINT cKids,CONST HWND*  lpKids) = CascadeWindows;
WORD fake_CascadeWindows(HWND hwndParent,UINT wHow,CONST RECT*  lpRect,UINT cKids,CONST HWND*  lpKids){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CascadeWindows',");
	if(1) fprintf(fp,"{'name':'hwndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wHow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wHow, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wHow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wHow,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':' lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cKids','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cKids, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cKids','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cKids,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpKids','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpKids, sizeof(CONST HWND*),cKids);
 	else fprintf(fp,"{'name':' lpKids','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpKids,sizeof(CONST HWND*));
	if( lpKids){
		for(int i=0; i<cKids;i++){
			fprintf(fp,"0x%x,", lpKids[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	WORD ret = pCascadeWindows(hwndParent,wHow, lpRect,cKids, lpKids);
	fprintf(fp,"OUT ['CascadeWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pFindWindowW) (LPCWSTR lpClassName,LPCWSTR lpWindowName) = FindWindowW;
HWND fake_FindWindowW(LPCWSTR lpClassName,LPCWSTR lpWindowName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['FindWindowW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpClassName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpWindowName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpWindowName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpWindowName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpWindowName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpWindowName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pFindWindowW(lpClassName,lpWindowName);
	fprintf(fp,"OUT ['FindWindowW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetListBoxInfo) (HWND hwnd) = GetListBoxInfo;
DWORD fake_GetListBoxInfo(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetListBoxInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetListBoxInfo(hwnd);
	fprintf(fp,"OUT ['GetListBoxInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pSetActiveWindow) (HWND hWnd) = SetActiveWindow;
HWND fake_SetActiveWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetActiveWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pSetActiveWindow(hWnd);
	fprintf(fp,"OUT ['SetActiveWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEndPaint) (HWND hWnd,CONST PAINTSTRUCT* lpPaint) = EndPaint;
BOOL fake_EndPaint(HWND hWnd,CONST PAINTSTRUCT* lpPaint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EndPaint',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPaint','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPaint, sizeof(CONST PAINTSTRUCT*),1);
 	else fprintf(fp,"{'name':'lpPaint','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPaint,sizeof(CONST PAINTSTRUCT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEndPaint(hWnd,lpPaint);
	fprintf(fp,"OUT ['EndPaint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnableWindow) (HWND hWnd,BOOL bEnable) = EnableWindow;
BOOL fake_EnableWindow(HWND hWnd,BOOL bEnable){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnableWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bEnable','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bEnable, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bEnable','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bEnable,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnableWindow(hWnd,bEnable);
	fprintf(fp,"OUT ['EnableWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetLastInputInfo) (PLASTINPUTINFO plii) = GetLastInputInfo;
BOOL fake_GetLastInputInfo(PLASTINPUTINFO plii){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetLastInputInfo',");
	fprintf(fp,"]\n");
	BOOL ret = pGetLastInputInfo(plii);
	fprintf(fp,"OUT ['GetLastInputInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'plii','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",plii, sizeof(PLASTINPUTINFO),1);
 	else fprintf(fp,"{'name':'plii','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",plii,sizeof(PLASTINPUTINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetDlgItemInt) (HWND hDlg,int nIDDlgItem,BOOL* lpTranslated,BOOL bSigned) = GetDlgItemInt;
UINT fake_GetDlgItemInt(HWND hDlg,int nIDDlgItem,BOOL* lpTranslated,BOOL bSigned){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDlgItemInt',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bSigned','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bSigned, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bSigned','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bSigned,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetDlgItemInt(hDlg,nIDDlgItem,lpTranslated,bSigned);
	fprintf(fp,"OUT ['GetDlgItemInt',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpTranslated','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpTranslated, sizeof(BOOL*),1);
 	else fprintf(fp,"{'name':'lpTranslated','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpTranslated,sizeof(BOOL*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetClassInfoA) (HINSTANCE hInstance,LPCSTR lpClassName,LPWNDCLASSA lpWndClass) = GetClassInfoA;
BOOL fake_GetClassInfoA(HINSTANCE hInstance,LPCSTR lpClassName,LPWNDCLASSA lpWndClass){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassInfoA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpClassName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpClassName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpClassName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClassName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetClassInfoA(hInstance,lpClassName,lpWndClass);
	fprintf(fp,"OUT ['GetClassInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpWndClass','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpWndClass, sizeof(LPWNDCLASSA),1);
 	else fprintf(fp,"{'name':'lpWndClass','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpWndClass,sizeof(LPWNDCLASSA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetUserObjectInformationA) (HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength,LPDWORD lpnLengthNeeded) = GetUserObjectInformationA;
BOOL fake_GetUserObjectInformationA(HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength,LPDWORD lpnLengthNeeded){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetUserObjectInformationA',");
	if(1) fprintf(fp,"{'name':'hObj','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hObj, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hObj','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hObj,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetUserObjectInformationA(hObj,nIndex,pvInfo,nLength,lpnLengthNeeded);
	fprintf(fp,"OUT ['GetUserObjectInformationA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvInfo, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvInfo,sizeof(PVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnLengthNeeded','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnLengthNeeded, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpnLengthNeeded','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnLengthNeeded,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pGetDisplayConfigBufferSizes) (UINT32 flags,UINT32*  numPathArrayElements,UINT32*  numModeInfoArrayElements) = GetDisplayConfigBufferSizes;
LONG fake_GetDisplayConfigBufferSizes(UINT32 flags,UINT32*  numPathArrayElements,UINT32*  numModeInfoArrayElements){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDisplayConfigBufferSizes',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT32),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT32));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pGetDisplayConfigBufferSizes(flags, numPathArrayElements, numModeInfoArrayElements);
	fprintf(fp,"OUT ['GetDisplayConfigBufferSizes',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' numPathArrayElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", numPathArrayElements, sizeof(UINT32*),1);
 	else fprintf(fp,"{'name':' numPathArrayElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", numPathArrayElements,sizeof(UINT32*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' numModeInfoArrayElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", numModeInfoArrayElements, sizeof(UINT32*),1);
 	else fprintf(fp,"{'name':' numModeInfoArrayElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", numModeInfoArrayElements,sizeof(UINT32*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pLoadStringW) (HINSTANCE hInstance,UINT uID,LPWSTR lpBuffer,int cchBufferMax) = LoadStringW;
int fake_LoadStringW(HINSTANCE hInstance,UINT uID,LPWSTR lpBuffer,int cchBufferMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadStringW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uID','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uID, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uID','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uID,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchBufferMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchBufferMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchBufferMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchBufferMax,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pLoadStringW(hInstance,uID,lpBuffer,cchBufferMax);
	fprintf(fp,"OUT ['LoadStringW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpBuffer',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpBuffer);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpBuffer);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchBufferMax, ret + 1);
 	}else 
	{
		fprintf(fp,"{'name':'lpBuffer',");
		fwprintf(fp, L"'value': %p, ", lpBuffer);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpBuffer){
		for(int i=0; i<cchBufferMax <  ret + 1 ? cchBufferMax :  ret + 1;i++){
			fprintf(fp,"0x%x,",lpBuffer[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDestroyCaret) () = DestroyCaret;
BOOL fake_DestroyCaret(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DestroyCaret',");
	fprintf(fp,"]\n");
	BOOL ret = pDestroyCaret();
	fprintf(fp,"OUT ['DestroyCaret',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMessageA) (LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax) = GetMessageA;
BOOL fake_GetMessageA(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMessageA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMin, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMin,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMax,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMessageA(lpMsg,hWnd,wMsgFilterMin,wMsgFilterMax);
	fprintf(fp,"OUT ['GetMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnregisterTouchWindow) (HWND hwnd) = UnregisterTouchWindow;
BOOL fake_UnregisterTouchWindow(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnregisterTouchWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnregisterTouchWindow(hwnd);
	fprintf(fp,"OUT ['UnregisterTouchWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUpdateWindow) (HWND hWnd) = UpdateWindow;
BOOL fake_UpdateWindow(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UpdateWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUpdateWindow(hWnd);
	fprintf(fp,"OUT ['UpdateWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pOffsetRect) (LPRECT lprc,int dx,int dy) = OffsetRect;
BOOL fake_OffsetRect(LPRECT lprc,int dx,int dy){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OffsetRect',");
	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dx, sizeof(int),1);
 	else fprintf(fp,"{'name':'dx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dy, sizeof(int),1);
 	else fprintf(fp,"{'name':'dy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dy,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pOffsetRect(lprc,dx,dy);
	fprintf(fp,"OUT ['OffsetRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetClipboardFormatNameA) (UINT format,LPSTR lpszFormatName,int cchMaxCount) = GetClipboardFormatNameA;
int fake_GetClipboardFormatNameA(UINT format,LPSTR lpszFormatName,int cchMaxCount){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClipboardFormatNameA',");
	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMaxCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMaxCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMaxCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMaxCount,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetClipboardFormatNameA(format,lpszFormatName,cchMaxCount);
	fprintf(fp,"OUT ['GetClipboardFormatNameA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszFormatName','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpszFormatName, sizeof(LPSTR),cchMaxCount);
 	else fprintf(fp,"{'name':'lpszFormatName','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszFormatName,sizeof(LPSTR));
	if(lpszFormatName){
		for(int i=0; i<cchMaxCount;i++){
			fprintf(fp,"0x%x,",lpszFormatName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

long (WINAPI *pBroadcastSystemMessageExW) (DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam,PBSMINFO pbsmInfo) = BroadcastSystemMessageExW;
long fake_BroadcastSystemMessageExW(DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam,PBSMINFO pbsmInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BroadcastSystemMessageExW',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	long ret = pBroadcastSystemMessageExW(flags,lpInfo,Msg,wParam,lParam,pbsmInfo);
	fprintf(fp,"OUT ['BroadcastSystemMessageExW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(long),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(long));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pbsmInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pbsmInfo, sizeof(PBSMINFO),1);
 	else fprintf(fp,"{'name':'pbsmInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pbsmInfo,sizeof(PBSMINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnregisterDeviceNotification) () = UnregisterDeviceNotification;
BOOL fake_UnregisterDeviceNotification(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnregisterDeviceNotification',");
	fprintf(fp,"]\n");
	BOOL ret = pUnregisterDeviceNotification();
	fprintf(fp,"OUT ['UnregisterDeviceNotification',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pBlockInput) (BOOL fBlockIt) = BlockInput;
BOOL fake_BlockInput(BOOL fBlockIt){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BlockInput',");
	if(1) fprintf(fp,"{'name':'fBlockIt','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fBlockIt, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fBlockIt','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fBlockIt,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pBlockInput(fBlockIt);
	fprintf(fp,"OUT ['BlockInput',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetKeyNameTextW) (LONG lParam,LPWSTR lpString,int cchSize) = GetKeyNameTextW;
int fake_GetKeyNameTextW(LONG lParam,LPWSTR lpString,int cchSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyNameTextW',");
	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchSize, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchSize,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetKeyNameTextW(lParam,lpString,cchSize);
	fprintf(fp,"OUT ['GetKeyNameTextW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchSize);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpString){
		for(int i=0; i<cchSize;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pCreateDialogParamW) (HINSTANCE hInstance,LPCWSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam) = CreateDialogParamW;
HWND fake_CreateDialogParamW(HINSTANCE hInstance,LPCWSTR lpTemplateName,HWND hWndParent,DLGPROC lpDialogFunc,LPARAM dwInitParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateDialogParamW',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpTemplateName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpTemplateName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpTemplateName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpTemplateName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpTemplateName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDialogFunc, sizeof(DLGPROC),1);
 	else fprintf(fp,"{'name':'lpDialogFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDialogFunc,sizeof(DLGPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwInitParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwInitParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwInitParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwInitParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pCreateDialogParamW(hInstance,lpTemplateName,hWndParent,lpDialogFunc,dwInitParam);
	fprintf(fp,"OUT ['CreateDialogParamW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetRawInputData) (HRAWINPUT hRawInput,UINT uiCommand,LPVOID pData,PUINT pcbSize,UINT cbSizeHeader) = GetRawInputData;
UINT fake_GetRawInputData(HRAWINPUT hRawInput,UINT uiCommand,LPVOID pData,PUINT pcbSize,UINT cbSizeHeader){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetRawInputData',");
	if(1) fprintf(fp,"{'name':'hRawInput','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRawInput, sizeof(HRAWINPUT),1);
 	else fprintf(fp,"{'name':'hRawInput','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRawInput,sizeof(HRAWINPUT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uiCommand','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uiCommand, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uiCommand','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uiCommand,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSizeHeader','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSizeHeader, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSizeHeader','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSizeHeader,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetRawInputData(hRawInput,uiCommand,pData,pcbSize,cbSizeHeader);
	fprintf(fp,"OUT ['GetRawInputData',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pData','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pData, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'pData','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pData,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pcbSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pcbSize, sizeof(PUINT),1);
 	else fprintf(fp,"{'name':'pcbSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pcbSize,sizeof(PUINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pLoadMenuIndirectW) (CONST MENUTEMPLATEW* lpMenuTemplate) = LoadMenuIndirectW;
HMENU fake_LoadMenuIndirectW(CONST MENUTEMPLATEW* lpMenuTemplate){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadMenuIndirectW',");
	if(1) fprintf(fp,"{'name':'lpMenuTemplate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMenuTemplate, sizeof(CONST MENUTEMPLATEW*),1);
 	else fprintf(fp,"{'name':'lpMenuTemplate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMenuTemplate,sizeof(CONST MENUTEMPLATEW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pLoadMenuIndirectW(lpMenuTemplate);
	fprintf(fp,"OUT ['LoadMenuIndirectW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pRegisterWindowMessageA) (LPCSTR lpString) = RegisterWindowMessageA;
UINT fake_RegisterWindowMessageA(LPCSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterWindowMessageA',");
	if(1) fprintf(fp,"{'name':'lpString','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpString','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pRegisterWindowMessageA(lpString);
	fprintf(fp,"OUT ['RegisterWindowMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pBringWindowToTop) (HWND hWnd) = BringWindowToTop;
BOOL fake_BringWindowToTop(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BringWindowToTop',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pBringWindowToTop(hWnd);
	fprintf(fp,"OUT ['BringWindowToTop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetDlgItemTextW) (HWND hDlg,int nIDDlgItem,LPWSTR lpString,int cchMax) = GetDlgItemTextW;
UINT fake_GetDlgItemTextW(HWND hDlg,int nIDDlgItem,LPWSTR lpString,int cchMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetDlgItemTextW',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchMax, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchMax,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetDlgItemTextW(hDlg,nIDDlgItem,lpString,cchMax);
	fprintf(fp,"OUT ['GetDlgItemTextW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchMax);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpString){
		for(int i=0; i<cchMax;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pTrackPopupMenuEx) (HMENU arg0,UINT arg1,int arg2,int arg3,HWND arg4,LPTPMPARAMS arg5) = TrackPopupMenuEx;
BOOL fake_TrackPopupMenuEx(HMENU arg0,UINT arg1,int arg2,int arg3,HWND arg4,LPTPMPARAMS arg5){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TrackPopupMenuEx',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'arg1','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg2','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg2, sizeof(int),1);
 	else fprintf(fp,"{'name':'arg2','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg2,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg3','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg3, sizeof(int),1);
 	else fprintf(fp,"{'name':'arg3','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg3,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg4','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg4, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'arg4','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg4,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg5','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg5, sizeof(LPTPMPARAMS),1);
 	else fprintf(fp,"{'name':'arg5','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg5,sizeof(LPTPMPARAMS));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pTrackPopupMenuEx(arg0,arg1,arg2,arg3,arg4,arg5);
	fprintf(fp,"OUT ['TrackPopupMenuEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMessageBoxExA) (HWND hWnd,LPCSTR lpText,LPCSTR lpCaption,UINT uType,WORD wLanguageId) = MessageBoxExA;
int fake_MessageBoxExA(HWND hWnd,LPCSTR lpText,LPCSTR lpCaption,UINT uType,WORD wLanguageId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBoxExA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpText','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpText, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpText','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpText,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpCaption','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpCaption, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpCaption','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpCaption,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uType,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wLanguageId','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",wLanguageId, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'wLanguageId','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wLanguageId,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMessageBoxExA(hWnd,lpText,lpCaption,uType,wLanguageId);
	fprintf(fp,"OUT ['MessageBoxExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pGetPropW) (HWND hWnd,LPCWSTR lpString) = GetPropW;
HANDLE fake_GetPropW(HWND hWnd,LPCWSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetPropW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pGetPropW(hWnd,lpString);
	fprintf(fp,"OUT ['GetPropW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplaySettingsW) (LPCWSTR lpszDeviceName,DWORD iModeNum,DEVMODEW*  lpDevMode) = EnumDisplaySettingsW;
BOOL fake_EnumDisplaySettingsW(LPCWSTR lpszDeviceName,DWORD iModeNum,DEVMODEW*  lpDevMode){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplaySettingsW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszDeviceName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDeviceName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDeviceName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDeviceName',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDeviceName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iModeNum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iModeNum, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'iModeNum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iModeNum,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplaySettingsW(lpszDeviceName,iModeNum, lpDevMode);
	fprintf(fp,"OUT ['EnumDisplaySettingsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

WORD (WINAPI *pGetClassWord) (HWND hWnd,int nIndex) = GetClassWord;
WORD fake_GetClassWord(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassWord',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	WORD ret = pGetClassWord(hWnd,nIndex);
	fprintf(fp,"OUT ['GetClassWord',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPostMessageA) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = PostMessageA;
BOOL fake_PostMessageA(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PostMessageA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPostMessageA(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['PostMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetDlgItemTextA) (HWND hDlg,int nIDDlgItem,LPCSTR lpString) = SetDlgItemTextA;
BOOL fake_SetDlgItemTextA(HWND hDlg,int nIDDlgItem,LPCSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetDlgItemTextA',");
	if(1) fprintf(fp,"{'name':'hDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIDDlgItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIDDlgItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIDDlgItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpString','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetDlgItemTextA(hDlg,nIDDlgItem,lpString);
	fprintf(fp,"OUT ['SetDlgItemTextA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pMessageBoxW) (HWND hWnd,LPCWSTR lpText,LPCWSTR lpCaption,UINT uType) = MessageBoxW;
int fake_MessageBoxW(HWND hWnd,LPCWSTR lpText,LPCWSTR lpCaption,UINT uType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MessageBoxW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpText',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpCaption',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpCaption);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpCaption);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpCaption',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpCaption);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pMessageBoxW(hWnd,lpText,lpCaption,uType);
	fprintf(fp,"OUT ['MessageBoxW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pCreatePopupMenu) () = CreatePopupMenu;
HMENU fake_CreatePopupMenu(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreatePopupMenu',");
	fprintf(fp,"]\n");
	HMENU ret = pCreatePopupMenu();
	fprintf(fp,"OUT ['CreatePopupMenu',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pReleaseDC) (HWND hWnd,HDC hDC) = ReleaseDC;
int fake_ReleaseDC(HWND hWnd,HDC hDC){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ReleaseDC',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pReleaseDC(hWnd,hDC);
	fprintf(fp,"OUT ['ReleaseDC',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pmouse_event) (DWORD dwFlags,DWORD dx,DWORD dy,DWORD dwData,ULONG_PTR dwExtraInfo) = mouse_event;
VOID fake_mouse_event(DWORD dwFlags,DWORD dx,DWORD dy,DWORD dwData,ULONG_PTR dwExtraInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['mouse_event',");
	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dx, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dx,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dy, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dy,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwData, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwData,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwExtraInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwExtraInfo, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'dwExtraInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwExtraInfo,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pmouse_event(dwFlags,dx,dy,dwData,dwExtraInfo);
	fprintf(fp,"OUT ['mouse_event',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetRect) (LPRECT lprc,int xLeft,int yTop,int xRight,int yBottom) = SetRect;
BOOL fake_SetRect(LPRECT lprc,int xLeft,int yTop,int xRight,int yBottom){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetRect',");
	if(1) fprintf(fp,"{'name':'xLeft','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",xLeft, sizeof(int),1);
 	else fprintf(fp,"{'name':'xLeft','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",xLeft,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'yTop','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",yTop, sizeof(int),1);
 	else fprintf(fp,"{'name':'yTop','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",yTop,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'xRight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",xRight, sizeof(int),1);
 	else fprintf(fp,"{'name':'xRight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",xRight,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'yBottom','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",yBottom, sizeof(int),1);
 	else fprintf(fp,"{'name':'yBottom','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",yBottom,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetRect(lprc,xLeft,yTop,xRight,yBottom);
	fprintf(fp,"OUT ['SetRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HBITMAP (WINAPI *pLoadBitmapA) (HINSTANCE hInstance,LPCSTR lpBitmapName) = LoadBitmapA;
HBITMAP fake_LoadBitmapA(HINSTANCE hInstance,LPCSTR lpBitmapName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadBitmapA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpBitmapName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpBitmapName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpBitmapName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpBitmapName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HBITMAP ret = pLoadBitmapA(hInstance,lpBitmapName);
	fprintf(fp,"OUT ['LoadBitmapA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HBITMAP),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HBITMAP));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPSTR (WINAPI *pCharPrevA) (LPCSTR lpszStart,LPCSTR lpszCurrent) = CharPrevA;
LPSTR fake_CharPrevA(LPCSTR lpszStart,LPCSTR lpszCurrent){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharPrevA',");
	if(1) fprintf(fp,"{'name':'lpszStart','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszStart, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszStart','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszStart,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpszCurrent','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpszCurrent, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpszCurrent','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpszCurrent,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPSTR ret = pCharPrevA(lpszStart,lpszCurrent);
	fprintf(fp,"OUT ['CharPrevA',");
	if(1) fprintf(fp,"{'name':'ret','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'ret','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetClassNameW) (HWND hWnd,LPWSTR lpClassName) = GetClassNameW;
int fake_GetClassNameW(HWND hWnd,LPWSTR lpClassName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassNameW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetClassNameW(hWnd,lpClassName);
	fprintf(fp,"OUT ['GetClassNameW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpClassName',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpClassName);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpClassName);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),nMaxCount, ret);
 	}else 
	{
		fprintf(fp,"{'name':'lpClassName',");
		fwprintf(fp, L"'value': %p, ", lpClassName);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpClassName){
		for(int i=0; i<nMaxCount <  ret ? nMaxCount :  ret;i++){
			fprintf(fp,"0x%x,",lpClassName[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetKeyboardLayoutNameA) (LPSTR pwszKLID) = GetKeyboardLayoutNameA;
BOOL fake_GetKeyboardLayoutNameA(LPSTR pwszKLID){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyboardLayoutNameA',");
	fprintf(fp,"]\n");
	BOOL ret = pGetKeyboardLayoutNameA(pwszKLID);
	fprintf(fp,"OUT ['GetKeyboardLayoutNameA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pwszKLID','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pwszKLID, sizeof(LPSTR),KL_NAMELENGTH);
 	else fprintf(fp,"{'name':'pwszKLID','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pwszKLID,sizeof(LPSTR));
	if(pwszKLID){
		for(int i=0; i<KL_NAMELENGTH;i++){
			fprintf(fp,"0x%x,",pwszKLID[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetWindowTextW) (HWND hWnd,LPCWSTR lpString) = SetWindowTextW;
BOOL fake_SetWindowTextW(HWND hWnd,LPCWSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowTextW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetWindowTextW(hWnd,lpString);
	fprintf(fp,"OUT ['SetWindowTextW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetClientRect) (HWND hWnd,LPRECT lpRect) = GetClientRect;
BOOL fake_GetClientRect(HWND hWnd,LPRECT lpRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClientRect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetClientRect(hWnd,lpRect);
	fprintf(fp,"OUT ['GetClientRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetMenuDefaultItem) (HMENU hMenu,UINT fByPos,UINT gmdiFlags) = GetMenuDefaultItem;
UINT fake_GetMenuDefaultItem(HMENU hMenu,UINT fByPos,UINT gmdiFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMenuDefaultItem',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fByPos','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fByPos, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'fByPos','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fByPos,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'gmdiFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",gmdiFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'gmdiFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",gmdiFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pGetMenuDefaultItem(hMenu,fByPos,gmdiFlags);
	fprintf(fp,"OUT ['GetMenuDefaultItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUpdateLayeredWindowIndirect) (HWND hWnd,CONST UPDATELAYEREDWINDOWINFO*  pULWInfo) = UpdateLayeredWindowIndirect;
BOOL fake_UpdateLayeredWindowIndirect(HWND hWnd,CONST UPDATELAYEREDWINDOWINFO*  pULWInfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UpdateLayeredWindowIndirect',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pULWInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pULWInfo, sizeof(CONST UPDATELAYEREDWINDOWINFO*),1);
 	else fprintf(fp,"{'name':' pULWInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pULWInfo,sizeof(CONST UPDATELAYEREDWINDOWINFO*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUpdateLayeredWindowIndirect(hWnd, pULWInfo);
	fprintf(fp,"OUT ['UpdateLayeredWindowIndirect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pChangeDisplaySettingsA) (DEVMODEA*  lpDevMode,DWORD dwFlags) = ChangeDisplaySettingsA;
LONG fake_ChangeDisplaySettingsA(DEVMODEA*  lpDevMode,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeDisplaySettingsA',");
	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEA*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEA*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pChangeDisplaySettingsA( lpDevMode,dwFlags);
	fprintf(fp,"OUT ['ChangeDisplaySettingsA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pWinHelpW) (HWND hWndMain,LPCWSTR lpszHelp,UINT uCommand,ULONG_PTR dwData) = WinHelpW;
BOOL fake_WinHelpW(HWND hWndMain,LPCWSTR lpszHelp,UINT uCommand,ULONG_PTR dwData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['WinHelpW',");
	if(1) fprintf(fp,"{'name':'hWndMain','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndMain, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndMain','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndMain,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszHelp',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszHelp);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszHelp);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszHelp',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszHelp);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uCommand','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCommand, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCommand','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCommand,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwData, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'dwData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwData,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pWinHelpW(hWndMain,lpszHelp,uCommand,dwData);
	fprintf(fp,"OUT ['WinHelpW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HACCEL (WINAPI *pCreateAcceleratorTableW) (LPACCEL paccel,int cAccel) = CreateAcceleratorTableW;
HACCEL fake_CreateAcceleratorTableW(LPACCEL paccel,int cAccel){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateAcceleratorTableW',");
	if(1) fprintf(fp,"{'name':'paccel','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",paccel, sizeof(LPACCEL),cAccel);
 	else fprintf(fp,"{'name':'paccel','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",paccel,sizeof(LPACCEL));
	if(paccel){
		for(int i=0; i<cAccel;i++){
			fprintf(fp,"0x%x,",paccel[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cAccel','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cAccel, sizeof(int),1);
 	else fprintf(fp,"{'name':'cAccel','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cAccel,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HACCEL ret = pCreateAcceleratorTableW(paccel,cAccel);
	fprintf(fp,"OUT ['CreateAcceleratorTableW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HACCEL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetMessageW) (LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax) = GetMessageW;
BOOL fake_GetMessageW(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMessageW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMin, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMin,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMax,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetMessageW(lpMsg,hWnd,wMsgFilterMin,wMsgFilterMax);
	fprintf(fp,"OUT ['GetMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pSetCapture) (HWND hWnd) = SetCapture;
HWND fake_SetCapture(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetCapture',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pSetCapture(hWnd);
	fprintf(fp,"OUT ['SetCapture',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsProcessDPIAware) () = IsProcessDPIAware;
BOOL fake_IsProcessDPIAware(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsProcessDPIAware',");
	fprintf(fp,"]\n");
	BOOL ret = pIsProcessDPIAware();
	fprintf(fp,"OUT ['IsProcessDPIAware',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIntersectRect) (LPRECT lprcDst,CONST RECT* lprcSrc1,CONST RECT* lprcSrc2) = IntersectRect;
BOOL fake_IntersectRect(LPRECT lprcDst,CONST RECT* lprcSrc1,CONST RECT* lprcSrc2){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IntersectRect',");
	if(1) fprintf(fp,"{'name':'lprcSrc1','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc1, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc1','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc1,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcSrc2','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc2, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc2','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc2,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIntersectRect(lprcDst,lprcSrc1,lprcSrc2);
	fprintf(fp,"OUT ['IntersectRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcDst, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprcDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcDst,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetCursorInfo) (PCURSORINFO pci) = GetCursorInfo;
BOOL fake_GetCursorInfo(PCURSORINFO pci){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetCursorInfo',");
	if(1) fprintf(fp,"{'name':'pci','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pci, sizeof(PCURSORINFO),1);
 	else fprintf(fp,"{'name':'pci','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pci,sizeof(PCURSORINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetCursorInfo(pci);
	fprintf(fp,"OUT ['GetCursorInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pci','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pci, sizeof(PCURSORINFO),1);
 	else fprintf(fp,"{'name':'pci','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pci,sizeof(PCURSORINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pSetWindowLongA) (HWND hWnd,int nIndex,LONG dwNewLong) = SetWindowLongA;
LONG fake_SetWindowLongA(HWND hWnd,int nIndex,LONG dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowLongA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pSetWindowLongA(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetWindowLongA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSwitchDesktop) (HDESK hDesktop) = SwitchDesktop;
BOOL fake_SwitchDesktop(HDESK hDesktop){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SwitchDesktop',");
	if(1) fprintf(fp,"{'name':'hDesktop','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDesktop, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'hDesktop','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDesktop,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSwitchDesktop(hDesktop);
	fprintf(fp,"OUT ['SwitchDesktop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HANDLE (WINAPI *pRemovePropW) (HWND hWnd,LPCWSTR lpString) = RemovePropW;
HANDLE fake_RemovePropW(HWND hWnd,LPCWSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RemovePropW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HANDLE ret = pRemovePropW(hWnd,lpString);
	fprintf(fp,"OUT ['RemovePropW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HANDLE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDWP (WINAPI *pDeferWindowPos) (HDWP hWinPosInfo,HWND hWnd,HWND hWndInsertAfter,int x,int y,int cx,int cy,UINT uFlags) = DeferWindowPos;
HDWP fake_DeferWindowPos(HDWP hWinPosInfo,HWND hWnd,HWND hWndInsertAfter,int x,int y,int cx,int cy,UINT uFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DeferWindowPos',");
	if(1) fprintf(fp,"{'name':'hWinPosInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWinPosInfo, sizeof(HDWP),1);
 	else fprintf(fp,"{'name':'hWinPosInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWinPosInfo,sizeof(HDWP));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndInsertAfter','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndInsertAfter, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndInsertAfter','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndInsertAfter,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'x','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",x, sizeof(int),1);
 	else fprintf(fp,"{'name':'x','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",x,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",y, sizeof(int),1);
 	else fprintf(fp,"{'name':'y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cx, sizeof(int),1);
 	else fprintf(fp,"{'name':'cx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cy, sizeof(int),1);
 	else fprintf(fp,"{'name':'cy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cy,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDWP ret = pDeferWindowPos(hWinPosInfo,hWnd,hWndInsertAfter,x,y,cx,cy,uFlags);
	fprintf(fp,"OUT ['DeferWindowPos',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDWP),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDWP));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pGetThreadDesktop) (DWORD dwThreadId) = GetThreadDesktop;
HDESK fake_GetThreadDesktop(DWORD dwThreadId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetThreadDesktop',");
	if(1) fprintf(fp,"{'name':'dwThreadId','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwThreadId, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwThreadId','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwThreadId,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pGetThreadDesktop(dwThreadId);
	fprintf(fp,"OUT ['GetThreadDesktop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenuContextHelpId) (HMENU arg0,DWORD arg1) = SetMenuContextHelpId;
BOOL fake_SetMenuContextHelpId(HMENU arg0,DWORD arg1){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenuContextHelpId',");
	if(1) fprintf(fp,"{'name':'arg0','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'arg0','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg1','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'arg1','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenuContextHelpId(arg0,arg1);
	fprintf(fp,"OUT ['SetMenuContextHelpId',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPSTR (WINAPI *pCharNextExA) (WORD CodePage,LPCSTR lpCurrentChar,DWORD dwFlags) = CharNextExA;
LPSTR fake_CharNextExA(WORD CodePage,LPCSTR lpCurrentChar,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharNextExA',");
	if(1) fprintf(fp,"{'name':'CodePage','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",CodePage, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'CodePage','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",CodePage,sizeof(WORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpCurrentChar','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpCurrentChar, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpCurrentChar','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpCurrentChar,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPSTR ret = pCharNextExA(CodePage,lpCurrentChar,dwFlags);
	fprintf(fp,"OUT ['CharNextExA',");
	if(1) fprintf(fp,"{'name':'ret','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'ret','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pGetKBCodePage) () = GetKBCodePage;
UINT fake_GetKBCodePage(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKBCodePage',");
	fprintf(fp,"]\n");
	UINT ret = pGetKBCodePage();
	fprintf(fp,"OUT ['GetKBCodePage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ULONG_PTR (WINAPI *pSetClassLongPtrW) (HWND hWnd,int nIndex,LONG_PTR dwNewLong) = SetClassLongPtrW;
ULONG_PTR fake_SetClassLongPtrW(HWND hWnd,int nIndex,LONG_PTR dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClassLongPtrW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ULONG_PTR ret = pSetClassLongPtrW(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetClassLongPtrW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetClassLongA) (HWND hWnd,int nIndex) = GetClassLongA;
DWORD fake_GetClassLongA(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassLongA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetClassLongA(hWnd,nIndex);
	fprintf(fp,"OUT ['GetClassLongA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDEVNOTIFY (WINAPI *pRegisterDeviceNotificationA) (HANDLE hRecipient,LPVOID NotificationFilter,DWORD Flags) = RegisterDeviceNotificationA;
HDEVNOTIFY fake_RegisterDeviceNotificationA(HANDLE hRecipient,LPVOID NotificationFilter,DWORD Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterDeviceNotificationA',");
	if(1) fprintf(fp,"{'name':'hRecipient','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRecipient, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hRecipient','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRecipient,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'NotificationFilter','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",NotificationFilter, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'NotificationFilter','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",NotificationFilter,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDEVNOTIFY ret = pRegisterDeviceNotificationA(hRecipient,NotificationFilter,Flags);
	fprintf(fp,"OUT ['RegisterDeviceNotificationA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDEVNOTIFY),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDEVNOTIFY));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPWSTR (WINAPI *pCharPrevW) (LPCWSTR lpszStart,LPCWSTR lpszCurrent) = CharPrevW;
LPWSTR fake_CharPrevW(LPCWSTR lpszStart,LPCWSTR lpszCurrent){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharPrevW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszStart',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszStart);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszStart);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszStart',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszStart);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszCurrent',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszCurrent);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszCurrent);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszCurrent',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszCurrent);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPWSTR ret = pCharPrevW(lpszStart,lpszCurrent);
	fprintf(fp,"OUT ['CharPrevW',");
	if(1)
	{
		fprintf(fp,"{'name':'ret',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", ret);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", ret);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'ret',");
		fwprintf(fp, L"'value': '\"%s\"', ", ret);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetParent) (HWND hWnd) = GetParent;
HWND fake_GetParent(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetParent',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pGetParent(hWnd);
	fprintf(fp,"OUT ['GetParent',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

long (WINAPI *pBroadcastSystemMessage) (DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam) = BroadcastSystemMessage;
long fake_BroadcastSystemMessage(DWORD flags,LPDWORD lpInfo,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BroadcastSystemMessage',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	long ret = pBroadcastSystemMessage(flags,lpInfo,Msg,wParam,lParam);
	fprintf(fp,"OUT ['BroadcastSystemMessage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(long),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(long));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpInfo, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpInfo,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pMapVirtualKeyA) (UINT uCode,UINT uMapType) = MapVirtualKeyA;
UINT fake_MapVirtualKeyA(UINT uCode,UINT uMapType){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MapVirtualKeyA',");
	if(1) fprintf(fp,"{'name':'uCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uMapType','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMapType, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMapType','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMapType,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pMapVirtualKeyA(uCode,uMapType);
	fprintf(fp,"OUT ['MapVirtualKeyA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsIconic) (HWND hWnd) = IsIconic;
BOOL fake_IsIconic(HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsIconic',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsIconic(hWnd);
	fprintf(fp,"OUT ['IsIconic',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pCopyAcceleratorTableW) (HACCEL hAccelSrc,LPACCEL lpAccelDst,int cAccelEntries) = CopyAcceleratorTableW;
int fake_CopyAcceleratorTableW(HACCEL hAccelSrc,LPACCEL lpAccelDst,int cAccelEntries){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CopyAcceleratorTableW',");
	if(1) fprintf(fp,"{'name':'hAccelSrc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hAccelSrc, sizeof(HACCEL),1);
 	else fprintf(fp,"{'name':'hAccelSrc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hAccelSrc,sizeof(HACCEL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cAccelEntries','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cAccelEntries, sizeof(int),1);
 	else fprintf(fp,"{'name':'cAccelEntries','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cAccelEntries,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pCopyAcceleratorTableW(hAccelSrc,lpAccelDst,cAccelEntries);
	fprintf(fp,"OUT ['CopyAcceleratorTableW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpAccelDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpAccelDst, sizeof(LPACCEL),cAccelEntries, ret);
 	else fprintf(fp,"{'name':'lpAccelDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpAccelDst,sizeof(LPACCEL));
	if(lpAccelDst){
		for(int i=0; i<cAccelEntries <  ret ? cAccelEntries :  ret;i++){
			fprintf(fp,"0x%x,",lpAccelDst[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCreateCaret) (HWND hWnd,HBITMAP hBitmap,int nWidth,int nHeight) = CreateCaret;
BOOL fake_CreateCaret(HWND hWnd,HBITMAP hBitmap,int nWidth,int nHeight){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CreateCaret',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hBitmap','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hBitmap, sizeof(HBITMAP),1);
 	else fprintf(fp,"{'name':'hBitmap','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hBitmap,sizeof(HBITMAP));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nWidth','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nWidth, sizeof(int),1);
 	else fprintf(fp,"{'name':'nWidth','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nWidth,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nHeight','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nHeight, sizeof(int),1);
 	else fprintf(fp,"{'name':'nHeight','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nHeight,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCreateCaret(hWnd,hBitmap,nWidth,nHeight);
	fprintf(fp,"OUT ['CreateCaret',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsChild) (HWND hWndParent,HWND hWnd) = IsChild;
BOOL fake_IsChild(HWND hWndParent,HWND hWnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsChild',");
	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsChild(hWndParent,hWnd);
	fprintf(fp,"OUT ['IsChild',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

WORD (WINAPI *pTileWindows) (HWND hwndParent,UINT wHow,CONST RECT*  lpRect,UINT cKids,CONST HWND*  lpKids) = TileWindows;
WORD fake_TileWindows(HWND hwndParent,UINT wHow,CONST RECT*  lpRect,UINT cKids,CONST HWND*  lpKids){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['TileWindows',");
	if(1) fprintf(fp,"{'name':'hwndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wHow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wHow, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wHow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wHow,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':' lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cKids','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cKids, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cKids','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cKids,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' lpKids','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpKids, sizeof(CONST HWND*),cKids);
 	else fprintf(fp,"{'name':' lpKids','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpKids,sizeof(CONST HWND*));
	if( lpKids){
		for(int i=0; i<cKids;i++){
			fprintf(fp,"0x%x,", lpKids[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	WORD ret = pTileWindows(hwndParent,wHow, lpRect,cKids, lpKids);
	fprintf(fp,"OUT ['TileWindows',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPeekMessageW) (LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax,UINT wRemoveMsg) = PeekMessageW;
BOOL fake_PeekMessageW(LPMSG lpMsg,HWND hWnd,UINT wMsgFilterMin,UINT wMsgFilterMax,UINT wRemoveMsg){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PeekMessageW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMin, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMin,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wMsgFilterMax, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wMsgFilterMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wMsgFilterMax,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wRemoveMsg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wRemoveMsg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'wRemoveMsg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wRemoveMsg,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPeekMessageW(lpMsg,hWnd,wMsgFilterMin,wMsgFilterMax,wRemoveMsg);
	fprintf(fp,"OUT ['PeekMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpMsg','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMsg, sizeof(LPMSG),1);
 	else fprintf(fp,"{'name':'lpMsg','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMsg,sizeof(LPMSG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetScrollInfo) (HWND hwnd,int nBar,LPSCROLLINFO lpsi) = GetScrollInfo;
BOOL fake_GetScrollInfo(HWND hwnd,int nBar,LPSCROLLINFO lpsi){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetScrollInfo',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'nBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nBar,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsi, sizeof(LPSCROLLINFO),1);
 	else fprintf(fp,"{'name':'lpsi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsi,sizeof(LPSCROLLINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetScrollInfo(hwnd,nBar,lpsi);
	fprintf(fp,"OUT ['GetScrollInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsi','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsi, sizeof(LPSCROLLINFO),1);
 	else fprintf(fp,"{'name':'lpsi','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsi,sizeof(LPSCROLLINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAnyPopup) () = AnyPopup;
BOOL fake_AnyPopup(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AnyPopup',");
	fprintf(fp,"]\n");
	BOOL ret = pAnyPopup();
	fprintf(fp,"OUT ['AnyPopup',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAddClipboardFormatListener) (HWND hwnd) = AddClipboardFormatListener;
BOOL fake_AddClipboardFormatListener(HWND hwnd){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AddClipboardFormatListener',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAddClipboardFormatListener(hwnd);
	fprintf(fp,"OUT ['AddClipboardFormatListener',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pChangeDisplaySettingsW) (DEVMODEW*  lpDevMode,DWORD dwFlags) = ChangeDisplaySettingsW;
LONG fake_ChangeDisplaySettingsW(DEVMODEW*  lpDevMode,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeDisplaySettingsW',");
	if(1) fprintf(fp,"{'name':' lpDevMode','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", lpDevMode, sizeof(DEVMODEW*),1);
 	else fprintf(fp,"{'name':' lpDevMode','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", lpDevMode,sizeof(DEVMODEW*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pChangeDisplaySettingsW( lpDevMode,dwFlags);
	fprintf(fp,"OUT ['ChangeDisplaySettingsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pCheckMenuItem) (HMENU hMenu,UINT uIDCheckItem,UINT uCheck) = CheckMenuItem;
DWORD fake_CheckMenuItem(HMENU hMenu,UINT uIDCheckItem,UINT uCheck){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CheckMenuItem',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDCheckItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDCheckItem, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uIDCheckItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDCheckItem,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uCheck','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uCheck, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uCheck','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uCheck,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pCheckMenuItem(hMenu,uIDCheckItem,uCheck);
	fprintf(fp,"OUT ['CheckMenuItem',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWINEVENTHOOK (WINAPI *pSetWinEventHook) (DWORD eventMin,DWORD eventMax,HMODULE hmodWinEventProc,WINEVENTPROC pfnWinEventProc,DWORD idProcess,DWORD idThread,DWORD dwFlags) = SetWinEventHook;
HWINEVENTHOOK fake_SetWinEventHook(DWORD eventMin,DWORD eventMax,HMODULE hmodWinEventProc,WINEVENTPROC pfnWinEventProc,DWORD idProcess,DWORD idThread,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWinEventHook',");
	if(1) fprintf(fp,"{'name':'eventMin','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",eventMin, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'eventMin','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",eventMin,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'eventMax','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",eventMax, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'eventMax','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",eventMax,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hmodWinEventProc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hmodWinEventProc, sizeof(HMODULE),1);
 	else fprintf(fp,"{'name':'hmodWinEventProc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hmodWinEventProc,sizeof(HMODULE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pfnWinEventProc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",pfnWinEventProc, sizeof(WINEVENTPROC),1);
 	else fprintf(fp,"{'name':'pfnWinEventProc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pfnWinEventProc,sizeof(WINEVENTPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idProcess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idProcess, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idProcess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idProcess,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idThread','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idThread, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idThread','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idThread,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWINEVENTHOOK ret = pSetWinEventHook(eventMin,eventMax,hmodWinEventProc,pfnWinEventProc,idProcess,idThread,dwFlags);
	fprintf(fp,"OUT ['SetWinEventHook',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWINEVENTHOOK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWINEVENTHOOK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPARAM (WINAPI *pGetMessageExtraInfo) () = GetMessageExtraInfo;
LPARAM fake_GetMessageExtraInfo(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetMessageExtraInfo',");
	fprintf(fp,"]\n");
	LPARAM ret = pGetMessageExtraInfo();
	fprintf(fp,"OUT ['GetMessageExtraInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShowWindow) (HWND hWnd,int nCmdShow) = ShowWindow;
BOOL fake_ShowWindow(HWND hWnd,int nCmdShow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShowWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nCmdShow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCmdShow, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCmdShow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCmdShow,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShowWindow(hWnd,nCmdShow);
	fprintf(fp,"OUT ['ShowWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetGestureExtraArgs) (HGESTUREINFO hGestureInfo,UINT cbExtraArgs,PBYTE pExtraArgs) = GetGestureExtraArgs;
BOOL fake_GetGestureExtraArgs(HGESTUREINFO hGestureInfo,UINT cbExtraArgs,PBYTE pExtraArgs){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetGestureExtraArgs',");
	if(1) fprintf(fp,"{'name':'hGestureInfo','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hGestureInfo, sizeof(HGESTUREINFO),1);
 	else fprintf(fp,"{'name':'hGestureInfo','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hGestureInfo,sizeof(HGESTUREINFO));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbExtraArgs','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbExtraArgs, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbExtraArgs','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbExtraArgs,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetGestureExtraArgs(hGestureInfo,cbExtraArgs,pExtraArgs);
	fprintf(fp,"OUT ['GetGestureExtraArgs',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pExtraArgs','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pExtraArgs, sizeof(PBYTE),1);
 	else fprintf(fp,"{'name':'pExtraArgs','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pExtraArgs,sizeof(PBYTE));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetAltTabInfoW) (HWND hwnd,int iItem,PALTTABINFO pati,LPWSTR pszItemText,UINT cchItemText) = GetAltTabInfoW;
BOOL fake_GetAltTabInfoW(HWND hwnd,int iItem,PALTTABINFO pati,LPWSTR pszItemText,UINT cchItemText){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetAltTabInfoW',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'iItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pati','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pati, sizeof(PALTTABINFO),1);
 	else fprintf(fp,"{'name':'pati','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pati,sizeof(PALTTABINFO));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchItemText','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchItemText, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cchItemText','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchItemText,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetAltTabInfoW(hwnd,iItem,pati,pszItemText,cchItemText);
	fprintf(fp,"OUT ['GetAltTabInfoW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pati','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pati, sizeof(PALTTABINFO),1);
 	else fprintf(fp,"{'name':'pati','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pati,sizeof(PALTTABINFO));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'pszItemText',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", pszItemText);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", pszItemText);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchItemText);
 	}else 
	{
		fprintf(fp,"{'name':'pszItemText',");
		fwprintf(fp, L"'value': %p, ", pszItemText);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(pszItemText){
		for(int i=0; i<cchItemText;i++){
			fprintf(fp,"0x%x,",pszItemText[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pPostMessageW) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = PostMessageW;
BOOL fake_PostMessageW(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['PostMessageW',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pPostMessageW(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['PostMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetWindowDisplayAffinity) (HWND hWnd,DWORD*  pdwAffinity) = GetWindowDisplayAffinity;
BOOL fake_GetWindowDisplayAffinity(HWND hWnd,DWORD*  pdwAffinity){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowDisplayAffinity',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetWindowDisplayAffinity(hWnd, pdwAffinity);
	fprintf(fp,"OUT ['GetWindowDisplayAffinity',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' pdwAffinity','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pdwAffinity, sizeof(DWORD*),1);
 	else fprintf(fp,"{'name':' pdwAffinity','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pdwAffinity,sizeof(DWORD*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSwapMouseButton) (BOOL fSwap) = SwapMouseButton;
BOOL fake_SwapMouseButton(BOOL fSwap){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SwapMouseButton',");
	if(1) fprintf(fp,"{'name':'fSwap','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fSwap, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fSwap','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fSwap,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSwapMouseButton(fSwap);
	fprintf(fp,"OUT ['SwapMouseButton',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetRectEmpty) (LPRECT lprc) = SetRectEmpty;
BOOL fake_SetRectEmpty(LPRECT lprc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetRectEmpty',");
	fprintf(fp,"]\n");
	BOOL ret = pSetRectEmpty(lprc);
	fprintf(fp,"OUT ['SetRectEmpty',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LPSTR (WINAPI *pCharUpperA) (LPSTR lpsz) = CharUpperA;
LPSTR fake_CharUpperA(LPSTR lpsz){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharUpperA',");
	if(1) fprintf(fp,"{'name':'lpsz','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpsz','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LPSTR ret = pCharUpperA(lpsz);
	fprintf(fp,"OUT ['CharUpperA',");
	if(1) fprintf(fp,"{'name':'ret','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'ret','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LPSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsz','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'lpsz','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HKL (WINAPI *pLoadKeyboardLayoutW) (LPCWSTR pwszKLID,UINT Flags) = LoadKeyboardLayoutW;
HKL fake_LoadKeyboardLayoutW(LPCWSTR pwszKLID,UINT Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadKeyboardLayoutW',");
	if(1)
	{
		fprintf(fp,"{'name':'pwszKLID',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", pwszKLID);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", pwszKLID);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'pwszKLID',");
		fwprintf(fp, L"'value': '\"%s\"', ", pwszKLID);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HKL ret = pLoadKeyboardLayoutW(pwszKLID,Flags);
	fprintf(fp,"OUT ['LoadKeyboardLayoutW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDrawIcon) (HDC hDC,int X,int Y,HICON hIcon) = DrawIcon;
BOOL fake_DrawIcon(HDC hDC,int X,int Y,HICON hIcon){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DrawIcon',");
	if(1) fprintf(fp,"{'name':'hDC','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hDC, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hDC','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hDC,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'X','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",X, sizeof(int),1);
 	else fprintf(fp,"{'name':'X','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",X,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Y','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Y, sizeof(int),1);
 	else fprintf(fp,"{'name':'Y','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Y,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hIcon, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'hIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hIcon,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDrawIcon(hDC,X,Y,hIcon);
	fprintf(fp,"OUT ['DrawIcon',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pUnhookWindowsHook) (int nCode,HOOKPROC pfnFilterProc) = UnhookWindowsHook;
BOOL fake_UnhookWindowsHook(int nCode,HOOKPROC pfnFilterProc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['UnhookWindowsHook',");
	if(1) fprintf(fp,"{'name':'nCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nCode, sizeof(int),1);
 	else fprintf(fp,"{'name':'nCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nCode,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pfnFilterProc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",pfnFilterProc, sizeof(HOOKPROC),1);
 	else fprintf(fp,"{'name':'pfnFilterProc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pfnFilterProc,sizeof(HOOKPROC));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pUnhookWindowsHook(nCode,pfnFilterProc);
	fprintf(fp,"OUT ['UnhookWindowsHook',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetAltTabInfoA) (HWND hwnd,int iItem,PALTTABINFO pati,LPSTR pszItemText,UINT cchItemText) = GetAltTabInfoA;
BOOL fake_GetAltTabInfoA(HWND hwnd,int iItem,PALTTABINFO pati,LPSTR pszItemText,UINT cchItemText){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetAltTabInfoA',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iItem, sizeof(int),1);
 	else fprintf(fp,"{'name':'iItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iItem,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pati','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pati, sizeof(PALTTABINFO),1);
 	else fprintf(fp,"{'name':'pati','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pati,sizeof(PALTTABINFO));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchItemText','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchItemText, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cchItemText','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchItemText,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetAltTabInfoA(hwnd,iItem,pati,pszItemText,cchItemText);
	fprintf(fp,"OUT ['GetAltTabInfoA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pati','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pati, sizeof(PALTTABINFO),1);
 	else fprintf(fp,"{'name':'pati','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pati,sizeof(PALTTABINFO));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pszItemText','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pszItemText, sizeof(LPSTR),cchItemText);
 	else fprintf(fp,"{'name':'pszItemText','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pszItemText,sizeof(LPSTR));
	if(pszItemText){
		for(int i=0; i<cchItemText;i++){
			fprintf(fp,"0x%x,",pszItemText[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pOpenInputDesktop) (DWORD dwFlags,BOOL fInherit,ACCESS_MASK dwDesiredAccess) = OpenInputDesktop;
HDESK fake_OpenInputDesktop(DWORD dwFlags,BOOL fInherit,ACCESS_MASK dwDesiredAccess){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenInputDesktop',");
	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fInherit','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fInherit, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fInherit','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fInherit,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pOpenInputDesktop(dwFlags,fInherit,dwDesiredAccess);
	fprintf(fp,"OUT ['OpenInputDesktop',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pChildWindowFromPoint) (HWND hWndParent,POINT Point) = ChildWindowFromPoint;
HWND fake_ChildWindowFromPoint(HWND hWndParent,POINT Point){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChildWindowFromPoint',");
	if(1) fprintf(fp,"{'name':'hWndParent','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndParent, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndParent','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndParent,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Point','value': 0x%llx,'size' : 0x%lx,'cnt':0x%x, 'data':[",Point, sizeof(POINT),1);
 	else fprintf(fp,"{'name':'Point','value': 0x%llx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Point,sizeof(POINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWND ret = pChildWindowFromPoint(hWndParent,Point);
	fprintf(fp,"OUT ['ChildWindowFromPoint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

SHORT (WINAPI *pVkKeyScanExA) (CHAR ch,HKL dwhkl) = VkKeyScanExA;
SHORT fake_VkKeyScanExA(CHAR ch,HKL dwhkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['VkKeyScanExA',");
	if(1) fprintf(fp,"{'name':'ch','value': '\"%c\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ch, sizeof(CHAR),1);
 	else fprintf(fp,"{'name':'ch','value': '\"%c\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ch,sizeof(CHAR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwhkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwhkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'dwhkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwhkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	SHORT ret = pVkKeyScanExA(ch,dwhkl);
	fprintf(fp,"OUT ['VkKeyScanExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(SHORT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(SHORT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LRESULT (WINAPI *pSendMessageA) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = SendMessageA;
LRESULT fake_SendMessageA(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendMessageA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LRESULT ret = pSendMessageA(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['SendMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LRESULT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LRESULT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetWindowPlacement) (HWND hWnd,CONST WINDOWPLACEMENT* lpwndpl) = SetWindowPlacement;
BOOL fake_SetWindowPlacement(HWND hWnd,CONST WINDOWPLACEMENT* lpwndpl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowPlacement',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpwndpl','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpwndpl, sizeof(CONST WINDOWPLACEMENT*),1);
 	else fprintf(fp,"{'name':'lpwndpl','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpwndpl,sizeof(CONST WINDOWPLACEMENT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetWindowPlacement(hWnd,lpwndpl);
	fprintf(fp,"OUT ['SetWindowPlacement',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSendNotifyMessageA) (HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam) = SendNotifyMessageA;
BOOL fake_SendNotifyMessageA(HWND hWnd,UINT Msg,WPARAM wParam,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SendNotifyMessageA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Msg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Msg, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Msg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Msg,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wParam, sizeof(WPARAM),1);
 	else fprintf(fp,"{'name':'wParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wParam,sizeof(WPARAM));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSendNotifyMessageA(hWnd,Msg,wParam,lParam);
	fprintf(fp,"OUT ['SendNotifyMessageA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplayDevicesA) (LPCSTR lpDevice,DWORD iDevNum,PDISPLAY_DEVICEA lpDisplayDevice,DWORD dwFlags) = EnumDisplayDevicesA;
BOOL fake_EnumDisplayDevicesA(LPCSTR lpDevice,DWORD iDevNum,PDISPLAY_DEVICEA lpDisplayDevice,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplayDevicesA',");
	if(1) fprintf(fp,"{'name':'lpDevice','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpDevice, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpDevice','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDevice,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'iDevNum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",iDevNum, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'iDevNum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",iDevNum,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDisplayDevice','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDisplayDevice, sizeof(PDISPLAY_DEVICEA),1);
 	else fprintf(fp,"{'name':'lpDisplayDevice','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDisplayDevice,sizeof(PDISPLAY_DEVICEA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplayDevicesA(lpDevice,iDevNum,lpDisplayDevice,dwFlags);
	fprintf(fp,"OUT ['EnumDisplayDevicesA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpDisplayDevice','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpDisplayDevice, sizeof(PDISPLAY_DEVICEA),1);
 	else fprintf(fp,"{'name':'lpDisplayDevice','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpDisplayDevice,sizeof(PDISPLAY_DEVICEA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HCURSOR (WINAPI *pLoadCursorA) (HINSTANCE hInstance,LPCSTR lpCursorName) = LoadCursorA;
HCURSOR fake_LoadCursorA(HINSTANCE hInstance,LPCSTR lpCursorName){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadCursorA',");
	if(1) fprintf(fp,"{'name':'hInstance','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hInstance, sizeof(HINSTANCE),1);
 	else fprintf(fp,"{'name':'hInstance','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hInstance,sizeof(HINSTANCE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpCursorName','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpCursorName, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpCursorName','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpCursorName,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HCURSOR ret = pLoadCursorA(hInstance,lpCursorName);
	fprintf(fp,"OUT ['LoadCursorA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HCURSOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HCURSOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWINSTA (WINAPI *pOpenWindowStationW) (LPCWSTR lpszWinSta,BOOL fInherit,ACCESS_MASK dwDesiredAccess) = OpenWindowStationW;
HWINSTA fake_OpenWindowStationW(LPCWSTR lpszWinSta,BOOL fInherit,ACCESS_MASK dwDesiredAccess){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenWindowStationW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszWinSta',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszWinSta);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszWinSta);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszWinSta',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszWinSta);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fInherit','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fInherit, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fInherit','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fInherit,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HWINSTA ret = pOpenWindowStationW(lpszWinSta,fInherit,dwDesiredAccess);
	fprintf(fp,"OUT ['OpenWindowStationW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCopyRect) (LPRECT lprcDst,CONST RECT* lprcSrc) = CopyRect;
BOOL fake_CopyRect(LPRECT lprcDst,CONST RECT* lprcSrc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CopyRect',");
	if(1) fprintf(fp,"{'name':'lprcSrc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcSrc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprcSrc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcSrc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCopyRect(lprcDst,lprcSrc);
	fprintf(fp,"OUT ['CopyRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcDst','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcDst, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprcDst','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcDst,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pModifyMenuW) (HMENU hMnu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCWSTR lpNewItem) = ModifyMenuW;
BOOL fake_ModifyMenuW(HMENU hMnu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCWSTR lpNewItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ModifyMenuW',");
	if(1) fprintf(fp,"{'name':'hMnu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMnu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMnu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMnu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDNewItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDNewItem, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDNewItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDNewItem,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpNewItem',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpNewItem);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpNewItem);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpNewItem',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpNewItem);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pModifyMenuW(hMnu,uPosition,uFlags,uIDNewItem,lpNewItem);
	fprintf(fp,"OUT ['ModifyMenuW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAppendMenuW) (HMENU hMenu,UINT uFlags,UINT_PTR uIDNewItem,LPCWSTR lpNewItem) = AppendMenuW;
BOOL fake_AppendMenuW(HMENU hMenu,UINT uFlags,UINT_PTR uIDNewItem,LPCWSTR lpNewItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AppendMenuW',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDNewItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDNewItem, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDNewItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDNewItem,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpNewItem',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpNewItem);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpNewItem);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpNewItem',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpNewItem);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAppendMenuW(hMenu,uFlags,uIDNewItem,lpNewItem);
	fprintf(fp,"OUT ['AppendMenuW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumDisplayMonitors) (HDC hdc,LPCRECT lprcClip,MONITORENUMPROC lpfnEnum,LPARAM dwData) = EnumDisplayMonitors;
BOOL fake_EnumDisplayMonitors(HDC hdc,LPCRECT lprcClip,MONITORENUMPROC lpfnEnum,LPARAM dwData){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumDisplayMonitors',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprcClip','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprcClip, sizeof(LPCRECT),1);
 	else fprintf(fp,"{'name':'lprcClip','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprcClip,sizeof(LPCRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpfnEnum','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpfnEnum, sizeof(MONITORENUMPROC),1);
 	else fprintf(fp,"{'name':'lpfnEnum','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpfnEnum,sizeof(MONITORENUMPROC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwData','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwData, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'dwData','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwData,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumDisplayMonitors(hdc,lprcClip,lpfnEnum,dwData);
	fprintf(fp,"OUT ['EnumDisplayMonitors',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pEnumWindowStationsW) (WINSTAENUMPROCW lpEnumFunc,LPARAM lParam) = EnumWindowStationsW;
BOOL fake_EnumWindowStationsW(WINSTAENUMPROCW lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumWindowStationsW',");
	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(WINSTAENUMPROCW),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(WINSTAENUMPROCW));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pEnumWindowStationsW(lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumWindowStationsW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetKeyboardState) (PBYTE lpKeyState) = GetKeyboardState;
BOOL fake_GetKeyboardState(PBYTE lpKeyState){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyboardState',");
	fprintf(fp,"]\n");
	BOOL ret = pGetKeyboardState(lpKeyState);
	fprintf(fp,"OUT ['GetKeyboardState',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpKeyState','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpKeyState, sizeof(PBYTE),256);
 	else fprintf(fp,"{'name':'lpKeyState','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpKeyState,sizeof(PBYTE));
	if(lpKeyState){
		for(int i=0; i<256;i++){
			fprintf(fp,"0x%x,",lpKeyState[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HKL (WINAPI *pGetKeyboardLayout) (DWORD idThread) = GetKeyboardLayout;
HKL fake_GetKeyboardLayout(DWORD idThread){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetKeyboardLayout',");
	if(1) fprintf(fp,"{'name':'idThread','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idThread, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'idThread','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idThread,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HKL ret = pGetKeyboardLayout(idThread);
	fprintf(fp,"OUT ['GetKeyboardLayout',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pCharLowerBuffW) (LPWSTR lpsz,DWORD cchLength) = CharLowerBuffW;
DWORD fake_CharLowerBuffW(LPWSTR lpsz,DWORD cchLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharLowerBuffW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchLength);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': %p, ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pCharLowerBuffW(lpsz,cchLength);
	fprintf(fp,"OUT ['CharLowerBuffW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpsz',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpsz);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpsz);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPWSTR),cchLength);
 	}else 
	{
		fprintf(fp,"{'name':'lpsz',");
		fwprintf(fp, L"'value': %p, ", lpsz);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPWSTR));
	}
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pOemKeyScan) (WORD wOemChar) = OemKeyScan;
DWORD fake_OemKeyScan(WORD wOemChar){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OemKeyScan',");
	if(1) fprintf(fp,"{'name':'wOemChar','value': 0x%hx,'size' : 0x%lx,'cnt':0x%x, 'data':[",wOemChar, sizeof(WORD),1);
 	else fprintf(fp,"{'name':'wOemChar','value': 0x%hx, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wOemChar,sizeof(WORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pOemKeyScan(wOemChar);
	fprintf(fp,"OUT ['OemKeyScan',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pChangeWindowMessageFilterEx) (HWND hwnd,UINT message,DWORD action,PCHANGEFILTERSTRUCT pChangeFilterStruct) = ChangeWindowMessageFilterEx;
BOOL fake_ChangeWindowMessageFilterEx(HWND hwnd,UINT message,DWORD action,PCHANGEFILTERSTRUCT pChangeFilterStruct){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeWindowMessageFilterEx',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'message','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",message, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'message','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",message,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'action','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",action, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'action','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",action,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pChangeFilterStruct','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",pChangeFilterStruct, sizeof(PCHANGEFILTERSTRUCT),1);
 	else fprintf(fp,"{'name':'pChangeFilterStruct','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pChangeFilterStruct,sizeof(PCHANGEFILTERSTRUCT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pChangeWindowMessageFilterEx(hwnd,message,action,pChangeFilterStruct);
	fprintf(fp,"OUT ['ChangeWindowMessageFilterEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pChangeFilterStruct','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",pChangeFilterStruct, sizeof(PCHANGEFILTERSTRUCT),1);
 	else fprintf(fp,"{'name':'pChangeFilterStruct','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pChangeFilterStruct,sizeof(PCHANGEFILTERSTRUCT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsRectEmpty) (CONST RECT* lprc) = IsRectEmpty;
BOOL fake_IsRectEmpty(CONST RECT* lprc){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsRectEmpty',");
	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsRectEmpty(lprc);
	fprintf(fp,"OUT ['IsRectEmpty',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCancelShutdown) () = CancelShutdown;
BOOL fake_CancelShutdown(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CancelShutdown',");
	fprintf(fp,"]\n");
	BOOL ret = pCancelShutdown();
	fprintf(fp,"OUT ['CancelShutdown',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pwsprintfA) (LPSTR arg0,LPCSTR arg1) = wsprintfA;
int fake_wsprintfA(LPSTR arg0,LPCSTR arg1){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['wsprintfA',");
	if(1) fprintf(fp,"{'name':'arg1','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",arg1, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'arg1','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg1,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pwsprintfA(arg0,arg1);
	fprintf(fp,"OUT ['wsprintfA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'arg0','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",arg0, sizeof(LPSTR),1);
 	else fprintf(fp,"{'name':'arg0','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",arg0,sizeof(LPSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetMenuItemBitmaps) (HMENU hMenu,UINT uPosition,UINT uFlags,HBITMAP hBitmapUnchecked,HBITMAP hBitmapChecked) = SetMenuItemBitmaps;
BOOL fake_SetMenuItemBitmaps(HMENU hMenu,UINT uPosition,UINT uFlags,HBITMAP hBitmapUnchecked,HBITMAP hBitmapChecked){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetMenuItemBitmaps',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hBitmapUnchecked','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hBitmapUnchecked, sizeof(HBITMAP),1);
 	else fprintf(fp,"{'name':'hBitmapUnchecked','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hBitmapUnchecked,sizeof(HBITMAP));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hBitmapChecked','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hBitmapChecked, sizeof(HBITMAP),1);
 	else fprintf(fp,"{'name':'hBitmapChecked','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hBitmapChecked,sizeof(HBITMAP));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetMenuItemBitmaps(hMenu,uPosition,uFlags,hBitmapUnchecked,hBitmapChecked);
	fprintf(fp,"OUT ['SetMenuItemBitmaps',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pAllowSetForegroundWindow) (DWORD dwProcessId) = AllowSetForegroundWindow;
BOOL fake_AllowSetForegroundWindow(DWORD dwProcessId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['AllowSetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'dwProcessId','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwProcessId, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwProcessId','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwProcessId,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pAllowSetForegroundWindow(dwProcessId);
	fprintf(fp,"OUT ['AllowSetForegroundWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HICON (WINAPI *pCopyIcon) (HICON hIcon) = CopyIcon;
HICON fake_CopyIcon(HICON hIcon){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CopyIcon',");
	if(1) fprintf(fp,"{'name':'hIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hIcon, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'hIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hIcon,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HICON ret = pCopyIcon(hIcon);
	fprintf(fp,"OUT ['CopyIcon',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInSendMessage) () = InSendMessage;
BOOL fake_InSendMessage(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InSendMessage',");
	fprintf(fp,"]\n");
	BOOL ret = pInSendMessage();
	fprintf(fp,"OUT ['InSendMessage',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pScrollWindow) (HWND hWnd,int XAmount,int YAmount,CONST RECT* lpRect,CONST RECT* lpClipRect) = ScrollWindow;
BOOL fake_ScrollWindow(HWND hWnd,int XAmount,int YAmount,CONST RECT* lpRect,CONST RECT* lpClipRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ScrollWindow',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'XAmount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",XAmount, sizeof(int),1);
 	else fprintf(fp,"{'name':'XAmount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",XAmount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'YAmount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",YAmount, sizeof(int),1);
 	else fprintf(fp,"{'name':'YAmount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",YAmount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpClipRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpClipRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lpClipRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpClipRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pScrollWindow(hWnd,XAmount,YAmount,lpRect,lpClipRect);
	fprintf(fp,"OUT ['ScrollWindow',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pGetWindowRgn) (HWND hWnd,HRGN hRgn) = GetWindowRgn;
int fake_GetWindowRgn(HWND hWnd,HRGN hRgn){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowRgn',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hRgn','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRgn, sizeof(HRGN),1);
 	else fprintf(fp,"{'name':'hRgn','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRgn,sizeof(HRGN));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pGetWindowRgn(hWnd,hRgn);
	fprintf(fp,"OUT ['GetWindowRgn',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDC (WINAPI *pBeginPaint) (HWND hWnd,LPPAINTSTRUCT lpPaint) = BeginPaint;
HDC fake_BeginPaint(HWND hWnd,LPPAINTSTRUCT lpPaint){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['BeginPaint',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDC ret = pBeginPaint(hWnd,lpPaint);
	fprintf(fp,"OUT ['BeginPaint',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpPaint','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpPaint, sizeof(LPPAINTSTRUCT),1);
 	else fprintf(fp,"{'name':'lpPaint','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpPaint,sizeof(LPPAINTSTRUCT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pChangeClipboardChain) (HWND hWndRemove,HWND hWndNewNext) = ChangeClipboardChain;
BOOL fake_ChangeClipboardChain(HWND hWndRemove,HWND hWndNewNext){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeClipboardChain',");
	if(1) fprintf(fp,"{'name':'hWndRemove','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndRemove, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndRemove','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndRemove,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'hWndNewNext','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWndNewNext, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWndNewNext','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWndNewNext,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pChangeClipboardChain(hWndRemove,hWndNewNext);
	fprintf(fp,"OUT ['ChangeClipboardChain',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetWindowThreadProcessId) (HWND hWnd,LPDWORD lpdwProcessId) = GetWindowThreadProcessId;
DWORD fake_GetWindowThreadProcessId(HWND hWnd,LPDWORD lpdwProcessId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetWindowThreadProcessId',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetWindowThreadProcessId(hWnd,lpdwProcessId);
	fprintf(fp,"OUT ['GetWindowThreadProcessId',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpdwProcessId','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpdwProcessId, sizeof(LPDWORD),1);
 	else fprintf(fp,"{'name':'lpdwProcessId','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpdwProcessId,sizeof(LPDWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pCharLowerBuffA) (LPSTR lpsz,DWORD cchLength) = CharLowerBuffA;
DWORD fake_CharLowerBuffA(LPSTR lpsz,DWORD cchLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CharLowerBuffA',");
	if(1) fprintf(fp,"{'name':'lpsz','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),cchLength);
 	else fprintf(fp,"{'name':'lpsz','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'cchLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pCharLowerBuffA(lpsz,cchLength);
	fprintf(fp,"OUT ['CharLowerBuffA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpsz','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpsz, sizeof(LPSTR),cchLength);
 	else fprintf(fp,"{'name':'lpsz','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpsz,sizeof(LPSTR));
	if(lpsz){
		for(int i=0; i<cchLength;i++){
			fprintf(fp,"0x%x,",lpsz[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pRegisterWindowMessageW) (LPCWSTR lpString) = RegisterWindowMessageW;
UINT fake_RegisterWindowMessageW(LPCWSTR lpString){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterWindowMessageW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pRegisterWindowMessageW(lpString);
	fprintf(fp,"OUT ['RegisterWindowMessageW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG (WINAPI *pQueryDisplayConfig) (UINT32 flags,UINT32*  numPathArrayElements,DISPLAYCONFIG_PATH_INFO*  pathArray,UINT32*  numModeInfoArrayElements,DISPLAYCONFIG_MODE_INFO*  modeInfoArray,DISPLAYCONFIG_TOPOLOGY_ID*  currentTopologyId) = QueryDisplayConfig;
LONG fake_QueryDisplayConfig(UINT32 flags,UINT32*  numPathArrayElements,DISPLAYCONFIG_PATH_INFO*  pathArray,UINT32*  numModeInfoArrayElements,DISPLAYCONFIG_MODE_INFO*  modeInfoArray,DISPLAYCONFIG_TOPOLOGY_ID*  currentTopologyId){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['QueryDisplayConfig',");
	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT32),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT32));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' numPathArrayElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", numPathArrayElements, sizeof(UINT32*),1);
 	else fprintf(fp,"{'name':' numPathArrayElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", numPathArrayElements,sizeof(UINT32*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' numModeInfoArrayElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", numModeInfoArrayElements, sizeof(UINT32*),1);
 	else fprintf(fp,"{'name':' numModeInfoArrayElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", numModeInfoArrayElements,sizeof(UINT32*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG ret = pQueryDisplayConfig(flags, numPathArrayElements, pathArray, numModeInfoArrayElements, modeInfoArray, currentTopologyId);
	fprintf(fp,"OUT ['QueryDisplayConfig',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' numPathArrayElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", numPathArrayElements, sizeof(UINT32*),1);
 	else fprintf(fp,"{'name':' numPathArrayElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", numPathArrayElements,sizeof(UINT32*));
	fprintf(fp,"]},");
 	if(numPathArrayElements &&  *numPathArrayElements && 1) fprintf(fp,"{'name':' pathArray','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", pathArray, sizeof(DISPLAYCONFIG_PATH_INFO*),*numPathArrayElements, *numPathArrayElements);
 	else fprintf(fp,"{'name':' pathArray','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", pathArray,sizeof(DISPLAYCONFIG_PATH_INFO*));
	if(numPathArrayElements &&  *numPathArrayElements &&  pathArray){
		for(int i=0; i<*numPathArrayElements <  *numPathArrayElements ? *numPathArrayElements :  *numPathArrayElements;i++){
			fprintf(fp,"0x%x,", pathArray[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' numModeInfoArrayElements','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", numModeInfoArrayElements, sizeof(UINT32*),1);
 	else fprintf(fp,"{'name':' numModeInfoArrayElements','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", numModeInfoArrayElements,sizeof(UINT32*));
	fprintf(fp,"]},");
 	if(numModeInfoArrayElements &&  *numModeInfoArrayElements && 1) fprintf(fp,"{'name':' modeInfoArray','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", modeInfoArray, sizeof(DISPLAYCONFIG_MODE_INFO*),*numModeInfoArrayElements, *numModeInfoArrayElements);
 	else fprintf(fp,"{'name':' modeInfoArray','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", modeInfoArray,sizeof(DISPLAYCONFIG_MODE_INFO*));
	if(numModeInfoArrayElements &&  *numModeInfoArrayElements &&  modeInfoArray){
		for(int i=0; i<*numModeInfoArrayElements <  *numModeInfoArrayElements ? *numModeInfoArrayElements :  *numModeInfoArrayElements;i++){
			fprintf(fp,"0x%x,", modeInfoArray[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':' currentTopologyId','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[", currentTopologyId, sizeof(DISPLAYCONFIG_TOPOLOGY_ID*),1);
 	else fprintf(fp,"{'name':' currentTopologyId','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[", currentTopologyId,sizeof(DISPLAYCONFIG_TOPOLOGY_ID*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pInflateRect) (LPRECT lprc,int dx,int dy) = InflateRect;
BOOL fake_InflateRect(LPRECT lprc,int dx,int dy){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['InflateRect',");
	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dx','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dx, sizeof(int),1);
 	else fprintf(fp,"{'name':'dx','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dx,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dy','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dy, sizeof(int),1);
 	else fprintf(fp,"{'name':'dy','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dy,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pInflateRect(lprc,dx,dy);
	fprintf(fp,"OUT ['InflateRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPRECT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pClipCursor) (CONST RECT* lpRect) = ClipCursor;
BOOL fake_ClipCursor(CONST RECT* lpRect){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ClipCursor',");
	if(1) fprintf(fp,"{'name':'lpRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpRect, sizeof(CONST RECT*),1);
 	else fprintf(fp,"{'name':'lpRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpRect,sizeof(CONST RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pClipCursor(lpRect);
	fprintf(fp,"OUT ['ClipCursor',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDlgDirSelectExA) (HWND hwndDlg,LPSTR lpString,int chCount,int idListBox) = DlgDirSelectExA;
BOOL fake_DlgDirSelectExA(HWND hwndDlg,LPSTR lpString,int chCount,int idListBox){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirSelectExA',");
	if(1) fprintf(fp,"{'name':'hwndDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'chCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",chCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'chCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",chCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idListBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idListBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'idListBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idListBox,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDlgDirSelectExA(hwndDlg,lpString,chCount,idListBox);
	fprintf(fp,"OUT ['DlgDirSelectExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPSTR),chCount);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPSTR));
	if(lpString){
		for(int i=0; i<chCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ULONG_PTR (WINAPI *pGetClassLongPtrA) (HWND hWnd,int nIndex) = GetClassLongPtrA;
ULONG_PTR fake_GetClassLongPtrA(HWND hWnd,int nIndex){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetClassLongPtrA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ULONG_PTR ret = pGetClassLongPtrA(hWnd,nIndex);
	fprintf(fp,"OUT ['GetClassLongPtrA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

DWORD (WINAPI *pGetTabbedTextExtentW) (HDC hdc,LPCWSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions) = GetTabbedTextExtentW;
DWORD fake_GetTabbedTextExtentW(HDC hdc,LPCWSTR lpString,int chCount,int nTabPositions,CONST INT* lpnTabStopPositions){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetTabbedTextExtentW',");
	if(1) fprintf(fp,"{'name':'hdc','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hdc, sizeof(HDC),1);
 	else fprintf(fp,"{'name':'hdc','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hdc,sizeof(HDC));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpString',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': %p,", lpString);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': %p,", lpString);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),chCount);
 	}else 
	{
		fprintf(fp,"{'name':'lpString',");
		fwprintf(fp, L"'value': %p, ", lpString);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	if(lpString){
		for(int i=0; i<chCount;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'chCount','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",chCount, sizeof(int),1);
 	else fprintf(fp,"{'name':'chCount','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",chCount,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nTabPositions','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nTabPositions, sizeof(int),1);
 	else fprintf(fp,"{'name':'nTabPositions','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nTabPositions,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpnTabStopPositions','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpnTabStopPositions, sizeof(CONST INT*),nTabPositions);
 	else fprintf(fp,"{'name':'lpnTabStopPositions','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpnTabStopPositions,sizeof(CONST INT*));
	if(lpnTabStopPositions){
		for(int i=0; i<nTabPositions;i++){
			fprintf(fp,"0x%x,",lpnTabStopPositions[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	DWORD ret = pGetTabbedTextExtentW(hdc,lpString,chCount,nTabPositions,lpnTabStopPositions);
	fprintf(fp,"OUT ['GetTabbedTextExtentW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

LONG_PTR (WINAPI *pSetWindowLongPtrA) (HWND hWnd,int nIndex,LONG_PTR dwNewLong) = SetWindowLongPtrA;
LONG_PTR fake_SetWindowLongPtrA(HWND hWnd,int nIndex,LONG_PTR dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetWindowLongPtrA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	LONG_PTR ret = pSetWindowLongPtrA(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetWindowLongPtrA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pShowScrollBar) (HWND hWnd,int wBar,BOOL bShow) = ShowScrollBar;
BOOL fake_ShowScrollBar(HWND hWnd,int wBar,BOOL bShow){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ShowScrollBar',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'wBar','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",wBar, sizeof(int),1);
 	else fprintf(fp,"{'name':'wBar','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",wBar,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'bShow','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",bShow, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'bShow','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",bShow,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pShowScrollBar(hWnd,wBar,bShow);
	fprintf(fp,"OUT ['ShowScrollBar',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMONITOR (WINAPI *pMonitorFromRect) (LPCRECT lprc,DWORD dwFlags) = MonitorFromRect;
HMONITOR fake_MonitorFromRect(LPCRECT lprc,DWORD dwFlags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['MonitorFromRect',");
	if(1) fprintf(fp,"{'name':'lprc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lprc, sizeof(LPCRECT),1);
 	else fprintf(fp,"{'name':'lprc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lprc,sizeof(LPCRECT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMONITOR ret = pMonitorFromRect(lprc,dwFlags);
	fprintf(fp,"OUT ['MonitorFromRect',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMONITOR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMONITOR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pActivateKeyboardLayout) (HKL hkl,UINT Flags) = ActivateKeyboardLayout;
BOOL fake_ActivateKeyboardLayout(HKL hkl,UINT Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ActivateKeyboardLayout',");
	if(1) fprintf(fp,"{'name':'hkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'hkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hkl,sizeof(HKL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pActivateKeyboardLayout(hkl,Flags);
	fprintf(fp,"OUT ['ActivateKeyboardLayout',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetGestureConfig) (HWND hwnd,DWORD dwReserved,UINT cIDs,PGESTURECONFIG pGestureConfig,UINT cbSize) = SetGestureConfig;
BOOL fake_SetGestureConfig(HWND hwnd,DWORD dwReserved,UINT cIDs,PGESTURECONFIG pGestureConfig,UINT cbSize){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetGestureConfig',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwReserved','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwReserved, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwReserved','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwReserved,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cIDs','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cIDs, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cIDs','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cIDs,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pGestureConfig','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pGestureConfig, sizeof(PGESTURECONFIG),cIDs);
 	else fprintf(fp,"{'name':'pGestureConfig','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pGestureConfig,sizeof(PGESTURECONFIG));
	if(pGestureConfig){
		for(int i=0; i<cIDs;i++){
			fprintf(fp,"0x%x,",pGestureConfig[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cbSize','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cbSize, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cbSize','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cbSize,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetGestureConfig(hwnd,dwReserved,cIDs,pGestureConfig,cbSize);
	fprintf(fp,"OUT ['SetGestureConfig',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HMENU (WINAPI *pLoadMenuIndirectA) (CONST MENUTEMPLATEA* lpMenuTemplate) = LoadMenuIndirectA;
HMENU fake_LoadMenuIndirectA(CONST MENUTEMPLATEA* lpMenuTemplate){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['LoadMenuIndirectA',");
	if(1) fprintf(fp,"{'name':'lpMenuTemplate','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpMenuTemplate, sizeof(CONST MENUTEMPLATEA*),1);
 	else fprintf(fp,"{'name':'lpMenuTemplate','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpMenuTemplate,sizeof(CONST MENUTEMPLATEA*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HMENU ret = pLoadMenuIndirectA(lpMenuTemplate);
	fprintf(fp,"OUT ['LoadMenuIndirectA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HMENU));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDESK (WINAPI *pOpenDesktopW) (LPCWSTR lpszDesktop,DWORD dwFlags,BOOL fInherit,ACCESS_MASK dwDesiredAccess) = OpenDesktopW;
HDESK fake_OpenDesktopW(LPCWSTR lpszDesktop,DWORD dwFlags,BOOL fInherit,ACCESS_MASK dwDesiredAccess){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['OpenDesktopW',");
	if(1)
	{
		fprintf(fp,"{'name':'lpszDesktop',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszDesktop);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszDesktop);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszDesktop',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszDesktop);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwFlags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'dwFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwFlags,sizeof(DWORD));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fInherit','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fInherit, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fInherit','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fInherit,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwDesiredAccess, sizeof(ACCESS_MASK),1);
 	else fprintf(fp,"{'name':'dwDesiredAccess','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwDesiredAccess,sizeof(ACCESS_MASK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDESK ret = pOpenDesktopW(lpszDesktop,dwFlags,fInherit,dwDesiredAccess);
	fprintf(fp,"OUT ['OpenDesktopW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDESK),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDESK));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

UINT (WINAPI *pEnumClipboardFormats) (UINT format) = EnumClipboardFormats;
UINT fake_EnumClipboardFormats(UINT format){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumClipboardFormats',");
	if(1) fprintf(fp,"{'name':'format','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",format, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'format','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",format,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	UINT ret = pEnumClipboardFormats(format);
	fprintf(fp,"OUT ['EnumClipboardFormats',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pToAsciiEx) (UINT uVirtKey,UINT uScanCode,CONST BYTE* lpKeyState,LPWORD lpChar,UINT uFlags,HKL dwhkl) = ToAsciiEx;
int fake_ToAsciiEx(UINT uVirtKey,UINT uScanCode,CONST BYTE* lpKeyState,LPWORD lpChar,UINT uFlags,HKL dwhkl){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ToAsciiEx',");
	if(1) fprintf(fp,"{'name':'uVirtKey','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uVirtKey, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uVirtKey','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uVirtKey,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uScanCode','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uScanCode, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uScanCode','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uScanCode,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpKeyState','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpKeyState, sizeof(CONST BYTE*),256);
 	else fprintf(fp,"{'name':'lpKeyState','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpKeyState,sizeof(CONST BYTE*));
	if(lpKeyState){
		for(int i=0; i<256;i++){
			fprintf(fp,"0x%x,",lpKeyState[i]);
		}
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwhkl','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwhkl, sizeof(HKL),1);
 	else fprintf(fp,"{'name':'dwhkl','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwhkl,sizeof(HKL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pToAsciiEx(uVirtKey,uScanCode,lpKeyState,lpChar,uFlags,dwhkl);
	fprintf(fp,"OUT ['ToAsciiEx',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpChar','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpChar, sizeof(LPWORD),1);
 	else fprintf(fp,"{'name':'lpChar','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpChar,sizeof(LPWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

ULONG_PTR (WINAPI *pSetClassLongPtrA) (HWND hWnd,int nIndex,LONG_PTR dwNewLong) = SetClassLongPtrA;
ULONG_PTR fake_SetClassLongPtrA(HWND hWnd,int nIndex,LONG_PTR dwNewLong){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetClassLongPtrA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'dwNewLong','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",dwNewLong, sizeof(LONG_PTR),1);
 	else fprintf(fp,"{'name':'dwNewLong','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",dwNewLong,sizeof(LONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	ULONG_PTR ret = pSetClassLongPtrA(hWnd,nIndex,dwNewLong);
	fprintf(fp,"OUT ['SetClassLongPtrA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(ULONG_PTR),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(ULONG_PTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetCaretBlinkTime) (UINT uMSeconds) = SetCaretBlinkTime;
BOOL fake_SetCaretBlinkTime(UINT uMSeconds){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetCaretBlinkTime',");
	if(1) fprintf(fp,"{'name':'uMSeconds','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uMSeconds, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uMSeconds','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uMSeconds,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetCaretBlinkTime(uMSeconds);
	fprintf(fp,"OUT ['SetCaretBlinkTime',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HWND (WINAPI *pGetCapture) () = GetCapture;
HWND fake_GetCapture(){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetCapture',");
	fprintf(fp,"]\n");
	HWND ret = pGetCapture();
	fprintf(fp,"OUT ['GetCapture',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HWND));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

VOID (WINAPI *pSwitchToThisWindow) (HWND hwnd,BOOL fUnknown) = SwitchToThisWindow;
VOID fake_SwitchToThisWindow(HWND hwnd,BOOL fUnknown){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SwitchToThisWindow',");
	if(1) fprintf(fp,"{'name':'hwnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'fUnknown','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",fUnknown, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'fUnknown','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",fUnknown,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	VOID ret = pSwitchToThisWindow(hwnd,fUnknown);
	fprintf(fp,"OUT ['SwitchToThisWindow',");
	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pSetUserObjectInformationA) (HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength) = SetUserObjectInformationA;
BOOL fake_SetUserObjectInformationA(HANDLE hObj,int nIndex,PVOID pvInfo,DWORD nLength){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['SetUserObjectInformationA',");
	if(1) fprintf(fp,"{'name':'hObj','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hObj, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hObj','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hObj,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nIndex','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nIndex, sizeof(int),1);
 	else fprintf(fp,"{'name':'nIndex','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nIndex,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'pvInfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",pvInfo, sizeof(PVOID),1);
 	else fprintf(fp,"{'name':'pvInfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",pvInfo,sizeof(PVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'nLength','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",nLength, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'nLength','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",nLength,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pSetUserObjectInformationA(hObj,nIndex,pvInfo,nLength);
	fprintf(fp,"OUT ['SetUserObjectInformationA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCalculatePopupWindowPosition) (CONST POINT* anchorPoint,CONST SIZE* windowSize,UINT flags,RECT* excludeRect,RECT* popupWindowPosition) = CalculatePopupWindowPosition;
BOOL fake_CalculatePopupWindowPosition(CONST POINT* anchorPoint,CONST SIZE* windowSize,UINT flags,RECT* excludeRect,RECT* popupWindowPosition){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CalculatePopupWindowPosition',");
	if(1) fprintf(fp,"{'name':'anchorPoint','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",anchorPoint, sizeof(CONST POINT*),1);
 	else fprintf(fp,"{'name':'anchorPoint','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",anchorPoint,sizeof(CONST POINT*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'windowSize','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",windowSize, sizeof(CONST SIZE*),1);
 	else fprintf(fp,"{'name':'windowSize','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",windowSize,sizeof(CONST SIZE*));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'excludeRect','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",excludeRect, sizeof(RECT*),1);
 	else fprintf(fp,"{'name':'excludeRect','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",excludeRect,sizeof(RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCalculatePopupWindowPosition(anchorPoint,windowSize,flags,excludeRect,popupWindowPosition);
	fprintf(fp,"OUT ['CalculatePopupWindowPosition',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'popupWindowPosition','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",popupWindowPosition, sizeof(RECT*),1);
 	else fprintf(fp,"{'name':'popupWindowPosition','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",popupWindowPosition,sizeof(RECT*));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

int (WINAPI *pEnumPropsExA) (HWND hWnd,PROPENUMPROCEXA lpEnumFunc,LPARAM lParam) = EnumPropsExA;
int fake_EnumPropsExA(HWND hWnd,PROPENUMPROCEXA lpEnumFunc,LPARAM lParam){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['EnumPropsExA',");
	if(1) fprintf(fp,"{'name':'hWnd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWnd, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hWnd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWnd,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpEnumFunc','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpEnumFunc, sizeof(PROPENUMPROCEXA),1);
 	else fprintf(fp,"{'name':'lpEnumFunc','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpEnumFunc,sizeof(PROPENUMPROCEXA));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lParam','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",lParam, sizeof(LPARAM),1);
 	else fprintf(fp,"{'name':'lParam','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lParam,sizeof(LPARAM));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	int ret = pEnumPropsExA(hWnd,lpEnumFunc,lParam);
	fprintf(fp,"OUT ['EnumPropsExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(int),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pChangeMenuW) (HMENU hMenu,UINT cmd,LPCWSTR lpszNewItem,UINT cmdInsert,UINT flags) = ChangeMenuW;
BOOL fake_ChangeMenuW(HMENU hMenu,UINT cmd,LPCWSTR lpszNewItem,UINT cmdInsert,UINT flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ChangeMenuW',");
	if(1) fprintf(fp,"{'name':'hMenu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMenu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMenu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMenu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cmd','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cmd, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cmd','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cmd,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1)
	{
		fprintf(fp,"{'name':'lpszNewItem',");
		__try
		{
			WCHAR tmp[100] = { 0 };
			swprintf_s(tmp, L"'value': '\"%s\"',", lpszNewItem);
			fwprintf(fp, L"%s", tmp);
		}
		__except(1)
		{
			fprintf(fp, "'value': '\"%s\"',", lpszNewItem);

		}
		fprintf(fp, "'size' : 0x%lx,'cnt':0x%x, 'data':[", sizeof(LPCWSTR),1);
 	}else 
	{
		fprintf(fp,"{'name':'lpszNewItem',");
		fwprintf(fp, L"'value': '\"%s\"', ", lpszNewItem);
		fprintf(fp, "'size' : 0x%lx,'cnt':'undefined', 'data':[",sizeof(LPCWSTR));
	}
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cmdInsert','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cmdInsert, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'cmdInsert','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cmdInsert,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",flags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",flags,sizeof(UINT));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pChangeMenuW(hMenu,cmd,lpszNewItem,cmdInsert,flags);
	fprintf(fp,"OUT ['ChangeMenuW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pCloseWindowStation) (HWINSTA hWinSta) = CloseWindowStation;
BOOL fake_CloseWindowStation(HWINSTA hWinSta){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['CloseWindowStation',");
	if(1) fprintf(fp,"{'name':'hWinSta','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hWinSta, sizeof(HWINSTA),1);
 	else fprintf(fp,"{'name':'hWinSta','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hWinSta,sizeof(HWINSTA));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pCloseWindowStation(hWinSta);
	fprintf(fp,"OUT ['CloseWindowStation',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

HDEVNOTIFY (WINAPI *pRegisterDeviceNotificationW) (HANDLE hRecipient,LPVOID NotificationFilter,DWORD Flags) = RegisterDeviceNotificationW;
HDEVNOTIFY fake_RegisterDeviceNotificationW(HANDLE hRecipient,LPVOID NotificationFilter,DWORD Flags){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['RegisterDeviceNotificationW',");
	if(1) fprintf(fp,"{'name':'hRecipient','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hRecipient, sizeof(HANDLE),1);
 	else fprintf(fp,"{'name':'hRecipient','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hRecipient,sizeof(HANDLE));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'NotificationFilter','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",NotificationFilter, sizeof(LPVOID),1);
 	else fprintf(fp,"{'name':'NotificationFilter','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",NotificationFilter,sizeof(LPVOID));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'Flags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",Flags, sizeof(DWORD),1);
 	else fprintf(fp,"{'name':'Flags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",Flags,sizeof(DWORD));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	HDEVNOTIFY ret = pRegisterDeviceNotificationW(hRecipient,NotificationFilter,Flags);
	fprintf(fp,"OUT ['RegisterDeviceNotificationW',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(HDEVNOTIFY),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(HDEVNOTIFY));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pModifyMenuA) (HMENU hMnu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCSTR lpNewItem) = ModifyMenuA;
BOOL fake_ModifyMenuA(HMENU hMnu,UINT uPosition,UINT uFlags,UINT_PTR uIDNewItem,LPCSTR lpNewItem){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['ModifyMenuA',");
	if(1) fprintf(fp,"{'name':'hMnu','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hMnu, sizeof(HMENU),1);
 	else fprintf(fp,"{'name':'hMnu','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hMnu,sizeof(HMENU));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uPosition','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uPosition, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uPosition','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uPosition,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uFlags','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uFlags, sizeof(UINT),1);
 	else fprintf(fp,"{'name':'uFlags','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uFlags,sizeof(UINT));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'uIDNewItem','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",uIDNewItem, sizeof(UINT_PTR),1);
 	else fprintf(fp,"{'name':'uIDNewItem','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",uIDNewItem,sizeof(UINT_PTR));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpNewItem','value': '\"%s\"','size' : 0x%lx,'cnt':0x%x, 'data':[",lpNewItem, sizeof(LPCSTR),1);
 	else fprintf(fp,"{'name':'lpNewItem','value': '\"%s\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpNewItem,sizeof(LPCSTR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pModifyMenuA(hMnu,uPosition,uFlags,uIDNewItem,lpNewItem);
	fprintf(fp,"OUT ['ModifyMenuA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pDlgDirSelectComboBoxExA) (HWND hwndDlg,LPSTR lpString,int cchOut,int idComboBox) = DlgDirSelectComboBoxExA;
BOOL fake_DlgDirSelectComboBoxExA(HWND hwndDlg,LPSTR lpString,int cchOut,int idComboBox){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['DlgDirSelectComboBoxExA',");
	if(1) fprintf(fp,"{'name':'hwndDlg','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hwndDlg, sizeof(HWND),1);
 	else fprintf(fp,"{'name':'hwndDlg','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hwndDlg,sizeof(HWND));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'cchOut','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",cchOut, sizeof(int),1);
 	else fprintf(fp,"{'name':'cchOut','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",cchOut,sizeof(int));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'idComboBox','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",idComboBox, sizeof(int),1);
 	else fprintf(fp,"{'name':'idComboBox','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",idComboBox,sizeof(int));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pDlgDirSelectComboBoxExA(hwndDlg,lpString,cchOut,idComboBox);
	fprintf(fp,"OUT ['DlgDirSelectComboBoxExA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'lpString','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",lpString, sizeof(LPSTR),cchOut);
 	else fprintf(fp,"{'name':'lpString','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",lpString,sizeof(LPSTR));
	if(lpString){
		for(int i=0; i<cchOut;i++){
			fprintf(fp,"0x%x,",lpString[i]);
		}
	}
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pGetIconInfo) (HICON hIcon,PICONINFO piconinfo) = GetIconInfo;
BOOL fake_GetIconInfo(HICON hIcon,PICONINFO piconinfo){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['GetIconInfo',");
	if(1) fprintf(fp,"{'name':'hIcon','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",hIcon, sizeof(HICON),1);
 	else fprintf(fp,"{'name':'hIcon','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",hIcon,sizeof(HICON));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pGetIconInfo(hIcon,piconinfo);
	fprintf(fp,"OUT ['GetIconInfo',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	if(1) fprintf(fp,"{'name':'piconinfo','value': %p,'size' : 0x%lx,'cnt':0x%x, 'data':[",piconinfo, sizeof(PICONINFO),1);
 	else fprintf(fp,"{'name':'piconinfo','value': %p, 'size' : 0x%lx,'cnt':'undefined', 'data':[",piconinfo,sizeof(PICONINFO));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}

BOOL (WINAPI *pIsCharLowerA) (CHAR ch) = IsCharLowerA;
BOOL fake_IsCharLowerA(CHAR ch){
	WaitForSingleObject(g_mutex, INFINITE);
	FILE *fp = fopen(log_path,"a");
	_wsetlocale(0, L"chs");
	fprintf(fp,"IN ['IsCharLowerA',");
	if(1) fprintf(fp,"{'name':'ch','value': '\"%c\"','size' : 0x%lx,'cnt':0x%x, 'data':[",ch, sizeof(CHAR),1);
 	else fprintf(fp,"{'name':'ch','value': '\"%c\"', 'size' : 0x%lx,'cnt':'undefined', 'data':[",ch,sizeof(CHAR));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	BOOL ret = pIsCharLowerA(ch);
	fprintf(fp,"OUT ['IsCharLowerA',");
	if(1) fprintf(fp,"{'name':'ret','value': 0x%x,'size' : 0x%lx,'cnt':0x%x, 'data':[",ret, sizeof(BOOL),1);
 	else fprintf(fp,"{'name':'ret','value': 0x%x, 'size' : 0x%lx,'cnt':'undefined', 'data':[",ret,sizeof(BOOL));
	fprintf(fp,"]},");
 	fprintf(fp,"]\n");
	fclose(fp);
	ReleaseMutex(g_mutex);
	return ret;
}


BOOL WINAPI DllMain(HINSTANCE hinst, DWORD dwReason, LPVOID reserved)  
{  
    if (dwReason == DLL_PROCESS_ATTACH)
    {
        g_mutex = CreateMutex(NULL, false, NULL);
        DetourTransactionBegin();  
        DetourUpdateThread(GetCurrentThread());  
		DetourAttach(&(PVOID&)pGetUpdateRgn, fake_GetUpdateRgn);
		DetourAttach(&(PVOID&)pCallWindowProcW, fake_CallWindowProcW);
		DetourAttach(&(PVOID&)pVkKeyScanExW, fake_VkKeyScanExW);
		DetourAttach(&(PVOID&)pGetKeyboardType, fake_GetKeyboardType);
		DetourAttach(&(PVOID&)pPrintWindow, fake_PrintWindow);
		DetourAttach(&(PVOID&)pIsCharAlphaA, fake_IsCharAlphaA);
		DetourAttach(&(PVOID&)pGetDoubleClickTime, fake_GetDoubleClickTime);
		DetourAttach(&(PVOID&)pDrawEdge, fake_DrawEdge);
		DetourAttach(&(PVOID&)pDestroyCursor, fake_DestroyCursor);
		DetourAttach(&(PVOID&)pSetMessageExtraInfo, fake_SetMessageExtraInfo);
		DetourAttach(&(PVOID&)pIsTouchWindow, fake_IsTouchWindow);
		DetourAttach(&(PVOID&)pGetCursorPos, fake_GetCursorPos);
		DetourAttach(&(PVOID&)pEnableMenuItem, fake_EnableMenuItem);
		DetourAttach(&(PVOID&)pCharLowerW, fake_CharLowerW);
		DetourAttach(&(PVOID&)pGetFocus, fake_GetFocus);
		DetourAttach(&(PVOID&)pCharToOemA, fake_CharToOemA);
		DetourAttach(&(PVOID&)pGetOpenClipboardWindow, fake_GetOpenClipboardWindow);
		DetourAttach(&(PVOID&)pEnumPropsA, fake_EnumPropsA);
		DetourAttach(&(PVOID&)pDefMDIChildProcW, fake_DefMDIChildProcW);
		DetourAttach(&(PVOID&)pSetParent, fake_SetParent);
		DetourAttach(&(PVOID&)pFlashWindowEx, fake_FlashWindowEx);
		DetourAttach(&(PVOID&)pGetGuiResources, fake_GetGuiResources);
		DetourAttach(&(PVOID&)pCountClipboardFormats, fake_CountClipboardFormats);
		DetourAttach(&(PVOID&)pSetMenuInfo, fake_SetMenuInfo);
		DetourAttach(&(PVOID&)pSetDlgItemInt, fake_SetDlgItemInt);
		DetourAttach(&(PVOID&)pDrawCaption, fake_DrawCaption);
		DetourAttach(&(PVOID&)pGetNextDlgGroupItem, fake_GetNextDlgGroupItem);
		DetourAttach(&(PVOID&)pCreateDialogParamA, fake_CreateDialogParamA);
		DetourAttach(&(PVOID&)pGetClassInfoExW, fake_GetClassInfoExW);
		DetourAttach(&(PVOID&)pTranslateMDISysAccel, fake_TranslateMDISysAccel);
		DetourAttach(&(PVOID&)pAnimateWindow, fake_AnimateWindow);
		DetourAttach(&(PVOID&)pChildWindowFromPointEx, fake_ChildWindowFromPointEx);
		DetourAttach(&(PVOID&)pOemToCharBuffA, fake_OemToCharBuffA);
		DetourAttach(&(PVOID&)pEnumWindows, fake_EnumWindows);
		DetourAttach(&(PVOID&)pGetMenuInfo, fake_GetMenuInfo);
		DetourAttach(&(PVOID&)pGetMenuItemCount, fake_GetMenuItemCount);
		DetourAttach(&(PVOID&)pSetUserObjectInformationW, fake_SetUserObjectInformationW);
		DetourAttach(&(PVOID&)pEnumDesktopWindows, fake_EnumDesktopWindows);
		DetourAttach(&(PVOID&)pLoadCursorFromFileA, fake_LoadCursorFromFileA);
		DetourAttach(&(PVOID&)pFindWindowA, fake_FindWindowA);
		DetourAttach(&(PVOID&)pBroadcastSystemMessageExA, fake_BroadcastSystemMessageExA);
		DetourAttach(&(PVOID&)pRealGetWindowClassA, fake_RealGetWindowClassA);
		DetourAttach(&(PVOID&)pGetMenuItemID, fake_GetMenuItemID);
		DetourAttach(&(PVOID&)pMessageBeep, fake_MessageBeep);
		DetourAttach(&(PVOID&)pMessageBoxExW, fake_MessageBoxExW);
		DetourAttach(&(PVOID&)pCallMsgFilterA, fake_CallMsgFilterA);
		DetourAttach(&(PVOID&)pLoadAcceleratorsA, fake_LoadAcceleratorsA);
		DetourAttach(&(PVOID&)pInsertMenuW, fake_InsertMenuW);
		DetourAttach(&(PVOID&)pRedrawWindow, fake_RedrawWindow);
		DetourAttach(&(PVOID&)pSystemParametersInfoA, fake_SystemParametersInfoA);
		DetourAttach(&(PVOID&)pSetLayeredWindowAttributes, fake_SetLayeredWindowAttributes);
		DetourAttach(&(PVOID&)pLockWindowUpdate, fake_LockWindowUpdate);
		DetourAttach(&(PVOID&)pDefWindowProcA, fake_DefWindowProcA);
		DetourAttach(&(PVOID&)pSetPhysicalCursorPos, fake_SetPhysicalCursorPos);
		DetourAttach(&(PVOID&)pDestroyAcceleratorTable, fake_DestroyAcceleratorTable);
		DetourAttach(&(PVOID&)pInvertRect, fake_InvertRect);
		DetourAttach(&(PVOID&)pIsDialogMessageW, fake_IsDialogMessageW);
		DetourAttach(&(PVOID&)pLookupIconIdFromDirectory, fake_LookupIconIdFromDirectory);
		DetourAttach(&(PVOID&)pSetDebugErrorLevel, fake_SetDebugErrorLevel);
		DetourAttach(&(PVOID&)pMessageBoxA, fake_MessageBoxA);
		DetourAttach(&(PVOID&)pFlashWindow, fake_FlashWindow);
		DetourAttach(&(PVOID&)pGetClassInfoExA, fake_GetClassInfoExA);
		DetourAttach(&(PVOID&)pDialogBoxParamA, fake_DialogBoxParamA);
		DetourAttach(&(PVOID&)pValidateRect, fake_ValidateRect);
		DetourAttach(&(PVOID&)pGetCaretBlinkTime, fake_GetCaretBlinkTime);
		DetourAttach(&(PVOID&)pInvalidateRect, fake_InvalidateRect);
		DetourAttach(&(PVOID&)pGetRawInputDeviceList, fake_GetRawInputDeviceList);
		DetourAttach(&(PVOID&)pGetMessageTime, fake_GetMessageTime);
		DetourAttach(&(PVOID&)pLoadCursorW, fake_LoadCursorW);
		DetourAttach(&(PVOID&)pGetSystemMetrics, fake_GetSystemMetrics);
		DetourAttach(&(PVOID&)pGetWindowModuleFileNameA, fake_GetWindowModuleFileNameA);
		DetourAttach(&(PVOID&)pDialogBoxIndirectParamW, fake_DialogBoxIndirectParamW);
		DetourAttach(&(PVOID&)pFindWindowExA, fake_FindWindowExA);
		DetourAttach(&(PVOID&)pShutdownBlockReasonDestroy, fake_ShutdownBlockReasonDestroy);
		DetourAttach(&(PVOID&)pSetCaretPos, fake_SetCaretPos);
		DetourAttach(&(PVOID&)pPtInRect, fake_PtInRect);
		DetourAttach(&(PVOID&)pUnhookWindowsHookEx, fake_UnhookWindowsHookEx);
		DetourAttach(&(PVOID&)pBroadcastSystemMessageW, fake_BroadcastSystemMessageW);
		DetourAttach(&(PVOID&)pGetMouseMovePointsEx, fake_GetMouseMovePointsEx);
		DetourAttach(&(PVOID&)pGetShellWindow, fake_GetShellWindow);
		DetourAttach(&(PVOID&)pGetClassNameA, fake_GetClassNameA);
		DetourAttach(&(PVOID&)pLoadMenuW, fake_LoadMenuW);
		DetourAttach(&(PVOID&)pShutdownBlockReasonCreate, fake_ShutdownBlockReasonCreate);
		DetourAttach(&(PVOID&)pSendDlgItemMessageW, fake_SendDlgItemMessageW);
		DetourAttach(&(PVOID&)pGetWindowRgnBox, fake_GetWindowRgnBox);
		DetourAttach(&(PVOID&)pInSendMessageEx, fake_InSendMessageEx);
		DetourAttach(&(PVOID&)pLoadImageW, fake_LoadImageW);
		DetourAttach(&(PVOID&)pDefRawInputProc, fake_DefRawInputProc);
		DetourAttach(&(PVOID&)pSetClipboardViewer, fake_SetClipboardViewer);
		DetourAttach(&(PVOID&)pTabbedTextOutW, fake_TabbedTextOutW);
		DetourAttach(&(PVOID&)pGetComboBoxInfo, fake_GetComboBoxInfo);
		DetourAttach(&(PVOID&)pGetInputState, fake_GetInputState);
		DetourAttach(&(PVOID&)pIsWow64Message, fake_IsWow64Message);
		DetourAttach(&(PVOID&)pIsCharUpperA, fake_IsCharUpperA);
		DetourAttach(&(PVOID&)pMessageBoxIndirectA, fake_MessageBoxIndirectA);
		DetourAttach(&(PVOID&)pCopyCursor, fake_CopyCursor);
		DetourAttach(&(PVOID&)pChangeDisplaySettingsExW, fake_ChangeDisplaySettingsExW);
		DetourAttach(&(PVOID&)pEndDeferWindowPos, fake_EndDeferWindowPos);
		DetourAttach(&(PVOID&)pTrackPopupMenu, fake_TrackPopupMenu);
		DetourAttach(&(PVOID&)pSetDisplayConfig, fake_SetDisplayConfig);
		DetourAttach(&(PVOID&)pCreateAcceleratorTableA, fake_CreateAcceleratorTableA);
		DetourAttach(&(PVOID&)pGetProcessWindowStation, fake_GetProcessWindowStation);
		DetourAttach(&(PVOID&)pSetWindowContextHelpId, fake_SetWindowContextHelpId);
		DetourAttach(&(PVOID&)pCreateDesktopExW, fake_CreateDesktopExW);
		DetourAttach(&(PVOID&)pGetDialogBaseUnits, fake_GetDialogBaseUnits);
		DetourAttach(&(PVOID&)pCreateWindowExW, fake_CreateWindowExW);
		DetourAttach(&(PVOID&)pGetMenuStringA, fake_GetMenuStringA);
		DetourAttach(&(PVOID&)pUserHandleGrantAccess, fake_UserHandleGrantAccess);
		DetourAttach(&(PVOID&)pRegisterHotKey, fake_RegisterHotKey);
		DetourAttach(&(PVOID&)pEqualRect, fake_EqualRect);
		DetourAttach(&(PVOID&)pSetMenuItemInfoA, fake_SetMenuItemInfoA);
		DetourAttach(&(PVOID&)pCharLowerA, fake_CharLowerA);
		DetourAttach(&(PVOID&)pSetProcessDPIAware, fake_SetProcessDPIAware);
		DetourAttach(&(PVOID&)pWaitForInputIdle, fake_WaitForInputIdle);
		DetourAttach(&(PVOID&)pCharToOemW, fake_CharToOemW);
		DetourAttach(&(PVOID&)pGetRawInputDeviceInfoW, fake_GetRawInputDeviceInfoW);
		DetourAttach(&(PVOID&)pTrackMouseEvent, fake_TrackMouseEvent);
		DetourAttach(&(PVOID&)pCharUpperBuffW, fake_CharUpperBuffW);
		DetourAttach(&(PVOID&)pPostThreadMessageW, fake_PostThreadMessageW);
		DetourAttach(&(PVOID&)pLoadKeyboardLayoutA, fake_LoadKeyboardLayoutA);
		DetourAttach(&(PVOID&)pRemovePropA, fake_RemovePropA);
		DetourAttach(&(PVOID&)pTabbedTextOutA, fake_TabbedTextOutA);
		DetourAttach(&(PVOID&)pGetActiveWindow, fake_GetActiveWindow);
		DetourAttach(&(PVOID&)pIsWindowVisible, fake_IsWindowVisible);
		DetourAttach(&(PVOID&)pGetTitleBarInfo, fake_GetTitleBarInfo);
		DetourAttach(&(PVOID&)pBroadcastSystemMessageA, fake_BroadcastSystemMessageA);
		DetourAttach(&(PVOID&)pSetForegroundWindow, fake_SetForegroundWindow);
		DetourAttach(&(PVOID&)pDispatchMessageA, fake_DispatchMessageA);
		DetourAttach(&(PVOID&)pRegisterPowerSettingNotification, fake_RegisterPowerSettingNotification);
		DetourAttach(&(PVOID&)pChangeWindowMessageFilter, fake_ChangeWindowMessageFilter);
		DetourAttach(&(PVOID&)pMapWindowPoints, fake_MapWindowPoints);
		DetourAttach(&(PVOID&)pGetTopWindow, fake_GetTopWindow);
		DetourAttach(&(PVOID&)pGetLayeredWindowAttributes, fake_GetLayeredWindowAttributes);
		DetourAttach(&(PVOID&)pRegisterClassA, fake_RegisterClassA);
		DetourAttach(&(PVOID&)pGetDlgItem, fake_GetDlgItem);
		DetourAttach(&(PVOID&)pPaintDesktop, fake_PaintDesktop);
		DetourAttach(&(PVOID&)pPhysicalToLogicalPoint, fake_PhysicalToLogicalPoint);
		DetourAttach(&(PVOID&)pGetMenu, fake_GetMenu);
		DetourAttach(&(PVOID&)pGetDCEx, fake_GetDCEx);
		DetourAttach(&(PVOID&)pCallWindowProcA, fake_CallWindowProcA);
		DetourAttach(&(PVOID&)pDialogBoxIndirectParamA, fake_DialogBoxIndirectParamA);
		DetourAttach(&(PVOID&)pGetMenuItemInfoW, fake_GetMenuItemInfoW);
		DetourAttach(&(PVOID&)pVkKeyScanW, fake_VkKeyScanW);
		DetourAttach(&(PVOID&)pInsertMenuA, fake_InsertMenuA);
		DetourAttach(&(PVOID&)pSetWindowsHookExW, fake_SetWindowsHookExW);
		DetourAttach(&(PVOID&)pGetUserObjectSecurity, fake_GetUserObjectSecurity);
		DetourAttach(&(PVOID&)pSetFocus, fake_SetFocus);
		DetourAttach(&(PVOID&)pSetThreadDesktop, fake_SetThreadDesktop);
		DetourAttach(&(PVOID&)pLogicalToPhysicalPoint, fake_LogicalToPhysicalPoint);
		DetourAttach(&(PVOID&)pSetWindowLongPtrW, fake_SetWindowLongPtrW);
		DetourAttach(&(PVOID&)pDefMDIChildProcA, fake_DefMDIChildProcA);
		DetourAttach(&(PVOID&)pShowOwnedPopups, fake_ShowOwnedPopups);
		DetourAttach(&(PVOID&)pGetProcessDefaultLayout, fake_GetProcessDefaultLayout);
		DetourAttach(&(PVOID&)pHideCaret, fake_HideCaret);
		DetourAttach(&(PVOID&)pEndDialog, fake_EndDialog);
		DetourAttach(&(PVOID&)pUnloadKeyboardLayout, fake_UnloadKeyboardLayout);
		DetourAttach(&(PVOID&)pSetClassLongW, fake_SetClassLongW);
		DetourAttach(&(PVOID&)pMapVirtualKeyExW, fake_MapVirtualKeyExW);
		DetourAttach(&(PVOID&)pSetWindowsHookExA, fake_SetWindowsHookExA);
		DetourAttach(&(PVOID&)pHiliteMenuItem, fake_HiliteMenuItem);
		DetourAttach(&(PVOID&)pCopyImage, fake_CopyImage);
		DetourAttach(&(PVOID&)pEnumDesktopsA, fake_EnumDesktopsA);
		DetourAttach(&(PVOID&)pCheckMenuRadioItem, fake_CheckMenuRadioItem);
		DetourAttach(&(PVOID&)pMsgWaitForMultipleObjectsEx, fake_MsgWaitForMultipleObjectsEx);
		DetourAttach(&(PVOID&)pInsertMenuItemW, fake_InsertMenuItemW);
		DetourAttach(&(PVOID&)pExcludeUpdateRgn, fake_ExcludeUpdateRgn);
		DetourAttach(&(PVOID&)pCloseTouchInputHandle, fake_CloseTouchInputHandle);
		DetourAttach(&(PVOID&)pUnionRect, fake_UnionRect);
		DetourAttach(&(PVOID&)pLoadCursorFromFileW, fake_LoadCursorFromFileW);
		DetourAttach(&(PVOID&)pPostQuitMessage, fake_PostQuitMessage);
		DetourAttach(&(PVOID&)pWindowFromPoint, fake_WindowFromPoint);
		DetourAttach(&(PVOID&)pCharToOemBuffW, fake_CharToOemBuffW);
		DetourAttach(&(PVOID&)pCreateWindowStationA, fake_CreateWindowStationA);
		DetourAttach(&(PVOID&)pBeginDeferWindowPos, fake_BeginDeferWindowPos);
		DetourAttach(&(PVOID&)pPeekMessageA, fake_PeekMessageA);
		DetourAttach(&(PVOID&)pGetNextDlgTabItem, fake_GetNextDlgTabItem);
		DetourAttach(&(PVOID&)pLoadStringA, fake_LoadStringA);
		DetourAttach(&(PVOID&)pGetClassInfoW, fake_GetClassInfoW);
		DetourAttach(&(PVOID&)pIsWinEventHookInstalled, fake_IsWinEventHookInstalled);
		DetourAttach(&(PVOID&)pGetWindowContextHelpId, fake_GetWindowContextHelpId);
		DetourAttach(&(PVOID&)pCreateMDIWindowA, fake_CreateMDIWindowA);
		DetourAttach(&(PVOID&)pDefDlgProcW, fake_DefDlgProcW);
		DetourAttach(&(PVOID&)pRegisterClipboardFormatA, fake_RegisterClipboardFormatA);
		DetourAttach(&(PVOID&)pSetWindowsHookA, fake_SetWindowsHookA);
		DetourAttach(&(PVOID&)pGetDC, fake_GetDC);
		DetourAttach(&(PVOID&)pDlgDirListComboBoxA, fake_DlgDirListComboBoxA);
		DetourAttach(&(PVOID&)pRegisterClassExA, fake_RegisterClassExA);
		DetourAttach(&(PVOID&)pSetPropA, fake_SetPropA);
		DetourAttach(&(PVOID&)pCreateDialogIndirectParamW, fake_CreateDialogIndirectParamW);
		DetourAttach(&(PVOID&)pToAscii, fake_ToAscii);
		DetourAttach(&(PVOID&)pSoundSentry, fake_SoundSentry);
		DetourAttach(&(PVOID&)pDrawTextW, fake_DrawTextW);
		DetourAttach(&(PVOID&)pSetWindowPos, fake_SetWindowPos);
		DetourAttach(&(PVOID&)pToUnicodeEx, fake_ToUnicodeEx);
		DetourAttach(&(PVOID&)pwvsprintfW, fake_wvsprintfW);
		DetourAttach(&(PVOID&)pSetScrollInfo, fake_SetScrollInfo);
		DetourAttach(&(PVOID&)pCreateWindowExA, fake_CreateWindowExA);
		DetourAttach(&(PVOID&)pGetClipboardFormatNameW, fake_GetClipboardFormatNameW);
		DetourAttach(&(PVOID&)pGetClipboardSequenceNumber, fake_GetClipboardSequenceNumber);
		DetourAttach(&(PVOID&)pDrawTextA, fake_DrawTextA);
		DetourAttach(&(PVOID&)pShowCaret, fake_ShowCaret);
		DetourAttach(&(PVOID&)pGetWindowLongA, fake_GetWindowLongA);
		DetourAttach(&(PVOID&)pSetSysColors, fake_SetSysColors);
		DetourAttach(&(PVOID&)pGetAncestor, fake_GetAncestor);
		DetourAttach(&(PVOID&)pLoadIconA, fake_LoadIconA);
		DetourAttach(&(PVOID&)pwsprintfW, fake_wsprintfW);
		DetourAttach(&(PVOID&)pUnregisterHotKey, fake_UnregisterHotKey);
		DetourAttach(&(PVOID&)pGetSubMenu, fake_GetSubMenu);
		DetourAttach(&(PVOID&)pCloseWindow, fake_CloseWindow);
		DetourAttach(&(PVOID&)pSendMessageCallbackA, fake_SendMessageCallbackA);
		DetourAttach(&(PVOID&)pRemoveMenu, fake_RemoveMenu);
		DetourAttach(&(PVOID&)pIsDialogMessageA, fake_IsDialogMessageA);
		DetourAttach(&(PVOID&)pLoadMenuA, fake_LoadMenuA);
		DetourAttach(&(PVOID&)pGetRawInputBuffer, fake_GetRawInputBuffer);
		DetourAttach(&(PVOID&)pSystemParametersInfoW, fake_SystemParametersInfoW);
		DetourAttach(&(PVOID&)pArrangeIconicWindows, fake_ArrangeIconicWindows);
		DetourAttach(&(PVOID&)pGetMenuState, fake_GetMenuState);
		DetourAttach(&(PVOID&)pGetClipCursor, fake_GetClipCursor);
		DetourAttach(&(PVOID&)pGetKeyNameTextA, fake_GetKeyNameTextA);
		DetourAttach(&(PVOID&)pCallMsgFilterW, fake_CallMsgFilterW);
		DetourAttach(&(PVOID&)pCloseGestureInfoHandle, fake_CloseGestureInfoHandle);
		DetourAttach(&(PVOID&)pScrollDC, fake_ScrollDC);
		DetourAttach(&(PVOID&)pKillTimer, fake_KillTimer);
		DetourAttach(&(PVOID&)pCreateDesktopExA, fake_CreateDesktopExA);
		DetourAttach(&(PVOID&)pDrawFrameControl, fake_DrawFrameControl);
		DetourAttach(&(PVOID&)pGrayStringA, fake_GrayStringA);
		DetourAttach(&(PVOID&)pIsWindowEnabled, fake_IsWindowEnabled);
		DetourAttach(&(PVOID&)pGetScrollBarInfo, fake_GetScrollBarInfo);
		DetourAttach(&(PVOID&)pGetGestureConfig, fake_GetGestureConfig);
		DetourAttach(&(PVOID&)pScrollWindowEx, fake_ScrollWindowEx);
		DetourAttach(&(PVOID&)pDestroyWindow, fake_DestroyWindow);
		DetourAttach(&(PVOID&)pWaitMessage, fake_WaitMessage);
		DetourAttach(&(PVOID&)pIsDlgButtonChecked, fake_IsDlgButtonChecked);
		DetourAttach(&(PVOID&)pEndTask, fake_EndTask);
		DetourAttach(&(PVOID&)pGetKeyState, fake_GetKeyState);
		DetourAttach(&(PVOID&)pLookupIconIdFromDirectoryEx, fake_LookupIconIdFromDirectoryEx);
		DetourAttach(&(PVOID&)pLockWorkStation, fake_LockWorkStation);
		DetourAttach(&(PVOID&)pUnhookWinEvent, fake_UnhookWinEvent);
		DetourAttach(&(PVOID&)pIsClipboardFormatAvailable, fake_IsClipboardFormatAvailable);
		DetourAttach(&(PVOID&)pGetCaretPos, fake_GetCaretPos);
		DetourAttach(&(PVOID&)pPrivateExtractIconsW, fake_PrivateExtractIconsW);
		DetourAttach(&(PVOID&)pDragDetect, fake_DragDetect);
		DetourAttach(&(PVOID&)pGetDlgCtrlID, fake_GetDlgCtrlID);
		DetourAttach(&(PVOID&)pGetWindowTextLengthA, fake_GetWindowTextLengthA);
		DetourAttach(&(PVOID&)pGetQueueStatus, fake_GetQueueStatus);
		DetourAttach(&(PVOID&)pGetIconInfoExW, fake_GetIconInfoExW);
		DetourAttach(&(PVOID&)pRemoveClipboardFormatListener, fake_RemoveClipboardFormatListener);
		DetourAttach(&(PVOID&)pGetSysColorBrush, fake_GetSysColorBrush);
		DetourAttach(&(PVOID&)pSendMessageTimeoutA, fake_SendMessageTimeoutA);
		DetourAttach(&(PVOID&)pSetKeyboardState, fake_SetKeyboardState);
		DetourAttach(&(PVOID&)pSetUserObjectSecurity, fake_SetUserObjectSecurity);
		DetourAttach(&(PVOID&)pOemToCharBuffW, fake_OemToCharBuffW);
		DetourAttach(&(PVOID&)pMsgWaitForMultipleObjects, fake_MsgWaitForMultipleObjects);
		DetourAttach(&(PVOID&)pWinHelpA, fake_WinHelpA);
		DetourAttach(&(PVOID&)pCreateMenu, fake_CreateMenu);
		DetourAttach(&(PVOID&)pDrawFocusRect, fake_DrawFocusRect);
		DetourAttach(&(PVOID&)pDispatchMessageW, fake_DispatchMessageW);
		DetourAttach(&(PVOID&)pChangeMenuA, fake_ChangeMenuA);
		DetourAttach(&(PVOID&)pCreateMDIWindowW, fake_CreateMDIWindowW);
		DetourAttach(&(PVOID&)pEnumDisplayDevicesW, fake_EnumDisplayDevicesW);
		DetourAttach(&(PVOID&)pMenuItemFromPoint, fake_MenuItemFromPoint);
		DetourAttach(&(PVOID&)pUnregisterClassA, fake_UnregisterClassA);
		DetourAttach(&(PVOID&)pDeregisterShellHookWindow, fake_DeregisterShellHookWindow);
		DetourAttach(&(PVOID&)pSetDoubleClickTime, fake_SetDoubleClickTime);
		DetourAttach(&(PVOID&)pSetProcessWindowStation, fake_SetProcessWindowStation);
		DetourAttach(&(PVOID&)pLoadAcceleratorsW, fake_LoadAcceleratorsW);
		DetourAttach(&(PVOID&)pEndMenu, fake_EndMenu);
		DetourAttach(&(PVOID&)pLoadBitmapW, fake_LoadBitmapW);
		DetourAttach(&(PVOID&)pGetRawInputDeviceInfoA, fake_GetRawInputDeviceInfoA);
		DetourAttach(&(PVOID&)pGetMenuItemInfoA, fake_GetMenuItemInfoA);
		DetourAttach(&(PVOID&)pDrawMenuBar, fake_DrawMenuBar);
		DetourAttach(&(PVOID&)pAppendMenuA, fake_AppendMenuA);
		DetourAttach(&(PVOID&)pSetSystemCursor, fake_SetSystemCursor);
		DetourAttach(&(PVOID&)pOpenWindowStationA, fake_OpenWindowStationA);
		DetourAttach(&(PVOID&)pGetScrollPos, fake_GetScrollPos);
		DetourAttach(&(PVOID&)pDestroyMenu, fake_DestroyMenu);
		DetourAttach(&(PVOID&)pSetScrollRange, fake_SetScrollRange);
		DetourAttach(&(PVOID&)pSendMessageW, fake_SendMessageW);
		DetourAttach(&(PVOID&)pDeleteMenu, fake_DeleteMenu);
		DetourAttach(&(PVOID&)pGetGUIThreadInfo, fake_GetGUIThreadInfo);
		DetourAttach(&(PVOID&)pGetUpdatedClipboardFormats, fake_GetUpdatedClipboardFormats);
		DetourAttach(&(PVOID&)pGetRegisteredRawInputDevices, fake_GetRegisteredRawInputDevices);
		DetourAttach(&(PVOID&)pSetCursorPos, fake_SetCursorPos);
		DetourAttach(&(PVOID&)pIsZoomed, fake_IsZoomed);
		DetourAttach(&(PVOID&)pGetClassLongPtrW, fake_GetClassLongPtrW);
		DetourAttach(&(PVOID&)pExitWindowsEx, fake_ExitWindowsEx);
		DetourAttach(&(PVOID&)pToUnicode, fake_ToUnicode);
		DetourAttach(&(PVOID&)pGetPropA, fake_GetPropA);
		DetourAttach(&(PVOID&)pGetUpdateRect, fake_GetUpdateRect);
		DetourAttach(&(PVOID&)pMapVirtualKeyExA, fake_MapVirtualKeyExA);
		DetourAttach(&(PVOID&)pSetWindowRgn, fake_SetWindowRgn);
		DetourAttach(&(PVOID&)pEnumDesktopsW, fake_EnumDesktopsW);
		DetourAttach(&(PVOID&)pGetDlgItemTextA, fake_GetDlgItemTextA);
		DetourAttach(&(PVOID&)pDisplayConfigSetDeviceInfo, fake_DisplayConfigSetDeviceInfo);
		DetourAttach(&(PVOID&)pGetWindowWord, fake_GetWindowWord);
		DetourAttach(&(PVOID&)pGetMessagePos, fake_GetMessagePos);
		DetourAttach(&(PVOID&)pCharPrevExA, fake_CharPrevExA);
		DetourAttach(&(PVOID&)pCharUpperBuffA, fake_CharUpperBuffA);
		DetourAttach(&(PVOID&)pGetMenuItemRect, fake_GetMenuItemRect);
		DetourAttach(&(PVOID&)pValidateRgn, fake_ValidateRgn);
		DetourAttach(&(PVOID&)pDestroyIcon, fake_DestroyIcon);
		DetourAttach(&(PVOID&)pOpenIcon, fake_OpenIcon);
		DetourAttach(&(PVOID&)pPostThreadMessageA, fake_PostThreadMessageA);
		DetourAttach(&(PVOID&)pSetClipboardData, fake_SetClipboardData);
		DetourAttach(&(PVOID&)pRegisterClipboardFormatW, fake_RegisterClipboardFormatW);
		DetourAttach(&(PVOID&)pShutdownBlockReasonQuery, fake_ShutdownBlockReasonQuery);
		DetourAttach(&(PVOID&)pMapVirtualKeyW, fake_MapVirtualKeyW);
		DetourAttach(&(PVOID&)pSendMessageTimeoutW, fake_SendMessageTimeoutW);
		DetourAttach(&(PVOID&)pReplyMessage, fake_ReplyMessage);
		DetourAttach(&(PVOID&)pCreateIconFromResource, fake_CreateIconFromResource);
		DetourAttach(&(PVOID&)pGetSysColor, fake_GetSysColor);
		DetourAttach(&(PVOID&)pGetIconInfoExA, fake_GetIconInfoExA);
		DetourAttach(&(PVOID&)pDrawTextExW, fake_DrawTextExW);
		DetourAttach(&(PVOID&)pGetWindowRect, fake_GetWindowRect);
		DetourAttach(&(PVOID&)pGetWindowLongPtrA, fake_GetWindowLongPtrA);
		DetourAttach(&(PVOID&)pCreateWindowStationW, fake_CreateWindowStationW);
		DetourAttach(&(PVOID&)pGetWindow, fake_GetWindow);
		DetourAttach(&(PVOID&)pChangeDisplaySettingsExA, fake_ChangeDisplaySettingsExA);
		DetourAttach(&(PVOID&)pSetCursor, fake_SetCursor);
		DetourAttach(&(PVOID&)pMapDialogRect, fake_MapDialogRect);
		DetourAttach(&(PVOID&)pSubtractRect, fake_SubtractRect);
		DetourAttach(&(PVOID&)pLockSetForegroundWindow, fake_LockSetForegroundWindow);
		DetourAttach(&(PVOID&)pUnregisterClassW, fake_UnregisterClassW);
		DetourAttach(&(PVOID&)pEnumDisplaySettingsA, fake_EnumDisplaySettingsA);
		DetourAttach(&(PVOID&)pSetLastErrorEx, fake_SetLastErrorEx);
		DetourAttach(&(PVOID&)pGetMonitorInfoW, fake_GetMonitorInfoW);
		DetourAttach(&(PVOID&)pCreateIconIndirect, fake_CreateIconIndirect);
		DetourAttach(&(PVOID&)pDisableProcessWindowsGhosting, fake_DisableProcessWindowsGhosting);
		DetourAttach(&(PVOID&)pRegisterTouchWindow, fake_RegisterTouchWindow);
		DetourAttach(&(PVOID&)pDragObject, fake_DragObject);
		DetourAttach(&(PVOID&)pReleaseCapture, fake_ReleaseCapture);
		DetourAttach(&(PVOID&)pScreenToClient, fake_ScreenToClient);
		DetourAttach(&(PVOID&)pFindWindowExW, fake_FindWindowExW);
		DetourAttach(&(PVOID&)pDlgDirListA, fake_DlgDirListA);
		DetourAttach(&(PVOID&)pWindowFromDC, fake_WindowFromDC);
		DetourAttach(&(PVOID&)pUpdateLayeredWindow, fake_UpdateLayeredWindow);
		DetourAttach(&(PVOID&)pRegisterClassExW, fake_RegisterClassExW);
		DetourAttach(&(PVOID&)pGetWindowTextLengthW, fake_GetWindowTextLengthW);
		DetourAttach(&(PVOID&)pCreateDesktopA, fake_CreateDesktopA);
		DetourAttach(&(PVOID&)pFillRect, fake_FillRect);
		DetourAttach(&(PVOID&)pMoveWindow, fake_MoveWindow);
		DetourAttach(&(PVOID&)pSetDlgItemTextW, fake_SetDlgItemTextW);
		DetourAttach(&(PVOID&)pDrawStateW, fake_DrawStateW);
		DetourAttach(&(PVOID&)pLoadIconW, fake_LoadIconW);
		DetourAttach(&(PVOID&)pIsWindowUnicode, fake_IsWindowUnicode);
		DetourAttach(&(PVOID&)pDrawStateA, fake_DrawStateA);
		DetourAttach(&(PVOID&)pRealGetWindowClassW, fake_RealGetWindowClassW);
		DetourAttach(&(PVOID&)pCheckDlgButton, fake_CheckDlgButton);
		DetourAttach(&(PVOID&)pGetWindowTextA, fake_GetWindowTextA);
		DetourAttach(&(PVOID&)pMonitorFromWindow, fake_MonitorFromWindow);
		DetourAttach(&(PVOID&)pDefWindowProcW, fake_DefWindowProcW);
		DetourAttach(&(PVOID&)pIsWindow, fake_IsWindow);
		DetourAttach(&(PVOID&)pSendDlgItemMessageA, fake_SendDlgItemMessageA);
		DetourAttach(&(PVOID&)pCreateIconFromResourceEx, fake_CreateIconFromResourceEx);
		DetourAttach(&(PVOID&)pGetClipboardData, fake_GetClipboardData);
		DetourAttach(&(PVOID&)pSendInput, fake_SendInput);
		DetourAttach(&(PVOID&)pNotifyWinEvent, fake_NotifyWinEvent);
		DetourAttach(&(PVOID&)pGetWindowModuleFileNameW, fake_GetWindowModuleFileNameW);
		DetourAttach(&(PVOID&)pEnableScrollBar, fake_EnableScrollBar);
		DetourAttach(&(PVOID&)pSendMessageCallbackW, fake_SendMessageCallbackW);
		DetourAttach(&(PVOID&)pClientToScreen, fake_ClientToScreen);
		DetourAttach(&(PVOID&)pEnumThreadWindows, fake_EnumThreadWindows);
		DetourAttach(&(PVOID&)pSetScrollPos, fake_SetScrollPos);
		DetourAttach(&(PVOID&)pGetWindowLongW, fake_GetWindowLongW);
		DetourAttach(&(PVOID&)pSetWindowDisplayAffinity, fake_SetWindowDisplayAffinity);
		DetourAttach(&(PVOID&)pTranslateAcceleratorW, fake_TranslateAcceleratorW);
		DetourAttach(&(PVOID&)pDlgDirListW, fake_DlgDirListW);
		DetourAttach(&(PVOID&)pDialogBoxParamW, fake_DialogBoxParamW);
		DetourAttach(&(PVOID&)pGetClipboardOwner, fake_GetClipboardOwner);
		DetourAttach(&(PVOID&)pMessageBoxIndirectW, fake_MessageBoxIndirectW);
		DetourAttach(&(PVOID&)pGetCursor, fake_GetCursor);
		DetourAttach(&(PVOID&)pSetClassLongA, fake_SetClassLongA);
		DetourAttach(&(PVOID&)pSetMessageQueue, fake_SetMessageQueue);
		DetourAttach(&(PVOID&)pCharToOemBuffA, fake_CharToOemBuffA);
		DetourAttach(&(PVOID&)pAdjustWindowRect, fake_AdjustWindowRect);
		DetourAttach(&(PVOID&)pGetMenuStringW, fake_GetMenuStringW);
		DetourAttach(&(PVOID&)pRegisterClassW, fake_RegisterClassW);
		DetourAttach(&(PVOID&)pInsertMenuItemA, fake_InsertMenuItemA);
		DetourAttach(&(PVOID&)pGetWindowPlacement, fake_GetWindowPlacement);
		DetourAttach(&(PVOID&)pSetWindowLongW, fake_SetWindowLongW);
		DetourAttach(&(PVOID&)pSetPropW, fake_SetPropW);
		DetourAttach(&(PVOID&)pInternalGetWindowText, fake_InternalGetWindowText);
		DetourAttach(&(PVOID&)pIsCharAlphaNumericA, fake_IsCharAlphaNumericA);
		DetourAttach(&(PVOID&)pShowWindowAsync, fake_ShowWindowAsync);
		DetourAttach(&(PVOID&)pEnumWindowStationsA, fake_EnumWindowStationsA);
		DetourAttach(&(PVOID&)pGetUserObjectInformationW, fake_GetUserObjectInformationW);
		DetourAttach(&(PVOID&)pCallNextHookEx, fake_CallNextHookEx);
		DetourAttach(&(PVOID&)pFrameRect, fake_FrameRect);
		DetourAttach(&(PVOID&)pGetPriorityClipboardFormat, fake_GetPriorityClipboardFormat);
		DetourAttach(&(PVOID&)pSetWindowsHookW, fake_SetWindowsHookW);
		DetourAttach(&(PVOID&)pSetMenuItemInfoW, fake_SetMenuItemInfoW);
		DetourAttach(&(PVOID&)pCreateDialogIndirectParamA, fake_CreateDialogIndirectParamA);
		DetourAttach(&(PVOID&)pRegisterRawInputDevices, fake_RegisterRawInputDevices);
		DetourAttach(&(PVOID&)pSetClassWord, fake_SetClassWord);
		DetourAttach(&(PVOID&)pDrawAnimatedRects, fake_DrawAnimatedRects);
		DetourAttach(&(PVOID&)pUnregisterPowerSettingNotification, fake_UnregisterPowerSettingNotification);
		DetourAttach(&(PVOID&)pGetClipboardViewer, fake_GetClipboardViewer);
		DetourAttach(&(PVOID&)pGetClassLongW, fake_GetClassLongW);
		DetourAttach(&(PVOID&)pShowCursor, fake_ShowCursor);
		DetourAttach(&(PVOID&)pMonitorFromPoint, fake_MonitorFromPoint);
		DetourAttach(&(PVOID&)pDlgDirSelectComboBoxExW, fake_DlgDirSelectComboBoxExW);
		DetourAttach(&(PVOID&)pCloseClipboard, fake_CloseClipboard);
		DetourAttach(&(PVOID&)pEnumDisplaySettingsExW, fake_EnumDisplaySettingsExW);
		DetourAttach(&(PVOID&)pGetMenuBarInfo, fake_GetMenuBarInfo);
		DetourAttach(&(PVOID&)pDisplayConfigGetDeviceInfo, fake_DisplayConfigGetDeviceInfo);
		DetourAttach(&(PVOID&)pCreateDesktopW, fake_CreateDesktopW);
		DetourAttach(&(PVOID&)pSetMenu, fake_SetMenu);
		DetourAttach(&(PVOID&)pDefFrameProcW, fake_DefFrameProcW);
		DetourAttach(&(PVOID&)pSetWindowWord, fake_SetWindowWord);
		DetourAttach(&(PVOID&)pGetKeyboardLayoutNameW, fake_GetKeyboardLayoutNameW);
		DetourAttach(&(PVOID&)pCloseDesktop, fake_CloseDesktop);
		DetourAttach(&(PVOID&)pSetProcessDefaultLayout, fake_SetProcessDefaultLayout);
		DetourAttach(&(PVOID&)pGetAsyncKeyState, fake_GetAsyncKeyState);
		DetourAttach(&(PVOID&)pIsCharUpperW, fake_IsCharUpperW);
		DetourAttach(&(PVOID&)pIsCharAlphaW, fake_IsCharAlphaW);
		DetourAttach(&(PVOID&)pEnumDisplaySettingsExA, fake_EnumDisplaySettingsExA);
		DetourAttach(&(PVOID&)pCharUpperW, fake_CharUpperW);
		DetourAttach(&(PVOID&)pTranslateMessage, fake_TranslateMessage);
		DetourAttach(&(PVOID&)pCreateIcon, fake_CreateIcon);
		DetourAttach(&(PVOID&)pCharNextA, fake_CharNextA);
		DetourAttach(&(PVOID&)pSendNotifyMessageW, fake_SendNotifyMessageW);
		DetourAttach(&(PVOID&)pEnumPropsW, fake_EnumPropsW);
		DetourAttach(&(PVOID&)pGetForegroundWindow, fake_GetForegroundWindow);
		DetourAttach(&(PVOID&)pGetMonitorInfoA, fake_GetMonitorInfoA);
		DetourAttach(&(PVOID&)pIsGUIThread, fake_IsGUIThread);
		DetourAttach(&(PVOID&)pCharNextW, fake_CharNextW);
		DetourAttach(&(PVOID&)pGetLastActivePopup, fake_GetLastActivePopup);
		DetourAttach(&(PVOID&)pEnumChildWindows, fake_EnumChildWindows);
		DetourAttach(&(PVOID&)pGetSystemMenu, fake_GetSystemMenu);
		DetourAttach(&(PVOID&)pIsCharAlphaNumericW, fake_IsCharAlphaNumericW);
		DetourAttach(&(PVOID&)pRegisterShellHookWindow, fake_RegisterShellHookWindow);
		DetourAttach(&(PVOID&)pOpenClipboard, fake_OpenClipboard);
		DetourAttach(&(PVOID&)pCopyAcceleratorTableA, fake_CopyAcceleratorTableA);
		DetourAttach(&(PVOID&)pGetGestureInfo, fake_GetGestureInfo);
		DetourAttach(&(PVOID&)pCreateCursor, fake_CreateCursor);
		DetourAttach(&(PVOID&)pGetWindowInfo, fake_GetWindowInfo);
		DetourAttach(&(PVOID&)pOemToCharW, fake_OemToCharW);
		DetourAttach(&(PVOID&)pGetWindowTextW, fake_GetWindowTextW);
		DetourAttach(&(PVOID&)pDrawTextExA, fake_DrawTextExA);
		DetourAttach(&(PVOID&)pDlgDirSelectExW, fake_DlgDirSelectExW);
		DetourAttach(&(PVOID&)pSetTimer, fake_SetTimer);
		DetourAttach(&(PVOID&)pGetMenuCheckMarkDimensions, fake_GetMenuCheckMarkDimensions);
		DetourAttach(&(PVOID&)pPrivateExtractIconsA, fake_PrivateExtractIconsA);
		DetourAttach(&(PVOID&)pIsCharLowerW, fake_IsCharLowerW);
		DetourAttach(&(PVOID&)pAdjustWindowRectEx, fake_AdjustWindowRectEx);
		DetourAttach(&(PVOID&)pkeybd_event, fake_keybd_event);
		DetourAttach(&(PVOID&)pIsHungAppWindow, fake_IsHungAppWindow);
		DetourAttach(&(PVOID&)pVkKeyScanA, fake_VkKeyScanA);
		DetourAttach(&(PVOID&)pRealChildWindowFromPoint, fake_RealChildWindowFromPoint);
		DetourAttach(&(PVOID&)pWindowFromPhysicalPoint, fake_WindowFromPhysicalPoint);
		DetourAttach(&(PVOID&)pOpenDesktopA, fake_OpenDesktopA);
		DetourAttach(&(PVOID&)pGetWindowLongPtrW, fake_GetWindowLongPtrW);
		DetourAttach(&(PVOID&)pEmptyClipboard, fake_EmptyClipboard);
		DetourAttach(&(PVOID&)pGetMenuContextHelpId, fake_GetMenuContextHelpId);
		DetourAttach(&(PVOID&)pEnumPropsExW, fake_EnumPropsExW);
		DetourAttach(&(PVOID&)pInvalidateRgn, fake_InvalidateRgn);
		DetourAttach(&(PVOID&)pTranslateAcceleratorA, fake_TranslateAcceleratorA);
		DetourAttach(&(PVOID&)pwvsprintfA, fake_wvsprintfA);
		DetourAttach(&(PVOID&)pDefDlgProcA, fake_DefDlgProcA);
		DetourAttach(&(PVOID&)pGetTouchInputInfo, fake_GetTouchInputInfo);
		DetourAttach(&(PVOID&)pGetPhysicalCursorPos, fake_GetPhysicalCursorPos);
		DetourAttach(&(PVOID&)pGetDesktopWindow, fake_GetDesktopWindow);
		DetourAttach(&(PVOID&)pGetScrollRange, fake_GetScrollRange);
		DetourAttach(&(PVOID&)pDefFrameProcA, fake_DefFrameProcA);
		DetourAttach(&(PVOID&)pGetKeyboardLayoutList, fake_GetKeyboardLayoutList);
		DetourAttach(&(PVOID&)pDlgDirListComboBoxW, fake_DlgDirListComboBoxW);
		DetourAttach(&(PVOID&)pSetMenuDefaultItem, fake_SetMenuDefaultItem);
		DetourAttach(&(PVOID&)pIsMenu, fake_IsMenu);
		DetourAttach(&(PVOID&)pAttachThreadInput, fake_AttachThreadInput);
		DetourAttach(&(PVOID&)pLoadImageA, fake_LoadImageA);
		DetourAttach(&(PVOID&)pGetTabbedTextExtentA, fake_GetTabbedTextExtentA);
		DetourAttach(&(PVOID&)pGrayStringW, fake_GrayStringW);
		DetourAttach(&(PVOID&)pSetWindowTextA, fake_SetWindowTextA);
		DetourAttach(&(PVOID&)pGetWindowDC, fake_GetWindowDC);
		DetourAttach(&(PVOID&)pCheckRadioButton, fake_CheckRadioButton);
		DetourAttach(&(PVOID&)pOemToCharA, fake_OemToCharA);
		DetourAttach(&(PVOID&)pCascadeWindows, fake_CascadeWindows);
		DetourAttach(&(PVOID&)pFindWindowW, fake_FindWindowW);
		DetourAttach(&(PVOID&)pGetListBoxInfo, fake_GetListBoxInfo);
		DetourAttach(&(PVOID&)pSetActiveWindow, fake_SetActiveWindow);
		DetourAttach(&(PVOID&)pEndPaint, fake_EndPaint);
		DetourAttach(&(PVOID&)pEnableWindow, fake_EnableWindow);
		DetourAttach(&(PVOID&)pGetLastInputInfo, fake_GetLastInputInfo);
		DetourAttach(&(PVOID&)pGetDlgItemInt, fake_GetDlgItemInt);
		DetourAttach(&(PVOID&)pGetClassInfoA, fake_GetClassInfoA);
		DetourAttach(&(PVOID&)pGetUserObjectInformationA, fake_GetUserObjectInformationA);
		DetourAttach(&(PVOID&)pGetDisplayConfigBufferSizes, fake_GetDisplayConfigBufferSizes);
		DetourAttach(&(PVOID&)pLoadStringW, fake_LoadStringW);
		DetourAttach(&(PVOID&)pDestroyCaret, fake_DestroyCaret);
		DetourAttach(&(PVOID&)pGetMessageA, fake_GetMessageA);
		DetourAttach(&(PVOID&)pUnregisterTouchWindow, fake_UnregisterTouchWindow);
		DetourAttach(&(PVOID&)pUpdateWindow, fake_UpdateWindow);
		DetourAttach(&(PVOID&)pOffsetRect, fake_OffsetRect);
		DetourAttach(&(PVOID&)pGetClipboardFormatNameA, fake_GetClipboardFormatNameA);
		DetourAttach(&(PVOID&)pBroadcastSystemMessageExW, fake_BroadcastSystemMessageExW);
		DetourAttach(&(PVOID&)pUnregisterDeviceNotification, fake_UnregisterDeviceNotification);
		DetourAttach(&(PVOID&)pBlockInput, fake_BlockInput);
		DetourAttach(&(PVOID&)pGetKeyNameTextW, fake_GetKeyNameTextW);
		DetourAttach(&(PVOID&)pCreateDialogParamW, fake_CreateDialogParamW);
		DetourAttach(&(PVOID&)pGetRawInputData, fake_GetRawInputData);
		DetourAttach(&(PVOID&)pLoadMenuIndirectW, fake_LoadMenuIndirectW);
		DetourAttach(&(PVOID&)pRegisterWindowMessageA, fake_RegisterWindowMessageA);
		DetourAttach(&(PVOID&)pBringWindowToTop, fake_BringWindowToTop);
		DetourAttach(&(PVOID&)pGetDlgItemTextW, fake_GetDlgItemTextW);
		DetourAttach(&(PVOID&)pTrackPopupMenuEx, fake_TrackPopupMenuEx);
		DetourAttach(&(PVOID&)pMessageBoxExA, fake_MessageBoxExA);
		DetourAttach(&(PVOID&)pGetPropW, fake_GetPropW);
		DetourAttach(&(PVOID&)pEnumDisplaySettingsW, fake_EnumDisplaySettingsW);
		DetourAttach(&(PVOID&)pGetClassWord, fake_GetClassWord);
		DetourAttach(&(PVOID&)pPostMessageA, fake_PostMessageA);
		DetourAttach(&(PVOID&)pSetDlgItemTextA, fake_SetDlgItemTextA);
		DetourAttach(&(PVOID&)pMessageBoxW, fake_MessageBoxW);
		DetourAttach(&(PVOID&)pCreatePopupMenu, fake_CreatePopupMenu);
		DetourAttach(&(PVOID&)pReleaseDC, fake_ReleaseDC);
		DetourAttach(&(PVOID&)pmouse_event, fake_mouse_event);
		DetourAttach(&(PVOID&)pSetRect, fake_SetRect);
		DetourAttach(&(PVOID&)pLoadBitmapA, fake_LoadBitmapA);
		DetourAttach(&(PVOID&)pCharPrevA, fake_CharPrevA);
		DetourAttach(&(PVOID&)pGetClassNameW, fake_GetClassNameW);
		DetourAttach(&(PVOID&)pGetKeyboardLayoutNameA, fake_GetKeyboardLayoutNameA);
		DetourAttach(&(PVOID&)pSetWindowTextW, fake_SetWindowTextW);
		DetourAttach(&(PVOID&)pGetClientRect, fake_GetClientRect);
		DetourAttach(&(PVOID&)pGetMenuDefaultItem, fake_GetMenuDefaultItem);
		DetourAttach(&(PVOID&)pUpdateLayeredWindowIndirect, fake_UpdateLayeredWindowIndirect);
		DetourAttach(&(PVOID&)pChangeDisplaySettingsA, fake_ChangeDisplaySettingsA);
		DetourAttach(&(PVOID&)pWinHelpW, fake_WinHelpW);
		DetourAttach(&(PVOID&)pCreateAcceleratorTableW, fake_CreateAcceleratorTableW);
		DetourAttach(&(PVOID&)pGetMessageW, fake_GetMessageW);
		DetourAttach(&(PVOID&)pSetCapture, fake_SetCapture);
		DetourAttach(&(PVOID&)pIsProcessDPIAware, fake_IsProcessDPIAware);
		DetourAttach(&(PVOID&)pIntersectRect, fake_IntersectRect);
		DetourAttach(&(PVOID&)pGetCursorInfo, fake_GetCursorInfo);
		DetourAttach(&(PVOID&)pSetWindowLongA, fake_SetWindowLongA);
		DetourAttach(&(PVOID&)pSwitchDesktop, fake_SwitchDesktop);
		DetourAttach(&(PVOID&)pRemovePropW, fake_RemovePropW);
		DetourAttach(&(PVOID&)pDeferWindowPos, fake_DeferWindowPos);
		DetourAttach(&(PVOID&)pGetThreadDesktop, fake_GetThreadDesktop);
		DetourAttach(&(PVOID&)pSetMenuContextHelpId, fake_SetMenuContextHelpId);
		DetourAttach(&(PVOID&)pCharNextExA, fake_CharNextExA);
		DetourAttach(&(PVOID&)pGetKBCodePage, fake_GetKBCodePage);
		DetourAttach(&(PVOID&)pSetClassLongPtrW, fake_SetClassLongPtrW);
		DetourAttach(&(PVOID&)pGetClassLongA, fake_GetClassLongA);
		DetourAttach(&(PVOID&)pRegisterDeviceNotificationA, fake_RegisterDeviceNotificationA);
		DetourAttach(&(PVOID&)pCharPrevW, fake_CharPrevW);
		DetourAttach(&(PVOID&)pGetParent, fake_GetParent);
		DetourAttach(&(PVOID&)pBroadcastSystemMessage, fake_BroadcastSystemMessage);
		DetourAttach(&(PVOID&)pMapVirtualKeyA, fake_MapVirtualKeyA);
		DetourAttach(&(PVOID&)pIsIconic, fake_IsIconic);
		DetourAttach(&(PVOID&)pCopyAcceleratorTableW, fake_CopyAcceleratorTableW);
		DetourAttach(&(PVOID&)pCreateCaret, fake_CreateCaret);
		DetourAttach(&(PVOID&)pIsChild, fake_IsChild);
		DetourAttach(&(PVOID&)pTileWindows, fake_TileWindows);
		DetourAttach(&(PVOID&)pPeekMessageW, fake_PeekMessageW);
		DetourAttach(&(PVOID&)pGetScrollInfo, fake_GetScrollInfo);
		DetourAttach(&(PVOID&)pAnyPopup, fake_AnyPopup);
		DetourAttach(&(PVOID&)pAddClipboardFormatListener, fake_AddClipboardFormatListener);
		DetourAttach(&(PVOID&)pChangeDisplaySettingsW, fake_ChangeDisplaySettingsW);
		DetourAttach(&(PVOID&)pCheckMenuItem, fake_CheckMenuItem);
		DetourAttach(&(PVOID&)pSetWinEventHook, fake_SetWinEventHook);
		DetourAttach(&(PVOID&)pGetMessageExtraInfo, fake_GetMessageExtraInfo);
		DetourAttach(&(PVOID&)pShowWindow, fake_ShowWindow);
		DetourAttach(&(PVOID&)pGetGestureExtraArgs, fake_GetGestureExtraArgs);
		DetourAttach(&(PVOID&)pGetAltTabInfoW, fake_GetAltTabInfoW);
		DetourAttach(&(PVOID&)pPostMessageW, fake_PostMessageW);
		DetourAttach(&(PVOID&)pGetWindowDisplayAffinity, fake_GetWindowDisplayAffinity);
		DetourAttach(&(PVOID&)pSwapMouseButton, fake_SwapMouseButton);
		DetourAttach(&(PVOID&)pSetRectEmpty, fake_SetRectEmpty);
		DetourAttach(&(PVOID&)pCharUpperA, fake_CharUpperA);
		DetourAttach(&(PVOID&)pLoadKeyboardLayoutW, fake_LoadKeyboardLayoutW);
		DetourAttach(&(PVOID&)pDrawIcon, fake_DrawIcon);
		DetourAttach(&(PVOID&)pUnhookWindowsHook, fake_UnhookWindowsHook);
		DetourAttach(&(PVOID&)pGetAltTabInfoA, fake_GetAltTabInfoA);
		DetourAttach(&(PVOID&)pOpenInputDesktop, fake_OpenInputDesktop);
		DetourAttach(&(PVOID&)pChildWindowFromPoint, fake_ChildWindowFromPoint);
		DetourAttach(&(PVOID&)pVkKeyScanExA, fake_VkKeyScanExA);
		DetourAttach(&(PVOID&)pSendMessageA, fake_SendMessageA);
		DetourAttach(&(PVOID&)pSetWindowPlacement, fake_SetWindowPlacement);
		DetourAttach(&(PVOID&)pSendNotifyMessageA, fake_SendNotifyMessageA);
		DetourAttach(&(PVOID&)pEnumDisplayDevicesA, fake_EnumDisplayDevicesA);
		DetourAttach(&(PVOID&)pLoadCursorA, fake_LoadCursorA);
		DetourAttach(&(PVOID&)pOpenWindowStationW, fake_OpenWindowStationW);
		DetourAttach(&(PVOID&)pCopyRect, fake_CopyRect);
		DetourAttach(&(PVOID&)pModifyMenuW, fake_ModifyMenuW);
		DetourAttach(&(PVOID&)pAppendMenuW, fake_AppendMenuW);
		DetourAttach(&(PVOID&)pEnumDisplayMonitors, fake_EnumDisplayMonitors);
		DetourAttach(&(PVOID&)pEnumWindowStationsW, fake_EnumWindowStationsW);
		DetourAttach(&(PVOID&)pGetKeyboardState, fake_GetKeyboardState);
		DetourAttach(&(PVOID&)pGetKeyboardLayout, fake_GetKeyboardLayout);
		DetourAttach(&(PVOID&)pCharLowerBuffW, fake_CharLowerBuffW);
		DetourAttach(&(PVOID&)pOemKeyScan, fake_OemKeyScan);
		DetourAttach(&(PVOID&)pChangeWindowMessageFilterEx, fake_ChangeWindowMessageFilterEx);
		DetourAttach(&(PVOID&)pIsRectEmpty, fake_IsRectEmpty);
		DetourAttach(&(PVOID&)pCancelShutdown, fake_CancelShutdown);
		DetourAttach(&(PVOID&)pwsprintfA, fake_wsprintfA);
		DetourAttach(&(PVOID&)pSetMenuItemBitmaps, fake_SetMenuItemBitmaps);
		DetourAttach(&(PVOID&)pAllowSetForegroundWindow, fake_AllowSetForegroundWindow);
		DetourAttach(&(PVOID&)pCopyIcon, fake_CopyIcon);
		DetourAttach(&(PVOID&)pInSendMessage, fake_InSendMessage);
		DetourAttach(&(PVOID&)pScrollWindow, fake_ScrollWindow);
		DetourAttach(&(PVOID&)pGetWindowRgn, fake_GetWindowRgn);
		DetourAttach(&(PVOID&)pBeginPaint, fake_BeginPaint);
		DetourAttach(&(PVOID&)pChangeClipboardChain, fake_ChangeClipboardChain);
		DetourAttach(&(PVOID&)pGetWindowThreadProcessId, fake_GetWindowThreadProcessId);
		DetourAttach(&(PVOID&)pCharLowerBuffA, fake_CharLowerBuffA);
		DetourAttach(&(PVOID&)pRegisterWindowMessageW, fake_RegisterWindowMessageW);
		DetourAttach(&(PVOID&)pQueryDisplayConfig, fake_QueryDisplayConfig);
		DetourAttach(&(PVOID&)pInflateRect, fake_InflateRect);
		DetourAttach(&(PVOID&)pClipCursor, fake_ClipCursor);
		DetourAttach(&(PVOID&)pDlgDirSelectExA, fake_DlgDirSelectExA);
		DetourAttach(&(PVOID&)pGetClassLongPtrA, fake_GetClassLongPtrA);
		DetourAttach(&(PVOID&)pGetTabbedTextExtentW, fake_GetTabbedTextExtentW);
		DetourAttach(&(PVOID&)pSetWindowLongPtrA, fake_SetWindowLongPtrA);
		DetourAttach(&(PVOID&)pShowScrollBar, fake_ShowScrollBar);
		DetourAttach(&(PVOID&)pMonitorFromRect, fake_MonitorFromRect);
		DetourAttach(&(PVOID&)pActivateKeyboardLayout, fake_ActivateKeyboardLayout);
		DetourAttach(&(PVOID&)pSetGestureConfig, fake_SetGestureConfig);
		DetourAttach(&(PVOID&)pLoadMenuIndirectA, fake_LoadMenuIndirectA);
		DetourAttach(&(PVOID&)pOpenDesktopW, fake_OpenDesktopW);
		DetourAttach(&(PVOID&)pEnumClipboardFormats, fake_EnumClipboardFormats);
		DetourAttach(&(PVOID&)pToAsciiEx, fake_ToAsciiEx);
		DetourAttach(&(PVOID&)pSetClassLongPtrA, fake_SetClassLongPtrA);
		DetourAttach(&(PVOID&)pSetCaretBlinkTime, fake_SetCaretBlinkTime);
		DetourAttach(&(PVOID&)pGetCapture, fake_GetCapture);
		DetourAttach(&(PVOID&)pSwitchToThisWindow, fake_SwitchToThisWindow);
		DetourAttach(&(PVOID&)pSetUserObjectInformationA, fake_SetUserObjectInformationA);
		DetourAttach(&(PVOID&)pCalculatePopupWindowPosition, fake_CalculatePopupWindowPosition);
		DetourAttach(&(PVOID&)pEnumPropsExA, fake_EnumPropsExA);
		DetourAttach(&(PVOID&)pChangeMenuW, fake_ChangeMenuW);
		DetourAttach(&(PVOID&)pCloseWindowStation, fake_CloseWindowStation);
		DetourAttach(&(PVOID&)pRegisterDeviceNotificationW, fake_RegisterDeviceNotificationW);
		DetourAttach(&(PVOID&)pModifyMenuA, fake_ModifyMenuA);
		DetourAttach(&(PVOID&)pDlgDirSelectComboBoxExA, fake_DlgDirSelectComboBoxExA);
		DetourAttach(&(PVOID&)pGetIconInfo, fake_GetIconInfo);
		DetourAttach(&(PVOID&)pIsCharLowerA, fake_IsCharLowerA);
 
        DetourTransactionCommit();  
    }  
    else if (dwReason == DLL_PROCESS_DETACH) {  
        DetourTransactionBegin();  
        DetourUpdateThread(GetCurrentThread());  
		DetourDetach(&(PVOID&)pGetUpdateRgn, fake_GetUpdateRgn);
		DetourDetach(&(PVOID&)pCallWindowProcW, fake_CallWindowProcW);
		DetourDetach(&(PVOID&)pVkKeyScanExW, fake_VkKeyScanExW);
		DetourDetach(&(PVOID&)pGetKeyboardType, fake_GetKeyboardType);
		DetourDetach(&(PVOID&)pPrintWindow, fake_PrintWindow);
		DetourDetach(&(PVOID&)pIsCharAlphaA, fake_IsCharAlphaA);
		DetourDetach(&(PVOID&)pGetDoubleClickTime, fake_GetDoubleClickTime);
		DetourDetach(&(PVOID&)pDrawEdge, fake_DrawEdge);
		DetourDetach(&(PVOID&)pDestroyCursor, fake_DestroyCursor);
		DetourDetach(&(PVOID&)pSetMessageExtraInfo, fake_SetMessageExtraInfo);
		DetourDetach(&(PVOID&)pIsTouchWindow, fake_IsTouchWindow);
		DetourDetach(&(PVOID&)pGetCursorPos, fake_GetCursorPos);
		DetourDetach(&(PVOID&)pEnableMenuItem, fake_EnableMenuItem);
		DetourDetach(&(PVOID&)pCharLowerW, fake_CharLowerW);
		DetourDetach(&(PVOID&)pGetFocus, fake_GetFocus);
		DetourDetach(&(PVOID&)pCharToOemA, fake_CharToOemA);
		DetourDetach(&(PVOID&)pGetOpenClipboardWindow, fake_GetOpenClipboardWindow);
		DetourDetach(&(PVOID&)pEnumPropsA, fake_EnumPropsA);
		DetourDetach(&(PVOID&)pDefMDIChildProcW, fake_DefMDIChildProcW);
		DetourDetach(&(PVOID&)pSetParent, fake_SetParent);
		DetourDetach(&(PVOID&)pFlashWindowEx, fake_FlashWindowEx);
		DetourDetach(&(PVOID&)pGetGuiResources, fake_GetGuiResources);
		DetourDetach(&(PVOID&)pCountClipboardFormats, fake_CountClipboardFormats);
		DetourDetach(&(PVOID&)pSetMenuInfo, fake_SetMenuInfo);
		DetourDetach(&(PVOID&)pSetDlgItemInt, fake_SetDlgItemInt);
		DetourDetach(&(PVOID&)pDrawCaption, fake_DrawCaption);
		DetourDetach(&(PVOID&)pGetNextDlgGroupItem, fake_GetNextDlgGroupItem);
		DetourDetach(&(PVOID&)pCreateDialogParamA, fake_CreateDialogParamA);
		DetourDetach(&(PVOID&)pGetClassInfoExW, fake_GetClassInfoExW);
		DetourDetach(&(PVOID&)pTranslateMDISysAccel, fake_TranslateMDISysAccel);
		DetourDetach(&(PVOID&)pAnimateWindow, fake_AnimateWindow);
		DetourDetach(&(PVOID&)pChildWindowFromPointEx, fake_ChildWindowFromPointEx);
		DetourDetach(&(PVOID&)pOemToCharBuffA, fake_OemToCharBuffA);
		DetourDetach(&(PVOID&)pEnumWindows, fake_EnumWindows);
		DetourDetach(&(PVOID&)pGetMenuInfo, fake_GetMenuInfo);
		DetourDetach(&(PVOID&)pGetMenuItemCount, fake_GetMenuItemCount);
		DetourDetach(&(PVOID&)pSetUserObjectInformationW, fake_SetUserObjectInformationW);
		DetourDetach(&(PVOID&)pEnumDesktopWindows, fake_EnumDesktopWindows);
		DetourDetach(&(PVOID&)pLoadCursorFromFileA, fake_LoadCursorFromFileA);
		DetourDetach(&(PVOID&)pFindWindowA, fake_FindWindowA);
		DetourDetach(&(PVOID&)pBroadcastSystemMessageExA, fake_BroadcastSystemMessageExA);
		DetourDetach(&(PVOID&)pRealGetWindowClassA, fake_RealGetWindowClassA);
		DetourDetach(&(PVOID&)pGetMenuItemID, fake_GetMenuItemID);
		DetourDetach(&(PVOID&)pMessageBeep, fake_MessageBeep);
		DetourDetach(&(PVOID&)pMessageBoxExW, fake_MessageBoxExW);
		DetourDetach(&(PVOID&)pCallMsgFilterA, fake_CallMsgFilterA);
		DetourDetach(&(PVOID&)pLoadAcceleratorsA, fake_LoadAcceleratorsA);
		DetourDetach(&(PVOID&)pInsertMenuW, fake_InsertMenuW);
		DetourDetach(&(PVOID&)pRedrawWindow, fake_RedrawWindow);
		DetourDetach(&(PVOID&)pSystemParametersInfoA, fake_SystemParametersInfoA);
		DetourDetach(&(PVOID&)pSetLayeredWindowAttributes, fake_SetLayeredWindowAttributes);
		DetourDetach(&(PVOID&)pLockWindowUpdate, fake_LockWindowUpdate);
		DetourDetach(&(PVOID&)pDefWindowProcA, fake_DefWindowProcA);
		DetourDetach(&(PVOID&)pSetPhysicalCursorPos, fake_SetPhysicalCursorPos);
		DetourDetach(&(PVOID&)pDestroyAcceleratorTable, fake_DestroyAcceleratorTable);
		DetourDetach(&(PVOID&)pInvertRect, fake_InvertRect);
		DetourDetach(&(PVOID&)pIsDialogMessageW, fake_IsDialogMessageW);
		DetourDetach(&(PVOID&)pLookupIconIdFromDirectory, fake_LookupIconIdFromDirectory);
		DetourDetach(&(PVOID&)pSetDebugErrorLevel, fake_SetDebugErrorLevel);
		DetourDetach(&(PVOID&)pMessageBoxA, fake_MessageBoxA);
		DetourDetach(&(PVOID&)pFlashWindow, fake_FlashWindow);
		DetourDetach(&(PVOID&)pGetClassInfoExA, fake_GetClassInfoExA);
		DetourDetach(&(PVOID&)pDialogBoxParamA, fake_DialogBoxParamA);
		DetourDetach(&(PVOID&)pValidateRect, fake_ValidateRect);
		DetourDetach(&(PVOID&)pGetCaretBlinkTime, fake_GetCaretBlinkTime);
		DetourDetach(&(PVOID&)pInvalidateRect, fake_InvalidateRect);
		DetourDetach(&(PVOID&)pGetRawInputDeviceList, fake_GetRawInputDeviceList);
		DetourDetach(&(PVOID&)pGetMessageTime, fake_GetMessageTime);
		DetourDetach(&(PVOID&)pLoadCursorW, fake_LoadCursorW);
		DetourDetach(&(PVOID&)pGetSystemMetrics, fake_GetSystemMetrics);
		DetourDetach(&(PVOID&)pGetWindowModuleFileNameA, fake_GetWindowModuleFileNameA);
		DetourDetach(&(PVOID&)pDialogBoxIndirectParamW, fake_DialogBoxIndirectParamW);
		DetourDetach(&(PVOID&)pFindWindowExA, fake_FindWindowExA);
		DetourDetach(&(PVOID&)pShutdownBlockReasonDestroy, fake_ShutdownBlockReasonDestroy);
		DetourDetach(&(PVOID&)pSetCaretPos, fake_SetCaretPos);
		DetourDetach(&(PVOID&)pPtInRect, fake_PtInRect);
		DetourDetach(&(PVOID&)pUnhookWindowsHookEx, fake_UnhookWindowsHookEx);
		DetourDetach(&(PVOID&)pBroadcastSystemMessageW, fake_BroadcastSystemMessageW);
		DetourDetach(&(PVOID&)pGetMouseMovePointsEx, fake_GetMouseMovePointsEx);
		DetourDetach(&(PVOID&)pGetShellWindow, fake_GetShellWindow);
		DetourDetach(&(PVOID&)pGetClassNameA, fake_GetClassNameA);
		DetourDetach(&(PVOID&)pLoadMenuW, fake_LoadMenuW);
		DetourDetach(&(PVOID&)pShutdownBlockReasonCreate, fake_ShutdownBlockReasonCreate);
		DetourDetach(&(PVOID&)pSendDlgItemMessageW, fake_SendDlgItemMessageW);
		DetourDetach(&(PVOID&)pGetWindowRgnBox, fake_GetWindowRgnBox);
		DetourDetach(&(PVOID&)pInSendMessageEx, fake_InSendMessageEx);
		DetourDetach(&(PVOID&)pLoadImageW, fake_LoadImageW);
		DetourDetach(&(PVOID&)pDefRawInputProc, fake_DefRawInputProc);
		DetourDetach(&(PVOID&)pSetClipboardViewer, fake_SetClipboardViewer);
		DetourDetach(&(PVOID&)pTabbedTextOutW, fake_TabbedTextOutW);
		DetourDetach(&(PVOID&)pGetComboBoxInfo, fake_GetComboBoxInfo);
		DetourDetach(&(PVOID&)pGetInputState, fake_GetInputState);
		DetourDetach(&(PVOID&)pIsWow64Message, fake_IsWow64Message);
		DetourDetach(&(PVOID&)pIsCharUpperA, fake_IsCharUpperA);
		DetourDetach(&(PVOID&)pMessageBoxIndirectA, fake_MessageBoxIndirectA);
		DetourDetach(&(PVOID&)pCopyCursor, fake_CopyCursor);
		DetourDetach(&(PVOID&)pChangeDisplaySettingsExW, fake_ChangeDisplaySettingsExW);
		DetourDetach(&(PVOID&)pEndDeferWindowPos, fake_EndDeferWindowPos);
		DetourDetach(&(PVOID&)pTrackPopupMenu, fake_TrackPopupMenu);
		DetourDetach(&(PVOID&)pSetDisplayConfig, fake_SetDisplayConfig);
		DetourDetach(&(PVOID&)pCreateAcceleratorTableA, fake_CreateAcceleratorTableA);
		DetourDetach(&(PVOID&)pGetProcessWindowStation, fake_GetProcessWindowStation);
		DetourDetach(&(PVOID&)pSetWindowContextHelpId, fake_SetWindowContextHelpId);
		DetourDetach(&(PVOID&)pCreateDesktopExW, fake_CreateDesktopExW);
		DetourDetach(&(PVOID&)pGetDialogBaseUnits, fake_GetDialogBaseUnits);
		DetourDetach(&(PVOID&)pCreateWindowExW, fake_CreateWindowExW);
		DetourDetach(&(PVOID&)pGetMenuStringA, fake_GetMenuStringA);
		DetourDetach(&(PVOID&)pUserHandleGrantAccess, fake_UserHandleGrantAccess);
		DetourDetach(&(PVOID&)pRegisterHotKey, fake_RegisterHotKey);
		DetourDetach(&(PVOID&)pEqualRect, fake_EqualRect);
		DetourDetach(&(PVOID&)pSetMenuItemInfoA, fake_SetMenuItemInfoA);
		DetourDetach(&(PVOID&)pCharLowerA, fake_CharLowerA);
		DetourDetach(&(PVOID&)pSetProcessDPIAware, fake_SetProcessDPIAware);
		DetourDetach(&(PVOID&)pWaitForInputIdle, fake_WaitForInputIdle);
		DetourDetach(&(PVOID&)pCharToOemW, fake_CharToOemW);
		DetourDetach(&(PVOID&)pGetRawInputDeviceInfoW, fake_GetRawInputDeviceInfoW);
		DetourDetach(&(PVOID&)pTrackMouseEvent, fake_TrackMouseEvent);
		DetourDetach(&(PVOID&)pCharUpperBuffW, fake_CharUpperBuffW);
		DetourDetach(&(PVOID&)pPostThreadMessageW, fake_PostThreadMessageW);
		DetourDetach(&(PVOID&)pLoadKeyboardLayoutA, fake_LoadKeyboardLayoutA);
		DetourDetach(&(PVOID&)pRemovePropA, fake_RemovePropA);
		DetourDetach(&(PVOID&)pTabbedTextOutA, fake_TabbedTextOutA);
		DetourDetach(&(PVOID&)pGetActiveWindow, fake_GetActiveWindow);
		DetourDetach(&(PVOID&)pIsWindowVisible, fake_IsWindowVisible);
		DetourDetach(&(PVOID&)pGetTitleBarInfo, fake_GetTitleBarInfo);
		DetourDetach(&(PVOID&)pBroadcastSystemMessageA, fake_BroadcastSystemMessageA);
		DetourDetach(&(PVOID&)pSetForegroundWindow, fake_SetForegroundWindow);
		DetourDetach(&(PVOID&)pDispatchMessageA, fake_DispatchMessageA);
		DetourDetach(&(PVOID&)pRegisterPowerSettingNotification, fake_RegisterPowerSettingNotification);
		DetourDetach(&(PVOID&)pChangeWindowMessageFilter, fake_ChangeWindowMessageFilter);
		DetourDetach(&(PVOID&)pMapWindowPoints, fake_MapWindowPoints);
		DetourDetach(&(PVOID&)pGetTopWindow, fake_GetTopWindow);
		DetourDetach(&(PVOID&)pGetLayeredWindowAttributes, fake_GetLayeredWindowAttributes);
		DetourDetach(&(PVOID&)pRegisterClassA, fake_RegisterClassA);
		DetourDetach(&(PVOID&)pGetDlgItem, fake_GetDlgItem);
		DetourDetach(&(PVOID&)pPaintDesktop, fake_PaintDesktop);
		DetourDetach(&(PVOID&)pPhysicalToLogicalPoint, fake_PhysicalToLogicalPoint);
		DetourDetach(&(PVOID&)pGetMenu, fake_GetMenu);
		DetourDetach(&(PVOID&)pGetDCEx, fake_GetDCEx);
		DetourDetach(&(PVOID&)pCallWindowProcA, fake_CallWindowProcA);
		DetourDetach(&(PVOID&)pDialogBoxIndirectParamA, fake_DialogBoxIndirectParamA);
		DetourDetach(&(PVOID&)pGetMenuItemInfoW, fake_GetMenuItemInfoW);
		DetourDetach(&(PVOID&)pVkKeyScanW, fake_VkKeyScanW);
		DetourDetach(&(PVOID&)pInsertMenuA, fake_InsertMenuA);
		DetourDetach(&(PVOID&)pSetWindowsHookExW, fake_SetWindowsHookExW);
		DetourDetach(&(PVOID&)pGetUserObjectSecurity, fake_GetUserObjectSecurity);
		DetourDetach(&(PVOID&)pSetFocus, fake_SetFocus);
		DetourDetach(&(PVOID&)pSetThreadDesktop, fake_SetThreadDesktop);
		DetourDetach(&(PVOID&)pLogicalToPhysicalPoint, fake_LogicalToPhysicalPoint);
		DetourDetach(&(PVOID&)pSetWindowLongPtrW, fake_SetWindowLongPtrW);
		DetourDetach(&(PVOID&)pDefMDIChildProcA, fake_DefMDIChildProcA);
		DetourDetach(&(PVOID&)pShowOwnedPopups, fake_ShowOwnedPopups);
		DetourDetach(&(PVOID&)pGetProcessDefaultLayout, fake_GetProcessDefaultLayout);
		DetourDetach(&(PVOID&)pHideCaret, fake_HideCaret);
		DetourDetach(&(PVOID&)pEndDialog, fake_EndDialog);
		DetourDetach(&(PVOID&)pUnloadKeyboardLayout, fake_UnloadKeyboardLayout);
		DetourDetach(&(PVOID&)pSetClassLongW, fake_SetClassLongW);
		DetourDetach(&(PVOID&)pMapVirtualKeyExW, fake_MapVirtualKeyExW);
		DetourDetach(&(PVOID&)pSetWindowsHookExA, fake_SetWindowsHookExA);
		DetourDetach(&(PVOID&)pHiliteMenuItem, fake_HiliteMenuItem);
		DetourDetach(&(PVOID&)pCopyImage, fake_CopyImage);
		DetourDetach(&(PVOID&)pEnumDesktopsA, fake_EnumDesktopsA);
		DetourDetach(&(PVOID&)pCheckMenuRadioItem, fake_CheckMenuRadioItem);
		DetourDetach(&(PVOID&)pMsgWaitForMultipleObjectsEx, fake_MsgWaitForMultipleObjectsEx);
		DetourDetach(&(PVOID&)pInsertMenuItemW, fake_InsertMenuItemW);
		DetourDetach(&(PVOID&)pExcludeUpdateRgn, fake_ExcludeUpdateRgn);
		DetourDetach(&(PVOID&)pCloseTouchInputHandle, fake_CloseTouchInputHandle);
		DetourDetach(&(PVOID&)pUnionRect, fake_UnionRect);
		DetourDetach(&(PVOID&)pLoadCursorFromFileW, fake_LoadCursorFromFileW);
		DetourDetach(&(PVOID&)pPostQuitMessage, fake_PostQuitMessage);
		DetourDetach(&(PVOID&)pWindowFromPoint, fake_WindowFromPoint);
		DetourDetach(&(PVOID&)pCharToOemBuffW, fake_CharToOemBuffW);
		DetourDetach(&(PVOID&)pCreateWindowStationA, fake_CreateWindowStationA);
		DetourDetach(&(PVOID&)pBeginDeferWindowPos, fake_BeginDeferWindowPos);
		DetourDetach(&(PVOID&)pPeekMessageA, fake_PeekMessageA);
		DetourDetach(&(PVOID&)pGetNextDlgTabItem, fake_GetNextDlgTabItem);
		DetourDetach(&(PVOID&)pLoadStringA, fake_LoadStringA);
		DetourDetach(&(PVOID&)pGetClassInfoW, fake_GetClassInfoW);
		DetourDetach(&(PVOID&)pIsWinEventHookInstalled, fake_IsWinEventHookInstalled);
		DetourDetach(&(PVOID&)pGetWindowContextHelpId, fake_GetWindowContextHelpId);
		DetourDetach(&(PVOID&)pCreateMDIWindowA, fake_CreateMDIWindowA);
		DetourDetach(&(PVOID&)pDefDlgProcW, fake_DefDlgProcW);
		DetourDetach(&(PVOID&)pRegisterClipboardFormatA, fake_RegisterClipboardFormatA);
		DetourDetach(&(PVOID&)pSetWindowsHookA, fake_SetWindowsHookA);
		DetourDetach(&(PVOID&)pGetDC, fake_GetDC);
		DetourDetach(&(PVOID&)pDlgDirListComboBoxA, fake_DlgDirListComboBoxA);
		DetourDetach(&(PVOID&)pRegisterClassExA, fake_RegisterClassExA);
		DetourDetach(&(PVOID&)pSetPropA, fake_SetPropA);
		DetourDetach(&(PVOID&)pCreateDialogIndirectParamW, fake_CreateDialogIndirectParamW);
		DetourDetach(&(PVOID&)pToAscii, fake_ToAscii);
		DetourDetach(&(PVOID&)pSoundSentry, fake_SoundSentry);
		DetourDetach(&(PVOID&)pDrawTextW, fake_DrawTextW);
		DetourDetach(&(PVOID&)pSetWindowPos, fake_SetWindowPos);
		DetourDetach(&(PVOID&)pToUnicodeEx, fake_ToUnicodeEx);
		DetourDetach(&(PVOID&)pwvsprintfW, fake_wvsprintfW);
		DetourDetach(&(PVOID&)pSetScrollInfo, fake_SetScrollInfo);
		DetourDetach(&(PVOID&)pCreateWindowExA, fake_CreateWindowExA);
		DetourDetach(&(PVOID&)pGetClipboardFormatNameW, fake_GetClipboardFormatNameW);
		DetourDetach(&(PVOID&)pGetClipboardSequenceNumber, fake_GetClipboardSequenceNumber);
		DetourDetach(&(PVOID&)pDrawTextA, fake_DrawTextA);
		DetourDetach(&(PVOID&)pShowCaret, fake_ShowCaret);
		DetourDetach(&(PVOID&)pGetWindowLongA, fake_GetWindowLongA);
		DetourDetach(&(PVOID&)pSetSysColors, fake_SetSysColors);
		DetourDetach(&(PVOID&)pGetAncestor, fake_GetAncestor);
		DetourDetach(&(PVOID&)pLoadIconA, fake_LoadIconA);
		DetourDetach(&(PVOID&)pwsprintfW, fake_wsprintfW);
		DetourDetach(&(PVOID&)pUnregisterHotKey, fake_UnregisterHotKey);
		DetourDetach(&(PVOID&)pGetSubMenu, fake_GetSubMenu);
		DetourDetach(&(PVOID&)pCloseWindow, fake_CloseWindow);
		DetourDetach(&(PVOID&)pSendMessageCallbackA, fake_SendMessageCallbackA);
		DetourDetach(&(PVOID&)pRemoveMenu, fake_RemoveMenu);
		DetourDetach(&(PVOID&)pIsDialogMessageA, fake_IsDialogMessageA);
		DetourDetach(&(PVOID&)pLoadMenuA, fake_LoadMenuA);
		DetourDetach(&(PVOID&)pGetRawInputBuffer, fake_GetRawInputBuffer);
		DetourDetach(&(PVOID&)pSystemParametersInfoW, fake_SystemParametersInfoW);
		DetourDetach(&(PVOID&)pArrangeIconicWindows, fake_ArrangeIconicWindows);
		DetourDetach(&(PVOID&)pGetMenuState, fake_GetMenuState);
		DetourDetach(&(PVOID&)pGetClipCursor, fake_GetClipCursor);
		DetourDetach(&(PVOID&)pGetKeyNameTextA, fake_GetKeyNameTextA);
		DetourDetach(&(PVOID&)pCallMsgFilterW, fake_CallMsgFilterW);
		DetourDetach(&(PVOID&)pCloseGestureInfoHandle, fake_CloseGestureInfoHandle);
		DetourDetach(&(PVOID&)pScrollDC, fake_ScrollDC);
		DetourDetach(&(PVOID&)pKillTimer, fake_KillTimer);
		DetourDetach(&(PVOID&)pCreateDesktopExA, fake_CreateDesktopExA);
		DetourDetach(&(PVOID&)pDrawFrameControl, fake_DrawFrameControl);
		DetourDetach(&(PVOID&)pGrayStringA, fake_GrayStringA);
		DetourDetach(&(PVOID&)pIsWindowEnabled, fake_IsWindowEnabled);
		DetourDetach(&(PVOID&)pGetScrollBarInfo, fake_GetScrollBarInfo);
		DetourDetach(&(PVOID&)pGetGestureConfig, fake_GetGestureConfig);
		DetourDetach(&(PVOID&)pScrollWindowEx, fake_ScrollWindowEx);
		DetourDetach(&(PVOID&)pDestroyWindow, fake_DestroyWindow);
		DetourDetach(&(PVOID&)pWaitMessage, fake_WaitMessage);
		DetourDetach(&(PVOID&)pIsDlgButtonChecked, fake_IsDlgButtonChecked);
		DetourDetach(&(PVOID&)pEndTask, fake_EndTask);
		DetourDetach(&(PVOID&)pGetKeyState, fake_GetKeyState);
		DetourDetach(&(PVOID&)pLookupIconIdFromDirectoryEx, fake_LookupIconIdFromDirectoryEx);
		DetourDetach(&(PVOID&)pLockWorkStation, fake_LockWorkStation);
		DetourDetach(&(PVOID&)pUnhookWinEvent, fake_UnhookWinEvent);
		DetourDetach(&(PVOID&)pIsClipboardFormatAvailable, fake_IsClipboardFormatAvailable);
		DetourDetach(&(PVOID&)pGetCaretPos, fake_GetCaretPos);
		DetourDetach(&(PVOID&)pPrivateExtractIconsW, fake_PrivateExtractIconsW);
		DetourDetach(&(PVOID&)pDragDetect, fake_DragDetect);
		DetourDetach(&(PVOID&)pGetDlgCtrlID, fake_GetDlgCtrlID);
		DetourDetach(&(PVOID&)pGetWindowTextLengthA, fake_GetWindowTextLengthA);
		DetourDetach(&(PVOID&)pGetQueueStatus, fake_GetQueueStatus);
		DetourDetach(&(PVOID&)pGetIconInfoExW, fake_GetIconInfoExW);
		DetourDetach(&(PVOID&)pRemoveClipboardFormatListener, fake_RemoveClipboardFormatListener);
		DetourDetach(&(PVOID&)pGetSysColorBrush, fake_GetSysColorBrush);
		DetourDetach(&(PVOID&)pSendMessageTimeoutA, fake_SendMessageTimeoutA);
		DetourDetach(&(PVOID&)pSetKeyboardState, fake_SetKeyboardState);
		DetourDetach(&(PVOID&)pSetUserObjectSecurity, fake_SetUserObjectSecurity);
		DetourDetach(&(PVOID&)pOemToCharBuffW, fake_OemToCharBuffW);
		DetourDetach(&(PVOID&)pMsgWaitForMultipleObjects, fake_MsgWaitForMultipleObjects);
		DetourDetach(&(PVOID&)pWinHelpA, fake_WinHelpA);
		DetourDetach(&(PVOID&)pCreateMenu, fake_CreateMenu);
		DetourDetach(&(PVOID&)pDrawFocusRect, fake_DrawFocusRect);
		DetourDetach(&(PVOID&)pDispatchMessageW, fake_DispatchMessageW);
		DetourDetach(&(PVOID&)pChangeMenuA, fake_ChangeMenuA);
		DetourDetach(&(PVOID&)pCreateMDIWindowW, fake_CreateMDIWindowW);
		DetourDetach(&(PVOID&)pEnumDisplayDevicesW, fake_EnumDisplayDevicesW);
		DetourDetach(&(PVOID&)pMenuItemFromPoint, fake_MenuItemFromPoint);
		DetourDetach(&(PVOID&)pUnregisterClassA, fake_UnregisterClassA);
		DetourDetach(&(PVOID&)pDeregisterShellHookWindow, fake_DeregisterShellHookWindow);
		DetourDetach(&(PVOID&)pSetDoubleClickTime, fake_SetDoubleClickTime);
		DetourDetach(&(PVOID&)pSetProcessWindowStation, fake_SetProcessWindowStation);
		DetourDetach(&(PVOID&)pLoadAcceleratorsW, fake_LoadAcceleratorsW);
		DetourDetach(&(PVOID&)pEndMenu, fake_EndMenu);
		DetourDetach(&(PVOID&)pLoadBitmapW, fake_LoadBitmapW);
		DetourDetach(&(PVOID&)pGetRawInputDeviceInfoA, fake_GetRawInputDeviceInfoA);
		DetourDetach(&(PVOID&)pGetMenuItemInfoA, fake_GetMenuItemInfoA);
		DetourDetach(&(PVOID&)pDrawMenuBar, fake_DrawMenuBar);
		DetourDetach(&(PVOID&)pAppendMenuA, fake_AppendMenuA);
		DetourDetach(&(PVOID&)pSetSystemCursor, fake_SetSystemCursor);
		DetourDetach(&(PVOID&)pOpenWindowStationA, fake_OpenWindowStationA);
		DetourDetach(&(PVOID&)pGetScrollPos, fake_GetScrollPos);
		DetourDetach(&(PVOID&)pDestroyMenu, fake_DestroyMenu);
		DetourDetach(&(PVOID&)pSetScrollRange, fake_SetScrollRange);
		DetourDetach(&(PVOID&)pSendMessageW, fake_SendMessageW);
		DetourDetach(&(PVOID&)pDeleteMenu, fake_DeleteMenu);
		DetourDetach(&(PVOID&)pGetGUIThreadInfo, fake_GetGUIThreadInfo);
		DetourDetach(&(PVOID&)pGetUpdatedClipboardFormats, fake_GetUpdatedClipboardFormats);
		DetourDetach(&(PVOID&)pGetRegisteredRawInputDevices, fake_GetRegisteredRawInputDevices);
		DetourDetach(&(PVOID&)pSetCursorPos, fake_SetCursorPos);
		DetourDetach(&(PVOID&)pIsZoomed, fake_IsZoomed);
		DetourDetach(&(PVOID&)pGetClassLongPtrW, fake_GetClassLongPtrW);
		DetourDetach(&(PVOID&)pExitWindowsEx, fake_ExitWindowsEx);
		DetourDetach(&(PVOID&)pToUnicode, fake_ToUnicode);
		DetourDetach(&(PVOID&)pGetPropA, fake_GetPropA);
		DetourDetach(&(PVOID&)pGetUpdateRect, fake_GetUpdateRect);
		DetourDetach(&(PVOID&)pMapVirtualKeyExA, fake_MapVirtualKeyExA);
		DetourDetach(&(PVOID&)pSetWindowRgn, fake_SetWindowRgn);
		DetourDetach(&(PVOID&)pEnumDesktopsW, fake_EnumDesktopsW);
		DetourDetach(&(PVOID&)pGetDlgItemTextA, fake_GetDlgItemTextA);
		DetourDetach(&(PVOID&)pDisplayConfigSetDeviceInfo, fake_DisplayConfigSetDeviceInfo);
		DetourDetach(&(PVOID&)pGetWindowWord, fake_GetWindowWord);
		DetourDetach(&(PVOID&)pGetMessagePos, fake_GetMessagePos);
		DetourDetach(&(PVOID&)pCharPrevExA, fake_CharPrevExA);
		DetourDetach(&(PVOID&)pCharUpperBuffA, fake_CharUpperBuffA);
		DetourDetach(&(PVOID&)pGetMenuItemRect, fake_GetMenuItemRect);
		DetourDetach(&(PVOID&)pValidateRgn, fake_ValidateRgn);
		DetourDetach(&(PVOID&)pDestroyIcon, fake_DestroyIcon);
		DetourDetach(&(PVOID&)pOpenIcon, fake_OpenIcon);
		DetourDetach(&(PVOID&)pPostThreadMessageA, fake_PostThreadMessageA);
		DetourDetach(&(PVOID&)pSetClipboardData, fake_SetClipboardData);
		DetourDetach(&(PVOID&)pRegisterClipboardFormatW, fake_RegisterClipboardFormatW);
		DetourDetach(&(PVOID&)pShutdownBlockReasonQuery, fake_ShutdownBlockReasonQuery);
		DetourDetach(&(PVOID&)pMapVirtualKeyW, fake_MapVirtualKeyW);
		DetourDetach(&(PVOID&)pSendMessageTimeoutW, fake_SendMessageTimeoutW);
		DetourDetach(&(PVOID&)pReplyMessage, fake_ReplyMessage);
		DetourDetach(&(PVOID&)pCreateIconFromResource, fake_CreateIconFromResource);
		DetourDetach(&(PVOID&)pGetSysColor, fake_GetSysColor);
		DetourDetach(&(PVOID&)pGetIconInfoExA, fake_GetIconInfoExA);
		DetourDetach(&(PVOID&)pDrawTextExW, fake_DrawTextExW);
		DetourDetach(&(PVOID&)pGetWindowRect, fake_GetWindowRect);
		DetourDetach(&(PVOID&)pGetWindowLongPtrA, fake_GetWindowLongPtrA);
		DetourDetach(&(PVOID&)pCreateWindowStationW, fake_CreateWindowStationW);
		DetourDetach(&(PVOID&)pGetWindow, fake_GetWindow);
		DetourDetach(&(PVOID&)pChangeDisplaySettingsExA, fake_ChangeDisplaySettingsExA);
		DetourDetach(&(PVOID&)pSetCursor, fake_SetCursor);
		DetourDetach(&(PVOID&)pMapDialogRect, fake_MapDialogRect);
		DetourDetach(&(PVOID&)pSubtractRect, fake_SubtractRect);
		DetourDetach(&(PVOID&)pLockSetForegroundWindow, fake_LockSetForegroundWindow);
		DetourDetach(&(PVOID&)pUnregisterClassW, fake_UnregisterClassW);
		DetourDetach(&(PVOID&)pEnumDisplaySettingsA, fake_EnumDisplaySettingsA);
		DetourDetach(&(PVOID&)pSetLastErrorEx, fake_SetLastErrorEx);
		DetourDetach(&(PVOID&)pGetMonitorInfoW, fake_GetMonitorInfoW);
		DetourDetach(&(PVOID&)pCreateIconIndirect, fake_CreateIconIndirect);
		DetourDetach(&(PVOID&)pDisableProcessWindowsGhosting, fake_DisableProcessWindowsGhosting);
		DetourDetach(&(PVOID&)pRegisterTouchWindow, fake_RegisterTouchWindow);
		DetourDetach(&(PVOID&)pDragObject, fake_DragObject);
		DetourDetach(&(PVOID&)pReleaseCapture, fake_ReleaseCapture);
		DetourDetach(&(PVOID&)pScreenToClient, fake_ScreenToClient);
		DetourDetach(&(PVOID&)pFindWindowExW, fake_FindWindowExW);
		DetourDetach(&(PVOID&)pDlgDirListA, fake_DlgDirListA);
		DetourDetach(&(PVOID&)pWindowFromDC, fake_WindowFromDC);
		DetourDetach(&(PVOID&)pUpdateLayeredWindow, fake_UpdateLayeredWindow);
		DetourDetach(&(PVOID&)pRegisterClassExW, fake_RegisterClassExW);
		DetourDetach(&(PVOID&)pGetWindowTextLengthW, fake_GetWindowTextLengthW);
		DetourDetach(&(PVOID&)pCreateDesktopA, fake_CreateDesktopA);
		DetourDetach(&(PVOID&)pFillRect, fake_FillRect);
		DetourDetach(&(PVOID&)pMoveWindow, fake_MoveWindow);
		DetourDetach(&(PVOID&)pSetDlgItemTextW, fake_SetDlgItemTextW);
		DetourDetach(&(PVOID&)pDrawStateW, fake_DrawStateW);
		DetourDetach(&(PVOID&)pLoadIconW, fake_LoadIconW);
		DetourDetach(&(PVOID&)pIsWindowUnicode, fake_IsWindowUnicode);
		DetourDetach(&(PVOID&)pDrawStateA, fake_DrawStateA);
		DetourDetach(&(PVOID&)pRealGetWindowClassW, fake_RealGetWindowClassW);
		DetourDetach(&(PVOID&)pCheckDlgButton, fake_CheckDlgButton);
		DetourDetach(&(PVOID&)pGetWindowTextA, fake_GetWindowTextA);
		DetourDetach(&(PVOID&)pMonitorFromWindow, fake_MonitorFromWindow);
		DetourDetach(&(PVOID&)pDefWindowProcW, fake_DefWindowProcW);
		DetourDetach(&(PVOID&)pIsWindow, fake_IsWindow);
		DetourDetach(&(PVOID&)pSendDlgItemMessageA, fake_SendDlgItemMessageA);
		DetourDetach(&(PVOID&)pCreateIconFromResourceEx, fake_CreateIconFromResourceEx);
		DetourDetach(&(PVOID&)pGetClipboardData, fake_GetClipboardData);
		DetourDetach(&(PVOID&)pSendInput, fake_SendInput);
		DetourDetach(&(PVOID&)pNotifyWinEvent, fake_NotifyWinEvent);
		DetourDetach(&(PVOID&)pGetWindowModuleFileNameW, fake_GetWindowModuleFileNameW);
		DetourDetach(&(PVOID&)pEnableScrollBar, fake_EnableScrollBar);
		DetourDetach(&(PVOID&)pSendMessageCallbackW, fake_SendMessageCallbackW);
		DetourDetach(&(PVOID&)pClientToScreen, fake_ClientToScreen);
		DetourDetach(&(PVOID&)pEnumThreadWindows, fake_EnumThreadWindows);
		DetourDetach(&(PVOID&)pSetScrollPos, fake_SetScrollPos);
		DetourDetach(&(PVOID&)pGetWindowLongW, fake_GetWindowLongW);
		DetourDetach(&(PVOID&)pSetWindowDisplayAffinity, fake_SetWindowDisplayAffinity);
		DetourDetach(&(PVOID&)pTranslateAcceleratorW, fake_TranslateAcceleratorW);
		DetourDetach(&(PVOID&)pDlgDirListW, fake_DlgDirListW);
		DetourDetach(&(PVOID&)pDialogBoxParamW, fake_DialogBoxParamW);
		DetourDetach(&(PVOID&)pGetClipboardOwner, fake_GetClipboardOwner);
		DetourDetach(&(PVOID&)pMessageBoxIndirectW, fake_MessageBoxIndirectW);
		DetourDetach(&(PVOID&)pGetCursor, fake_GetCursor);
		DetourDetach(&(PVOID&)pSetClassLongA, fake_SetClassLongA);
		DetourDetach(&(PVOID&)pSetMessageQueue, fake_SetMessageQueue);
		DetourDetach(&(PVOID&)pCharToOemBuffA, fake_CharToOemBuffA);
		DetourDetach(&(PVOID&)pAdjustWindowRect, fake_AdjustWindowRect);
		DetourDetach(&(PVOID&)pGetMenuStringW, fake_GetMenuStringW);
		DetourDetach(&(PVOID&)pRegisterClassW, fake_RegisterClassW);
		DetourDetach(&(PVOID&)pInsertMenuItemA, fake_InsertMenuItemA);
		DetourDetach(&(PVOID&)pGetWindowPlacement, fake_GetWindowPlacement);
		DetourDetach(&(PVOID&)pSetWindowLongW, fake_SetWindowLongW);
		DetourDetach(&(PVOID&)pSetPropW, fake_SetPropW);
		DetourDetach(&(PVOID&)pInternalGetWindowText, fake_InternalGetWindowText);
		DetourDetach(&(PVOID&)pIsCharAlphaNumericA, fake_IsCharAlphaNumericA);
		DetourDetach(&(PVOID&)pShowWindowAsync, fake_ShowWindowAsync);
		DetourDetach(&(PVOID&)pEnumWindowStationsA, fake_EnumWindowStationsA);
		DetourDetach(&(PVOID&)pGetUserObjectInformationW, fake_GetUserObjectInformationW);
		DetourDetach(&(PVOID&)pCallNextHookEx, fake_CallNextHookEx);
		DetourDetach(&(PVOID&)pFrameRect, fake_FrameRect);
		DetourDetach(&(PVOID&)pGetPriorityClipboardFormat, fake_GetPriorityClipboardFormat);
		DetourDetach(&(PVOID&)pSetWindowsHookW, fake_SetWindowsHookW);
		DetourDetach(&(PVOID&)pSetMenuItemInfoW, fake_SetMenuItemInfoW);
		DetourDetach(&(PVOID&)pCreateDialogIndirectParamA, fake_CreateDialogIndirectParamA);
		DetourDetach(&(PVOID&)pRegisterRawInputDevices, fake_RegisterRawInputDevices);
		DetourDetach(&(PVOID&)pSetClassWord, fake_SetClassWord);
		DetourDetach(&(PVOID&)pDrawAnimatedRects, fake_DrawAnimatedRects);
		DetourDetach(&(PVOID&)pUnregisterPowerSettingNotification, fake_UnregisterPowerSettingNotification);
		DetourDetach(&(PVOID&)pGetClipboardViewer, fake_GetClipboardViewer);
		DetourDetach(&(PVOID&)pGetClassLongW, fake_GetClassLongW);
		DetourDetach(&(PVOID&)pShowCursor, fake_ShowCursor);
		DetourDetach(&(PVOID&)pMonitorFromPoint, fake_MonitorFromPoint);
		DetourDetach(&(PVOID&)pDlgDirSelectComboBoxExW, fake_DlgDirSelectComboBoxExW);
		DetourDetach(&(PVOID&)pCloseClipboard, fake_CloseClipboard);
		DetourDetach(&(PVOID&)pEnumDisplaySettingsExW, fake_EnumDisplaySettingsExW);
		DetourDetach(&(PVOID&)pGetMenuBarInfo, fake_GetMenuBarInfo);
		DetourDetach(&(PVOID&)pDisplayConfigGetDeviceInfo, fake_DisplayConfigGetDeviceInfo);
		DetourDetach(&(PVOID&)pCreateDesktopW, fake_CreateDesktopW);
		DetourDetach(&(PVOID&)pSetMenu, fake_SetMenu);
		DetourDetach(&(PVOID&)pDefFrameProcW, fake_DefFrameProcW);
		DetourDetach(&(PVOID&)pSetWindowWord, fake_SetWindowWord);
		DetourDetach(&(PVOID&)pGetKeyboardLayoutNameW, fake_GetKeyboardLayoutNameW);
		DetourDetach(&(PVOID&)pCloseDesktop, fake_CloseDesktop);
		DetourDetach(&(PVOID&)pSetProcessDefaultLayout, fake_SetProcessDefaultLayout);
		DetourDetach(&(PVOID&)pGetAsyncKeyState, fake_GetAsyncKeyState);
		DetourDetach(&(PVOID&)pIsCharUpperW, fake_IsCharUpperW);
		DetourDetach(&(PVOID&)pIsCharAlphaW, fake_IsCharAlphaW);
		DetourDetach(&(PVOID&)pEnumDisplaySettingsExA, fake_EnumDisplaySettingsExA);
		DetourDetach(&(PVOID&)pCharUpperW, fake_CharUpperW);
		DetourDetach(&(PVOID&)pTranslateMessage, fake_TranslateMessage);
		DetourDetach(&(PVOID&)pCreateIcon, fake_CreateIcon);
		DetourDetach(&(PVOID&)pCharNextA, fake_CharNextA);
		DetourDetach(&(PVOID&)pSendNotifyMessageW, fake_SendNotifyMessageW);
		DetourDetach(&(PVOID&)pEnumPropsW, fake_EnumPropsW);
		DetourDetach(&(PVOID&)pGetForegroundWindow, fake_GetForegroundWindow);
		DetourDetach(&(PVOID&)pGetMonitorInfoA, fake_GetMonitorInfoA);
		DetourDetach(&(PVOID&)pIsGUIThread, fake_IsGUIThread);
		DetourDetach(&(PVOID&)pCharNextW, fake_CharNextW);
		DetourDetach(&(PVOID&)pGetLastActivePopup, fake_GetLastActivePopup);
		DetourDetach(&(PVOID&)pEnumChildWindows, fake_EnumChildWindows);
		DetourDetach(&(PVOID&)pGetSystemMenu, fake_GetSystemMenu);
		DetourDetach(&(PVOID&)pIsCharAlphaNumericW, fake_IsCharAlphaNumericW);
		DetourDetach(&(PVOID&)pRegisterShellHookWindow, fake_RegisterShellHookWindow);
		DetourDetach(&(PVOID&)pOpenClipboard, fake_OpenClipboard);
		DetourDetach(&(PVOID&)pCopyAcceleratorTableA, fake_CopyAcceleratorTableA);
		DetourDetach(&(PVOID&)pGetGestureInfo, fake_GetGestureInfo);
		DetourDetach(&(PVOID&)pCreateCursor, fake_CreateCursor);
		DetourDetach(&(PVOID&)pGetWindowInfo, fake_GetWindowInfo);
		DetourDetach(&(PVOID&)pOemToCharW, fake_OemToCharW);
		DetourDetach(&(PVOID&)pGetWindowTextW, fake_GetWindowTextW);
		DetourDetach(&(PVOID&)pDrawTextExA, fake_DrawTextExA);
		DetourDetach(&(PVOID&)pDlgDirSelectExW, fake_DlgDirSelectExW);
		DetourDetach(&(PVOID&)pSetTimer, fake_SetTimer);
		DetourDetach(&(PVOID&)pGetMenuCheckMarkDimensions, fake_GetMenuCheckMarkDimensions);
		DetourDetach(&(PVOID&)pPrivateExtractIconsA, fake_PrivateExtractIconsA);
		DetourDetach(&(PVOID&)pIsCharLowerW, fake_IsCharLowerW);
		DetourDetach(&(PVOID&)pAdjustWindowRectEx, fake_AdjustWindowRectEx);
		DetourDetach(&(PVOID&)pkeybd_event, fake_keybd_event);
		DetourDetach(&(PVOID&)pIsHungAppWindow, fake_IsHungAppWindow);
		DetourDetach(&(PVOID&)pVkKeyScanA, fake_VkKeyScanA);
		DetourDetach(&(PVOID&)pRealChildWindowFromPoint, fake_RealChildWindowFromPoint);
		DetourDetach(&(PVOID&)pWindowFromPhysicalPoint, fake_WindowFromPhysicalPoint);
		DetourDetach(&(PVOID&)pOpenDesktopA, fake_OpenDesktopA);
		DetourDetach(&(PVOID&)pGetWindowLongPtrW, fake_GetWindowLongPtrW);
		DetourDetach(&(PVOID&)pEmptyClipboard, fake_EmptyClipboard);
		DetourDetach(&(PVOID&)pGetMenuContextHelpId, fake_GetMenuContextHelpId);
		DetourDetach(&(PVOID&)pEnumPropsExW, fake_EnumPropsExW);
		DetourDetach(&(PVOID&)pInvalidateRgn, fake_InvalidateRgn);
		DetourDetach(&(PVOID&)pTranslateAcceleratorA, fake_TranslateAcceleratorA);
		DetourDetach(&(PVOID&)pwvsprintfA, fake_wvsprintfA);
		DetourDetach(&(PVOID&)pDefDlgProcA, fake_DefDlgProcA);
		DetourDetach(&(PVOID&)pGetTouchInputInfo, fake_GetTouchInputInfo);
		DetourDetach(&(PVOID&)pGetPhysicalCursorPos, fake_GetPhysicalCursorPos);
		DetourDetach(&(PVOID&)pGetDesktopWindow, fake_GetDesktopWindow);
		DetourDetach(&(PVOID&)pGetScrollRange, fake_GetScrollRange);
		DetourDetach(&(PVOID&)pDefFrameProcA, fake_DefFrameProcA);
		DetourDetach(&(PVOID&)pGetKeyboardLayoutList, fake_GetKeyboardLayoutList);
		DetourDetach(&(PVOID&)pDlgDirListComboBoxW, fake_DlgDirListComboBoxW);
		DetourDetach(&(PVOID&)pSetMenuDefaultItem, fake_SetMenuDefaultItem);
		DetourDetach(&(PVOID&)pIsMenu, fake_IsMenu);
		DetourDetach(&(PVOID&)pAttachThreadInput, fake_AttachThreadInput);
		DetourDetach(&(PVOID&)pLoadImageA, fake_LoadImageA);
		DetourDetach(&(PVOID&)pGetTabbedTextExtentA, fake_GetTabbedTextExtentA);
		DetourDetach(&(PVOID&)pGrayStringW, fake_GrayStringW);
		DetourDetach(&(PVOID&)pSetWindowTextA, fake_SetWindowTextA);
		DetourDetach(&(PVOID&)pGetWindowDC, fake_GetWindowDC);
		DetourDetach(&(PVOID&)pCheckRadioButton, fake_CheckRadioButton);
		DetourDetach(&(PVOID&)pOemToCharA, fake_OemToCharA);
		DetourDetach(&(PVOID&)pCascadeWindows, fake_CascadeWindows);
		DetourDetach(&(PVOID&)pFindWindowW, fake_FindWindowW);
		DetourDetach(&(PVOID&)pGetListBoxInfo, fake_GetListBoxInfo);
		DetourDetach(&(PVOID&)pSetActiveWindow, fake_SetActiveWindow);
		DetourDetach(&(PVOID&)pEndPaint, fake_EndPaint);
		DetourDetach(&(PVOID&)pEnableWindow, fake_EnableWindow);
		DetourDetach(&(PVOID&)pGetLastInputInfo, fake_GetLastInputInfo);
		DetourDetach(&(PVOID&)pGetDlgItemInt, fake_GetDlgItemInt);
		DetourDetach(&(PVOID&)pGetClassInfoA, fake_GetClassInfoA);
		DetourDetach(&(PVOID&)pGetUserObjectInformationA, fake_GetUserObjectInformationA);
		DetourDetach(&(PVOID&)pGetDisplayConfigBufferSizes, fake_GetDisplayConfigBufferSizes);
		DetourDetach(&(PVOID&)pLoadStringW, fake_LoadStringW);
		DetourDetach(&(PVOID&)pDestroyCaret, fake_DestroyCaret);
		DetourDetach(&(PVOID&)pGetMessageA, fake_GetMessageA);
		DetourDetach(&(PVOID&)pUnregisterTouchWindow, fake_UnregisterTouchWindow);
		DetourDetach(&(PVOID&)pUpdateWindow, fake_UpdateWindow);
		DetourDetach(&(PVOID&)pOffsetRect, fake_OffsetRect);
		DetourDetach(&(PVOID&)pGetClipboardFormatNameA, fake_GetClipboardFormatNameA);
		DetourDetach(&(PVOID&)pBroadcastSystemMessageExW, fake_BroadcastSystemMessageExW);
		DetourDetach(&(PVOID&)pUnregisterDeviceNotification, fake_UnregisterDeviceNotification);
		DetourDetach(&(PVOID&)pBlockInput, fake_BlockInput);
		DetourDetach(&(PVOID&)pGetKeyNameTextW, fake_GetKeyNameTextW);
		DetourDetach(&(PVOID&)pCreateDialogParamW, fake_CreateDialogParamW);
		DetourDetach(&(PVOID&)pGetRawInputData, fake_GetRawInputData);
		DetourDetach(&(PVOID&)pLoadMenuIndirectW, fake_LoadMenuIndirectW);
		DetourDetach(&(PVOID&)pRegisterWindowMessageA, fake_RegisterWindowMessageA);
		DetourDetach(&(PVOID&)pBringWindowToTop, fake_BringWindowToTop);
		DetourDetach(&(PVOID&)pGetDlgItemTextW, fake_GetDlgItemTextW);
		DetourDetach(&(PVOID&)pTrackPopupMenuEx, fake_TrackPopupMenuEx);
		DetourDetach(&(PVOID&)pMessageBoxExA, fake_MessageBoxExA);
		DetourDetach(&(PVOID&)pGetPropW, fake_GetPropW);
		DetourDetach(&(PVOID&)pEnumDisplaySettingsW, fake_EnumDisplaySettingsW);
		DetourDetach(&(PVOID&)pGetClassWord, fake_GetClassWord);
		DetourDetach(&(PVOID&)pPostMessageA, fake_PostMessageA);
		DetourDetach(&(PVOID&)pSetDlgItemTextA, fake_SetDlgItemTextA);
		DetourDetach(&(PVOID&)pMessageBoxW, fake_MessageBoxW);
		DetourDetach(&(PVOID&)pCreatePopupMenu, fake_CreatePopupMenu);
		DetourDetach(&(PVOID&)pReleaseDC, fake_ReleaseDC);
		DetourDetach(&(PVOID&)pmouse_event, fake_mouse_event);
		DetourDetach(&(PVOID&)pSetRect, fake_SetRect);
		DetourDetach(&(PVOID&)pLoadBitmapA, fake_LoadBitmapA);
		DetourDetach(&(PVOID&)pCharPrevA, fake_CharPrevA);
		DetourDetach(&(PVOID&)pGetClassNameW, fake_GetClassNameW);
		DetourDetach(&(PVOID&)pGetKeyboardLayoutNameA, fake_GetKeyboardLayoutNameA);
		DetourDetach(&(PVOID&)pSetWindowTextW, fake_SetWindowTextW);
		DetourDetach(&(PVOID&)pGetClientRect, fake_GetClientRect);
		DetourDetach(&(PVOID&)pGetMenuDefaultItem, fake_GetMenuDefaultItem);
		DetourDetach(&(PVOID&)pUpdateLayeredWindowIndirect, fake_UpdateLayeredWindowIndirect);
		DetourDetach(&(PVOID&)pChangeDisplaySettingsA, fake_ChangeDisplaySettingsA);
		DetourDetach(&(PVOID&)pWinHelpW, fake_WinHelpW);
		DetourDetach(&(PVOID&)pCreateAcceleratorTableW, fake_CreateAcceleratorTableW);
		DetourDetach(&(PVOID&)pGetMessageW, fake_GetMessageW);
		DetourDetach(&(PVOID&)pSetCapture, fake_SetCapture);
		DetourDetach(&(PVOID&)pIsProcessDPIAware, fake_IsProcessDPIAware);
		DetourDetach(&(PVOID&)pIntersectRect, fake_IntersectRect);
		DetourDetach(&(PVOID&)pGetCursorInfo, fake_GetCursorInfo);
		DetourDetach(&(PVOID&)pSetWindowLongA, fake_SetWindowLongA);
		DetourDetach(&(PVOID&)pSwitchDesktop, fake_SwitchDesktop);
		DetourDetach(&(PVOID&)pRemovePropW, fake_RemovePropW);
		DetourDetach(&(PVOID&)pDeferWindowPos, fake_DeferWindowPos);
		DetourDetach(&(PVOID&)pGetThreadDesktop, fake_GetThreadDesktop);
		DetourDetach(&(PVOID&)pSetMenuContextHelpId, fake_SetMenuContextHelpId);
		DetourDetach(&(PVOID&)pCharNextExA, fake_CharNextExA);
		DetourDetach(&(PVOID&)pGetKBCodePage, fake_GetKBCodePage);
		DetourDetach(&(PVOID&)pSetClassLongPtrW, fake_SetClassLongPtrW);
		DetourDetach(&(PVOID&)pGetClassLongA, fake_GetClassLongA);
		DetourDetach(&(PVOID&)pRegisterDeviceNotificationA, fake_RegisterDeviceNotificationA);
		DetourDetach(&(PVOID&)pCharPrevW, fake_CharPrevW);
		DetourDetach(&(PVOID&)pGetParent, fake_GetParent);
		DetourDetach(&(PVOID&)pBroadcastSystemMessage, fake_BroadcastSystemMessage);
		DetourDetach(&(PVOID&)pMapVirtualKeyA, fake_MapVirtualKeyA);
		DetourDetach(&(PVOID&)pIsIconic, fake_IsIconic);
		DetourDetach(&(PVOID&)pCopyAcceleratorTableW, fake_CopyAcceleratorTableW);
		DetourDetach(&(PVOID&)pCreateCaret, fake_CreateCaret);
		DetourDetach(&(PVOID&)pIsChild, fake_IsChild);
		DetourDetach(&(PVOID&)pTileWindows, fake_TileWindows);
		DetourDetach(&(PVOID&)pPeekMessageW, fake_PeekMessageW);
		DetourDetach(&(PVOID&)pGetScrollInfo, fake_GetScrollInfo);
		DetourDetach(&(PVOID&)pAnyPopup, fake_AnyPopup);
		DetourDetach(&(PVOID&)pAddClipboardFormatListener, fake_AddClipboardFormatListener);
		DetourDetach(&(PVOID&)pChangeDisplaySettingsW, fake_ChangeDisplaySettingsW);
		DetourDetach(&(PVOID&)pCheckMenuItem, fake_CheckMenuItem);
		DetourDetach(&(PVOID&)pSetWinEventHook, fake_SetWinEventHook);
		DetourDetach(&(PVOID&)pGetMessageExtraInfo, fake_GetMessageExtraInfo);
		DetourDetach(&(PVOID&)pShowWindow, fake_ShowWindow);
		DetourDetach(&(PVOID&)pGetGestureExtraArgs, fake_GetGestureExtraArgs);
		DetourDetach(&(PVOID&)pGetAltTabInfoW, fake_GetAltTabInfoW);
		DetourDetach(&(PVOID&)pPostMessageW, fake_PostMessageW);
		DetourDetach(&(PVOID&)pGetWindowDisplayAffinity, fake_GetWindowDisplayAffinity);
		DetourDetach(&(PVOID&)pSwapMouseButton, fake_SwapMouseButton);
		DetourDetach(&(PVOID&)pSetRectEmpty, fake_SetRectEmpty);
		DetourDetach(&(PVOID&)pCharUpperA, fake_CharUpperA);
		DetourDetach(&(PVOID&)pLoadKeyboardLayoutW, fake_LoadKeyboardLayoutW);
		DetourDetach(&(PVOID&)pDrawIcon, fake_DrawIcon);
		DetourDetach(&(PVOID&)pUnhookWindowsHook, fake_UnhookWindowsHook);
		DetourDetach(&(PVOID&)pGetAltTabInfoA, fake_GetAltTabInfoA);
		DetourDetach(&(PVOID&)pOpenInputDesktop, fake_OpenInputDesktop);
		DetourDetach(&(PVOID&)pChildWindowFromPoint, fake_ChildWindowFromPoint);
		DetourDetach(&(PVOID&)pVkKeyScanExA, fake_VkKeyScanExA);
		DetourDetach(&(PVOID&)pSendMessageA, fake_SendMessageA);
		DetourDetach(&(PVOID&)pSetWindowPlacement, fake_SetWindowPlacement);
		DetourDetach(&(PVOID&)pSendNotifyMessageA, fake_SendNotifyMessageA);
		DetourDetach(&(PVOID&)pEnumDisplayDevicesA, fake_EnumDisplayDevicesA);
		DetourDetach(&(PVOID&)pLoadCursorA, fake_LoadCursorA);
		DetourDetach(&(PVOID&)pOpenWindowStationW, fake_OpenWindowStationW);
		DetourDetach(&(PVOID&)pCopyRect, fake_CopyRect);
		DetourDetach(&(PVOID&)pModifyMenuW, fake_ModifyMenuW);
		DetourDetach(&(PVOID&)pAppendMenuW, fake_AppendMenuW);
		DetourDetach(&(PVOID&)pEnumDisplayMonitors, fake_EnumDisplayMonitors);
		DetourDetach(&(PVOID&)pEnumWindowStationsW, fake_EnumWindowStationsW);
		DetourDetach(&(PVOID&)pGetKeyboardState, fake_GetKeyboardState);
		DetourDetach(&(PVOID&)pGetKeyboardLayout, fake_GetKeyboardLayout);
		DetourDetach(&(PVOID&)pCharLowerBuffW, fake_CharLowerBuffW);
		DetourDetach(&(PVOID&)pOemKeyScan, fake_OemKeyScan);
		DetourDetach(&(PVOID&)pChangeWindowMessageFilterEx, fake_ChangeWindowMessageFilterEx);
		DetourDetach(&(PVOID&)pIsRectEmpty, fake_IsRectEmpty);
		DetourDetach(&(PVOID&)pCancelShutdown, fake_CancelShutdown);
		DetourDetach(&(PVOID&)pwsprintfA, fake_wsprintfA);
		DetourDetach(&(PVOID&)pSetMenuItemBitmaps, fake_SetMenuItemBitmaps);
		DetourDetach(&(PVOID&)pAllowSetForegroundWindow, fake_AllowSetForegroundWindow);
		DetourDetach(&(PVOID&)pCopyIcon, fake_CopyIcon);
		DetourDetach(&(PVOID&)pInSendMessage, fake_InSendMessage);
		DetourDetach(&(PVOID&)pScrollWindow, fake_ScrollWindow);
		DetourDetach(&(PVOID&)pGetWindowRgn, fake_GetWindowRgn);
		DetourDetach(&(PVOID&)pBeginPaint, fake_BeginPaint);
		DetourDetach(&(PVOID&)pChangeClipboardChain, fake_ChangeClipboardChain);
		DetourDetach(&(PVOID&)pGetWindowThreadProcessId, fake_GetWindowThreadProcessId);
		DetourDetach(&(PVOID&)pCharLowerBuffA, fake_CharLowerBuffA);
		DetourDetach(&(PVOID&)pRegisterWindowMessageW, fake_RegisterWindowMessageW);
		DetourDetach(&(PVOID&)pQueryDisplayConfig, fake_QueryDisplayConfig);
		DetourDetach(&(PVOID&)pInflateRect, fake_InflateRect);
		DetourDetach(&(PVOID&)pClipCursor, fake_ClipCursor);
		DetourDetach(&(PVOID&)pDlgDirSelectExA, fake_DlgDirSelectExA);
		DetourDetach(&(PVOID&)pGetClassLongPtrA, fake_GetClassLongPtrA);
		DetourDetach(&(PVOID&)pGetTabbedTextExtentW, fake_GetTabbedTextExtentW);
		DetourDetach(&(PVOID&)pSetWindowLongPtrA, fake_SetWindowLongPtrA);
		DetourDetach(&(PVOID&)pShowScrollBar, fake_ShowScrollBar);
		DetourDetach(&(PVOID&)pMonitorFromRect, fake_MonitorFromRect);
		DetourDetach(&(PVOID&)pActivateKeyboardLayout, fake_ActivateKeyboardLayout);
		DetourDetach(&(PVOID&)pSetGestureConfig, fake_SetGestureConfig);
		DetourDetach(&(PVOID&)pLoadMenuIndirectA, fake_LoadMenuIndirectA);
		DetourDetach(&(PVOID&)pOpenDesktopW, fake_OpenDesktopW);
		DetourDetach(&(PVOID&)pEnumClipboardFormats, fake_EnumClipboardFormats);
		DetourDetach(&(PVOID&)pToAsciiEx, fake_ToAsciiEx);
		DetourDetach(&(PVOID&)pSetClassLongPtrA, fake_SetClassLongPtrA);
		DetourDetach(&(PVOID&)pSetCaretBlinkTime, fake_SetCaretBlinkTime);
		DetourDetach(&(PVOID&)pGetCapture, fake_GetCapture);
		DetourDetach(&(PVOID&)pSwitchToThisWindow, fake_SwitchToThisWindow);
		DetourDetach(&(PVOID&)pSetUserObjectInformationA, fake_SetUserObjectInformationA);
		DetourDetach(&(PVOID&)pCalculatePopupWindowPosition, fake_CalculatePopupWindowPosition);
		DetourDetach(&(PVOID&)pEnumPropsExA, fake_EnumPropsExA);
		DetourDetach(&(PVOID&)pChangeMenuW, fake_ChangeMenuW);
		DetourDetach(&(PVOID&)pCloseWindowStation, fake_CloseWindowStation);
		DetourDetach(&(PVOID&)pRegisterDeviceNotificationW, fake_RegisterDeviceNotificationW);
		DetourDetach(&(PVOID&)pModifyMenuA, fake_ModifyMenuA);
		DetourDetach(&(PVOID&)pDlgDirSelectComboBoxExA, fake_DlgDirSelectComboBoxExA);
		DetourDetach(&(PVOID&)pGetIconInfo, fake_GetIconInfo);
		DetourDetach(&(PVOID&)pIsCharLowerA, fake_IsCharLowerA);
 
        DetourTransactionCommit();  
    }  
    return TRUE;  
}  
